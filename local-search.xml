<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ethers.js</title>
    <link href="/2025/01/12/ethers-js/"/>
    <url>/2025/01/12/ethers-js/</url>
    
    <content type="html"><![CDATA[<p>ä»¥ä¸‹å¯¹äºä»¥å¤ªåŠä¸»ç½‘ï¼Œä½¿ç”¨å…¬ç”¨ rpc èŠ‚ç‚¹ï¼Œå¯¹äºæµ‹è¯•ç½‘ Sepoliaï¼Œä½¿ç”¨è‡ªå·±çš„ API keyã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">INFURA_ID</span> = <span class="hljs-string">&#x27;/* ä½ çš„ API key */&#x27;</span>;<br><span class="hljs-keyword">const</span> providerSepolia = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(<span class="hljs-string">`https://sepolia.infura.io/v3/<span class="hljs-subst">$&#123;INFURA_ID&#125;</span>`</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ALCHEMY_MAINNET_URL</span> = <span class="hljs-string">&#x27;https://rpc.ankr.com/eth&#x27;</span>;<br><span class="hljs-keyword">const</span> providerETH = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(<span class="hljs-variable constant_">ALCHEMY_MAINNET_URL</span>);<br></code></pre></td></tr></table></figure><h1 id="0-BigInt-å’Œå•ä½å¤„ç†"><a href="#0-BigInt-å’Œå•ä½å¤„ç†" class="headerlink" title="0. BigInt å’Œå•ä½å¤„ç†"></a>0. <code>BigInt</code> å’Œå•ä½å¤„ç†</h1><p>ç”±äºä»¥å¤ªåŠä¸­å¾ˆå¤šè¿ç®—éƒ½è¶…å‡ºäº†æ•´æ•°çš„å®‰å…¨å€¼ï¼Œæ‰€ä»¥ <code>ethers.js</code> çš„å¾ˆå¤šè¿”å›å€¼éƒ½æ˜¯ <code>BigInt</code>ã€‚</p><p>å¯ä»¥ä½¿ç”¨ <code>`ethers.getBigInt()</code> å°† å­—ç¬¦ä¸²æˆ–å…¶ä»–è¿›åˆ¶çš„æ•°è½¬æ¢ä¸º <code>BigInt</code>ã€‚</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sas">ethers.getBig<span class="hljs-meta">Int</span>(<span class="hljs-string">&quot;1234567890&quot;</span>)<br>ethers.getBig<span class="hljs-meta">Int</span>(<span class="hljs-string">&#x27;0xCba123&#x27;</span>)<br>etehrs.getBig<span class="hljs-meta">Int</span>(1122334455)<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼Œè¶…è¿‡jsæœ€å¤§å®‰å…¨æ•´æ•°çš„æ•°å€¼å°†ä¸èƒ½è½¬æ¢ã€‚</p><h2 id="å•ä½å¤„ç†"><a href="#å•ä½å¤„ç†" class="headerlink" title="å•ä½å¤„ç†"></a>å•ä½å¤„ç†</h2><p>ä»¥å¤ªåŠæœ‰å¦‚ä¸‹å•ä½ã€‚</p><p><img src="https://www.wtf.academy/assets/images/10-3-de6c78745601e096f4d0f462c3407e46.png" alt="0.1.1"></p><ul><li><code>formatUnits(å˜é‡, å•ä½)</code>ï¼Œå•ä½å¡«ä¸Šé¢è¡¨é‡Œå·¦ä¾§çš„å•ä½åï¼Œæˆ–è€…ç›´æ¥å¡«æ•°å­—ï¼ˆå¡«å‡ å°±ç›¸å½“äºä¹˜10çš„å‡ æ¬¡æ–¹çš„å•ä½ï¼‰</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> gwei = <span class="hljs-title class_">BigInt</span>(<span class="hljs-number">1e9</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ethers.<span class="hljs-title function_">formatUnits</span>(gwei, <span class="hljs-number">9</span>))<span class="hljs-comment">// å°±æ˜¯ gwei</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ethers.<span class="hljs-title function_">formatUnits</span>(gwei, <span class="hljs-string">&#x27;ether&#x27;</span>))<span class="hljs-comment">// å•ä½ä¸º ether</span><br></code></pre></td></tr></table></figure><ul><li><code>parseUnits(å˜é‡, å•ä½)</code>ï¼Œå˜é‡æ˜¯å­—ç¬¦ä¸²å½¢å¼ï¼Œå°†ä»»æ„å•ä½è½¬æ¢ä¸º weiï¼Œå•ä½å¤„ä¸å†™é»˜è®¤æ˜¯ ether</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ethers.<span class="hljs-title function_">parseUnits</span>(<span class="hljs-string">&#x27;1.23&#x27;</span>, <span class="hljs-number">9</span>).<span class="hljs-title function_">toString</span>())<span class="hljs-comment">// 1.23 gwei =&gt; Â·Â·Â·wei</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ethers.<span class="hljs-title function_">parseUnits</span>(<span class="hljs-string">&#x27;4.56&#x27;</span>, <span class="hljs-string">&#x27;ether&#x27;</span>).<span class="hljs-title function_">toString</span>()) <span class="hljs-comment">// 4.56 ether =&gt; Â·Â·Â·wei</span><br></code></pre></td></tr></table></figure><h1 id="1-Provider-ç±»"><a href="#1-Provider-ç±»" class="headerlink" title="1. Provider ç±»"></a>1. <code>Provider</code> ç±»</h1><p><code>provider</code> æœ‰ä»¥ä¸‹å‡ ä¸ªç®€å•çš„è¿ç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">main</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">MyAddr</span> = <span class="hljs-string">&#x27;0xCba28960338E1953b2b4C1750D326729029C82d3&#x27;</span>;<br><br>    <span class="hljs-comment">// å¯¹äºé’±åŒ…ä¿¡æ¯çš„æŸ¥è¯¢</span><br>        <span class="hljs-comment">/* 1. æŸ¥è¯¢ä½™é¢ï¼šgetBalance(åœ°å€) */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;1. ä½™é¢&#x27;</span>);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">BalanceOfVitalik</span> = <span class="hljs-keyword">await</span> providerETH.<span class="hljs-title function_">getBalance</span>(<span class="hljs-string">&#x27;vitalik.eth&#x27;</span>);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">BalanceOfVitalikETH</span> = ethers.<span class="hljs-title function_">formatEther</span>(<span class="hljs-title class_">BalanceOfVitalik</span>);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">MyBalance</span> = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getBalance</span>(<span class="hljs-title class_">MyAddr</span>);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">MyBalanceETH</span> = ethers.<span class="hljs-title function_">formatEther</span>(<span class="hljs-title class_">MyBalance</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`vitalik:<span class="hljs-subst">$&#123;BalanceOfVitalikETH&#125;</span>\næˆ‘:<span class="hljs-subst">$&#123;MyBalanceETH&#125;</span>`</span>);<br>        <span class="hljs-comment">/* 2. æŸ¥è¯¢å†å²äº¤æ˜“æ¬¡æ•°ï¼šgetTransactionCount(åœ°å€) */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;\n2. äº¤æ˜“æ¬¡æ•°&#x27;</span>);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">CountOfVitalik</span> = <span class="hljs-keyword">await</span> providerETH.<span class="hljs-title function_">getTransactionCount</span>(<span class="hljs-string">&#x27;vitalik.eth&#x27;</span>);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">MyCount</span> = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getTransactionCount</span>(<span class="hljs-title class_">MyAddr</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`vitalik:<span class="hljs-subst">$&#123;CountOfVitalik&#125;</span>\næˆ‘:<span class="hljs-subst">$&#123;MyCount&#125;</span>`</span>);<br><br>    <span class="hljs-comment">//å¯¹äº provider æœ¬èº«çš„æŸ¥è¯¢ </span><br>        <span class="hljs-comment">/* 1.  æŸ¥è¯¢ provider æ‰€è¿æ¥çš„é“¾ï¼šgetNetwork() */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;\n3. provider è¿æ¥åˆ°çš„é“¾&#x27;</span>);<br>    <span class="hljs-keyword">const</span> mainNet = <span class="hljs-keyword">await</span> providerETH.<span class="hljs-title function_">getNetwork</span>();<br>    <span class="hljs-keyword">const</span> testNet = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getNetwork</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mainNet.<span class="hljs-title function_">toJSON</span>());<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(testNet.<span class="hljs-title function_">toJSON</span>()); <br>        <span class="hljs-comment">/* 2. æŸ¥è¯¢å»ºè®®çš„ gas è®¾ç½®ï¼š getFeeData() */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;\n4. gas è®¾ç½®&#x27;</span>);<br>    <span class="hljs-keyword">const</span> mainnetFee = <span class="hljs-keyword">await</span> providerETH.<span class="hljs-title function_">getFeeData</span>();<br>    <span class="hljs-keyword">const</span> testnetFee = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getFeeData</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mainnetFee);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(testnetFee);<br>        <span class="hljs-comment">/* 3. æŸ¥è¯¢å½“å‰ç½‘ç»œçš„åŒºå—é«˜åº¦ï¼š getBlockNumber()  */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;\n5. å½“å‰åŒºå—é«˜åº¦&#x27;</span>);<br>    <span class="hljs-keyword">const</span> mainnetNum = <span class="hljs-keyword">await</span> providerETH.<span class="hljs-title function_">getBlockNumber</span>();<br>    <span class="hljs-keyword">const</span> testnetNum = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getBlockNumber</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mainnetNum);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(testnetNum);<br>   <br>    <span class="hljs-comment">// å¯¹äºåŒºå—ä¿¡æ¯çš„æŸ¥è¯¢</span><br>        <span class="hljs-comment">/* 1. æŸ¥è¯¢åŒºå—ä¿¡æ¯ï¼š getBlock(åŒºå—é«˜åº¦) */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;\n6. åŒºå—ä¿¡æ¯&#x27;</span>);<br>    <span class="hljs-keyword">const</span> mainnetBlock = <span class="hljs-keyword">await</span> providerETH.<span class="hljs-title function_">getBlock</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">const</span> testnetBlock = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getBlock</span>(<span class="hljs-number">100</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mainnetBlock);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(testnetBlock);<br>        <span class="hljs-comment">/* 2. æŸ¥è¯¢åˆçº¦çš„ bytecodeï¼šgetCode(&#x27;åˆçº¦åœ°å€&#x27;) */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\n7. åˆçº¦çš„ bytecode( ä¸»ç½‘ç”¨çš„WETHåœ°å€, æµ‹è¯•ç½‘è‡ªå·±å¸ƒç½® )&quot;</span>);<br>    <span class="hljs-keyword">const</span> mainnetCode = <span class="hljs-keyword">await</span> providerETH.<span class="hljs-title function_">getCode</span>(<span class="hljs-string">&quot;0xc778417e063141139fce010982780140aa0cd5ab&quot;</span>);<br>    <span class="hljs-keyword">const</span> testnetCode = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getCode</span>(<span class="hljs-string">&quot;0x4f28177481A9fB5b5a7E5DAFF067c99fdA4cA9f8&quot;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;ä¸»ç½‘:&#x27;</span> + mainnetCode);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æµ‹è¯•ç½‘:&#x27;</span> + testnetCode);<br>&#125;<br><span class="hljs-title function_">main</span>();<br></code></pre></td></tr></table></figure><h1 id="2-ä»¥åªè¯»æ–¹å¼è·å–åˆçº¦ä¿¡æ¯"><a href="#2-ä»¥åªè¯»æ–¹å¼è·å–åˆçº¦ä¿¡æ¯" class="headerlink" title="2. ä»¥åªè¯»æ–¹å¼è·å–åˆçº¦ä¿¡æ¯"></a>2. ä»¥åªè¯»æ–¹å¼è·å–åˆçº¦ä¿¡æ¯</h1><p>é€šè¿‡ <code>Contract</code> ç±»å¯ä»¥ä¸åˆçº¦è¿›è¡Œäº¤äº’ã€‚<code>Contract</code> å¯¹è±¡åˆ†ä¸º <strong><em>åªè¯»</em></strong> å’Œ <strong><em>å¯è¯»å†™</em></strong> ä¸¤ç±»ï¼Œå…¶åˆ›é€ æ–¹å¼ä¸åŒã€‚</p><ul><li><p>åªè¯»ï¼š<code>const example01 = new ethers.Contract(addr, abi, provider)</code></p><p>è¿™æ ·åˆ›é€ å‡ºçš„å¯¹è±¡ä»…èƒ½ä¸åˆçº¦ä¸­çš„ <code>pure</code> æˆ– <code>view</code> æ ‡è®°çš„å‡½æ•°äº¤äº’ã€‚ï¼ˆ<code>public</code> å˜é‡ä¼šè‡ªåŠ¨ç”ŸæˆåŒåçš„ <code>view</code> çš„å‡½æ•°ï¼Œ<code>private</code> ä¸ä¼šï¼‰</p></li><li><p>å¯è¯»å†™ï¼š<code>const example02 = new ethers.Contract(addr, abi, signer)</code></p></li></ul><p>è¿™é‡Œå…ˆçœ‹åªè¯»çš„ï¼Œå‡è®¾æˆ‘ä»¬éƒ¨ç½²äº†å¦‚ä¸‹åˆçº¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.0;<br><br>contract Test &#123;<br>    string public name = &quot;victifa&quot;;<br>    uint8 private password;<br>    uint256 public number = 1;<br><br>    constructor(uint8 pw) &#123;<br>        password = pw;<br>    &#125;<br><br>    function anywayJustEnjoy() public pure returns(string memory) &#123;<br>        return (&quot;It&#x27;s time to ENJOY! &quot;);<br>    &#125;<br><br>    function JustSing(uint8 _password) public view returns(string memory) &#123;<br>        if (password == _password) &#123;<br>            return (unicode&quot;æœ‹å‹çš„æƒ…ä¹‰å‘€æ¯”å¤©è¿˜é«˜æ¯”åœ°è¿˜è¾½é˜”ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»é‚£äº›å²æœˆæˆ‘ä»¬ä¸€å®šä¼šè®°å¾—~~ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»æœ‹å‹çš„æƒ…ä¹‰å‘€æˆ‘ä»¬ä»Šç”Ÿæœ€å¤§çš„éš¾å¾—~ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»åƒä¸€æ¯é…’ğŸ‘ğŸ»ğŸ‘ğŸ»~~åƒä¸€é¦–è€æ­Œ~ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»ğŸ’ƒğŸ»&quot;);<br>        &#125;<br>        else &#123;<br>            return (&quot;Darkest night, I&#x27;ll confront you here.&quot;);<br>        &#125;<br>    &#125;<br><br>    function YouCantUseIt() public &#123;<br>        number++;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-åˆ›å»ºåªè¯»-Contract-å¯¹è±¡"><a href="#1-åˆ›å»ºåªè¯»-Contract-å¯¹è±¡" class="headerlink" title="1. åˆ›å»ºåªè¯» Contract å¯¹è±¡"></a>1. åˆ›å»ºåªè¯» <code>Contract</code> å¯¹è±¡</h2><p>æœ‰ 3 ä¸ªå‚æ•°ã€‚<code>addr</code> æ˜¯åˆçº¦åœ°å€ï¼Œ <code>provider</code> æ˜¯è‡ªå·±åˆ›çš„æˆ–è€…ç”¨å…¬ç”¨çš„ï¼Œ<code>abi</code> æœ‰å¦‚ä¸‹ä¸¤è€…è·å–æ–¹å¼ï¼š</p><ol><li><p>ç›´æ¥åœ¨ Remix é‡Œç¼–è¯‘å¥½ï¼Œå» <code>./artifacts/åˆçº¦å_metadata.json</code> é‡Œæ‰¾å¤åˆ¶ä¸‹æ¥ã€‚æ¯”å¦‚ä¸Šæ–¹åˆçº¦çš„ <code>abi</code> å³ä¸ºï¼ˆä»…ä¸€éƒ¨åˆ†ï¼‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> abiMethod01 = <span class="hljs-string">&#x27;[&#123;&quot;inputs&quot;: [&#123;&quot;internalType&quot;: &quot;uint8&quot;,&quot;name&quot;: &quot;pw&quot;,&quot;type&quot;: &quot;uint8&quot;&#125;],&quot;stateMutability&quot;: &quot;nonpayable&quot;,&quot;type&quot;: &quot;constructor&quot;&#125;, åé¢çœç•¥&#x27;</span>;<br></code></pre></td></tr></table></figure></li><li><p>ç”±äºè¯¥ç»“æœä¸å‹å¥½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡½æ•°å’Œäº‹ä»¶çš„ç­¾åæ¥æ‰‹åŠ¨ç»™å‡º <code>abi</code>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> abiMethod02 = [<br>        <span class="hljs-string">&quot;function name() view returns (string)&quot;</span>,<br>        <span class="hljs-string">&quot;function number() view returns (uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function anywayJustEnjoy() pure returns(string)&quot;</span>,<br>        <span class="hljs-string">&quot;function JustSing(uint8) view returns(string)&quot;</span>,<br>        <span class="hljs-string">&quot;event noUseJustTest(string)&quot;</span>,<br>];<br></code></pre></td></tr></table></figure><p>å¯¹äºæˆ‘ä»¬ä¸è¦çš„å‡½æ•° / äº‹ä»¶ï¼Œå¯ä»¥ç›´æ¥ä¸å†™ï¼Œå¦‚äº‹ä»¶ <code>noUseJustTest</code> ä¸ç”¨ï¼Œé‚£ä¸å†™è¿›å»ä¹Ÿå¯ä»¥ã€‚</p></li></ol><h2 id="2-è°ƒç”¨å®ä¾‹è·å–ä¿¡æ¯"><a href="#2-è°ƒç”¨å®ä¾‹è·å–ä¿¡æ¯" class="headerlink" title="2. è°ƒç”¨å®ä¾‹è·å–ä¿¡æ¯"></a>2. è°ƒç”¨å®ä¾‹è·å–ä¿¡æ¯</h2><p>ç›´æ¥ <code>example01.å‡½æ•°å</code>ã€‚ä¸‹é¢æ˜¯å¯¹å·²éƒ¨ç½²åˆçº¦ä¿¡æ¯çš„å®Œæ•´è·å–æ–¹æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">privacy</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> addrTest = <span class="hljs-string">&#x27;0x2Af5932a3aBFee25720a726e31b36c10ca759d27&#x27;</span>;<br>    <span class="hljs-keyword">const</span> abiMethod01 = <span class="hljs-string">&#x27;[&#123;&quot;inputs&quot;: [&#123;&quot;internalType&quot;: &quot;uint8&quot;,&quot;name&quot;: &quot;pw&quot;,&quot;type&quot;: &quot;uint8&quot;&#125;],&quot;stateMutability&quot;: &quot;nonpayable&quot;,&quot;type&quot;: &quot;constructor&quot;&#125;,&#123;&quot;anonymous&quot;: false,&quot;inputs&quot;: [&#123;&quot;indexed&quot;: false,&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;name&quot;: &quot;noUseJustTest&quot;,&quot;type&quot;: &quot;event&quot;&#125;,&#123;&quot;inputs&quot;: [&#123;&quot;internalType&quot;: &quot;uint8&quot;,&quot;name&quot;: &quot;_password&quot;,&quot;type&quot;: &quot;uint8&quot;&#125;],&quot;name&quot;: &quot;JustSing&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;stateMutability&quot;: &quot;view&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;YouCantUseIt&quot;,&quot;outputs&quot;: [],&quot;stateMutability&quot;: &quot;nonpayable&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;anywayJustEnjoy&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;stateMutability&quot;: &quot;pure&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;name&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;string&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;string&quot;&#125;],&quot;stateMutability&quot;: &quot;view&quot;,&quot;type&quot;: &quot;function&quot;&#125;,&#123;&quot;inputs&quot;: [],&quot;name&quot;: &quot;number&quot;,&quot;outputs&quot;: [&#123;&quot;internalType&quot;: &quot;uint256&quot;,&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;uint256&quot;&#125;],&quot;stateMutability&quot;: &quot;view&quot;,&quot;type&quot;: &quot;function&quot;&#125;]&#x27;</span>;<span class="hljs-comment">// ç¡®å®è®¨åŒ</span><br>    <span class="hljs-keyword">const</span> abiMethod02 = [<br>        <span class="hljs-string">&quot;function name() view returns (string)&quot;</span>,<br>        <span class="hljs-string">&quot;function number() view returns (uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function anywayJustEnjoy() pure returns(string)&quot;</span>,<br>        <span class="hljs-string">&quot;function JustSing(uint8) view returns(string)&quot;</span>,<br>        <span class="hljs-string">&quot;event noUseJustTest(string)&quot;</span>,<br>    ];<br>    <span class="hljs-keyword">const</span> contractTest = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Contract</span>(addrTest, abiMethod02<span class="hljs-comment">/* æˆ–abiMethod01 */</span>, providerSepolia);<br>    <span class="hljs-keyword">const</span> nameTest = <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">name</span>();<br>    <span class="hljs-keyword">const</span> numberTest = <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">number</span>();<br>    <span class="hljs-keyword">const</span> enjoyTest = <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">anywayJustEnjoy</span>();<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">JustSingTest</span> = <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title class_">JustSing</span>(<span class="hljs-number">22</span>);<span class="hljs-comment">// æ‹¬å·é‡Œçš„æ•°æ˜¯ç»™è°ƒç”¨åˆçº¦çš„å‚æ•°</span><br>    <span class="hljs-comment">// ä¼šæŠ¥é”™ï¼šconst useTest = await contractTest.YouCantUseIt(); </span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`name:<span class="hljs-subst">$&#123;nameTest&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`number:<span class="hljs-subst">$&#123;numberTest&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è°ƒç”¨å‡½æ•° anywayJustEnjoy çš„ç»“æœ:<span class="hljs-subst">$&#123;enjoyTest&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è°ƒç”¨å‡½æ•° JustSing çš„ç»“æœ:<span class="hljs-subst">$&#123;JustSingTest&#125;</span>`</span>);<br>&#125;<br><span class="hljs-title function_">privacy</span>();<br></code></pre></td></tr></table></figure><h1 id="3-é’±åŒ…ç›¸å…³"><a href="#3-é’±åŒ…ç›¸å…³" class="headerlink" title="3. é’±åŒ…ç›¸å…³"></a>3. é’±åŒ…ç›¸å…³</h1><p>ä¸»è¦æ¶‰åŠä¸¤ä¸ªç±»ï¼š<code>Signer</code> å’Œ <code>Wallet</code> ç±»ã€‚å…¶ä¸­ <code>Signer</code> ç±»æ˜¯æŠ½è±¡çš„ï¼Œ<code>Wallet</code> ç±»æ˜¯å®ƒçš„ç»§æ‰¿ï¼Œå¯ä»¥å®ä¾‹åŒ–ã€‚</p><h2 id="1-Wallet-å¯¹è±¡çš„åˆ›å»º"><a href="#1-Wallet-å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="1. Wallet å¯¹è±¡çš„åˆ›å»º"></a>1. <code>Wallet</code> å¯¹è±¡çš„åˆ›å»º</h2><ol><li><p>éšæœºç”Ÿæˆ</p><p>å…ˆé€šè¿‡ <code>ethers.Wallet.createRandom()</code> éšæœºç”Ÿæˆä¸€ä¸ªï¼Œå†é€šè¿‡ <code>provider</code> è¿ä¸Šä»¥å¤ªåŠèŠ‚ç‚¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> wallet1 = ethers.<span class="hljs-property">Wallet</span>.<span class="hljs-title function_">createRandom</span>();<br><span class="hljs-keyword">const</span> wallet1WithProvider = wallet1.<span class="hljs-title function_">connect</span>(providerSepolia);<br></code></pre></td></tr></table></figure></li><li><p>é€šè¿‡ç§é’¥</p><p>å»è‡ªå·±çš„é’±åŒ…è´¦æˆ·é‡ŒæŸ¥ä¸€ä¸‹ç§é’¥ï¼Œé€šè¿‡ <code>ethers.Wallet(ç§é’¥, provider)</code> new ä¸€ä¸ªå‡ºæ¥ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> privateKey = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">const</span> wallet2 = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Wallet</span>(privateKey, providerSepolia);<br></code></pre></td></tr></table></figure></li><li><p>é€šè¿‡åŠ©è®°è¯</p><p>å»è‡ªå·±é’±åŒ…æŸ¥ï¼Œæˆ–è€…å°±ç”¨ä¸Šé¢ <code>wallet1</code> çš„ï¼Œé€šè¿‡ <code>ethers.Wallet.fromPhrase(åŠ©è®°è¯)</code> ç›´æ¥åˆ›å»ºã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> secrteRecoveryPhrases = wallet1.<span class="hljs-property">mnemonic</span>.<span class="hljs-property">phrase</span>;<br><span class="hljs-keyword">const</span> wallet3 = ethers.<span class="hljs-property">Wallet</span>.<span class="hljs-title function_">fromPhrase</span>(secrteRecoveryPhrases);<br></code></pre></td></tr></table></figure></li></ol><h2 id="2-ä¸€äº›ç®€å•çš„å°äº¤äº’"><a href="#2-ä¸€äº›ç®€å•çš„å°äº¤äº’" class="headerlink" title="2. ä¸€äº›ç®€å•çš„å°äº¤äº’"></a>2. ä¸€äº›ç®€å•çš„å°äº¤äº’</h2><p>åŒ…æ‹¬è·å–é’±åŒ…åœ°å€ï¼ŒåŠ©è®°è¯ï¼ˆé€šè¿‡ç§é’¥åˆ›çš„æ— æ³•è·å–ï¼‰ï¼Œç§é’¥ç­‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> addr1 = <span class="hljs-keyword">await</span> wallet1.<span class="hljs-title function_">getAddress</span>();<br><span class="hljs-keyword">const</span> addr2 = <span class="hljs-keyword">await</span> wallet2.<span class="hljs-title function_">getAddress</span>();<br><span class="hljs-keyword">const</span> addr3 = <span class="hljs-keyword">await</span> wallet3.<span class="hljs-title function_">getAddress</span>();<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet1: <span class="hljs-subst">$&#123;addr1&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet2: <span class="hljs-subst">$&#123;addr2&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet3: <span class="hljs-subst">$&#123;addr3&#125;</span>`</span>);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet1çš„åŠ©è®°è¯: <span class="hljs-subst">$&#123;secrteRecoveryPhrases&#125;</span>`</span>);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet2çš„ç§é’¥: <span class="hljs-subst">$&#123;wallet2.privateKey&#125;</span>`</span>);<br></code></pre></td></tr></table></figure><h2 id="3-å‘é€äº¤æ˜“"><a href="#3-å‘é€äº¤æ˜“" class="headerlink" title="3. å‘é€äº¤æ˜“"></a>3. å‘é€äº¤æ˜“</h2><ol><li><p>é¦–å…ˆè¦æœ‰ä¸€ä¸ªç®€å•çš„å‘é€è¯·æ±‚ï¼Œè‡³å°‘åŒ…å«ï¼šæ¥æ”¶åœ°å€ <code>to</code>ï¼Œå’Œå‘é€é‡‘é¢ <code>value</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> tx = &#123;<br> <span class="hljs-attr">to</span>: addr1,<br> <span class="hljs-attr">value</span>: ethers.<span class="hljs-title function_">parseEther</span>(<span class="hljs-string">&#x27;0.000000001&#x27;</span>),<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å‘é€</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> wallet2.<span class="hljs-title function_">sendTransaction</span>(tx);<span class="hljs-comment">// å‘é€äº¤æ˜“</span><br><span class="hljs-keyword">await</span> receipt.<span class="hljs-title function_">wait</span>();<span class="hljs-comment">// ç­‰ä¸€ç­‰</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(receipt);<br></code></pre></td></tr></table></figure></li></ol><h2 id="4-å®Œæ•´äº¤æ˜“è¿‡ç¨‹"><a href="#4-å®Œæ•´äº¤æ˜“è¿‡ç¨‹" class="headerlink" title="4. å®Œæ•´äº¤æ˜“è¿‡ç¨‹"></a>4. å®Œæ•´äº¤æ˜“è¿‡ç¨‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">wallets</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> wallet1 = ethers.<span class="hljs-property">Wallet</span>.<span class="hljs-title function_">createRandom</span>();<br>    <span class="hljs-keyword">const</span> wallet1WithProvider = wallet1.<span class="hljs-title function_">connect</span>(providerSepolia);<br><br>    <span class="hljs-keyword">const</span> privateKey = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">const</span> wallet2 = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Wallet</span>(privateKey, providerSepolia);<br><br>    <span class="hljs-keyword">const</span> tx = &#123;<br>        <span class="hljs-attr">to</span>: addr1,<br>        <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-comment">// å‘ä¸ª 1wei æ„æ€æ„æ€å°±è¡Œäº†</span><br>    &#125;<br><br>    <span class="hljs-comment">// å‘é€å‰ä½™é¢åŠäº¤æ˜“æ¬¡æ•°</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet1: <span class="hljs-subst">$&#123;ethers.formatEther( <span class="hljs-keyword">await</span> providerSepolia.getBalance(wallet1WithProvider) )&#125;</span> ETH`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet2: <span class="hljs-subst">$&#123;ethers.formatEther( <span class="hljs-keyword">await</span> providerSepolia.getBalance(wallet2) )&#125;</span> ETH`</span>);<br><br>    <span class="hljs-comment">// å‘å‡º</span><br>    <span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> wallet2.<span class="hljs-title function_">sendTransaction</span>(tx);<br>    <span class="hljs-keyword">await</span> receipt.<span class="hljs-title function_">wait</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(receipt);<br><br>    <span class="hljs-comment">// çœ‹çœ‹æƒ…å†µ</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet1: <span class="hljs-subst">$&#123;ethers.formatEther( <span class="hljs-keyword">await</span> providerSepolia.getBalance(wallet1WithProvider) )&#125;</span> ETH`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`wallet2: <span class="hljs-subst">$&#123;ethers.formatEther( <span class="hljs-keyword">await</span> providerSepolia.getBalance(wallet2) )&#125;</span> ETH`</span>);<br>&#125;<br><br><span class="hljs-title function_">wallets</span>();<br></code></pre></td></tr></table></figure><h1 id="4-åˆçº¦äº¤äº’"><a href="#4-åˆçº¦äº¤äº’" class="headerlink" title="4. åˆçº¦äº¤äº’"></a>4. åˆçº¦äº¤äº’</h1><h2 id="1-å¯è¯»å†™-Contract-å¯¹è±¡çš„åˆ›å»º"><a href="#1-å¯è¯»å†™-Contract-å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="1. å¯è¯»å†™ Contract å¯¹è±¡çš„åˆ›å»º"></a>1. å¯è¯»å†™ <code>Contract</code> å¯¹è±¡çš„åˆ›å»º</h2><p>æœ‰ä¸¤ç§åŠæ³•åˆ›å»ºã€‚</p><ol><li><p>é€šè¿‡ new ä¸€ä¸ª <code>ethers.Contract(addr, abi, signer)</code> ç›´æ¥ç”Ÿæˆã€‚å…¶ä¸­ <code>addr</code> æ˜¯åˆçº¦åœ°å€ï¼Œ<code>abi</code> æ˜¯åˆçº¦abiæ¥å£ï¼Œ<code>signer</code> æ˜¯ä¸€ä¸ª <code>wallet</code> å¯¹è±¡ï¼ˆå°±æ˜¯ç”¨äº†æ¥å’Œåˆçº¦äº¤äº’çš„é’±åŒ…ï¼‰ï¼Œä»¥ä¹‹å‰çš„ <code>Test</code> åˆçº¦ä¸ºä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> addrTest = <span class="hljs-string">&#x27;0x2Af5932a3aBFee25720a726e31b36c10ca759d27&#x27;</span>;<br><span class="hljs-keyword">const</span> abiTest = [<br>    <span class="hljs-string">&quot;function number() view returns (uint256)&quot;</span>,<br>    <span class="hljs-string">&quot;function YouCantUseIt()&quot;</span>,<br>];<br><span class="hljs-keyword">const</span> privateKey = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">const</span> wallet = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Wallet</span>(privateKey, providerSepolia);<br><span class="hljs-keyword">const</span> contractTestNew = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Contract</span>(addrTest, abiTest, wallet);<br></code></pre></td></tr></table></figure></li><li><p>å¯¹å·²æœ‰çš„åªè¯» <code>Contract</code> å¯¹è±¡ï¼Œä½¿ç”¨ <code>ObjName.connect(signer)</code> æå‡ºæ¥ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> contractTestOld = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Contract</span>(addrTest, abiTest, providerSepolia);<br><span class="hljs-keyword">const</span> contractTestNew = contractTestOld.<span class="hljs-title function_">connect</span>(wallet);<br></code></pre></td></tr></table></figure></li></ol><h2 id="2-åˆçº¦äº¤äº’"><a href="#2-åˆçº¦äº¤äº’" class="headerlink" title="2. åˆçº¦äº¤äº’"></a>2. åˆçº¦äº¤äº’</h2><p>æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> contractObjName.<span class="hljs-title function_">METHOD_NAME</span>(args, [overrides])<br><span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>();<br></code></pre></td></tr></table></figure><ul><li><p><code>contractObjName</code>ï¼šåˆ›å»ºçš„ <code>Contract</code> å¯¹è±¡åã€‚</p></li><li><p><code>METHOD_NAME</code>ï¼šè°ƒç”¨çš„å‡½æ•°åã€‚</p></li><li><p><code>args</code>ï¼šä¼ ç»™å‡½æ•°çš„å‚æ•°ã€‚</p></li><li><p><code>[overrides]</code>ï¼šï¼ˆå¯é€‰çš„ï¼‰ä¼ å…¥æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><code>gasPrice</code>ï¼šgasä»·æ ¼</li><li><code>gasLimit</code>ï¼šgasä¸Šé™</li><li><code>value</code>ï¼šè°ƒç”¨æ—¶ä¼ å…¥çš„etherï¼ˆå•ä½æ˜¯weiï¼‰</li><li><code>nonce</code></li></ul><p>å››ç§ï¼Œä»¥ä¼ å‚æ•°<code>&quot;hi&quot;</code> å’Œ 1 ether ä¸ºä¾‹ï¼Œå†™ä¸ºï¼š<code>( &quot;hi&quot;, &#123;value: ethers.parseEther(&quot;1&quot;)&#125; )</code>ã€‚</p></li></ul><p>ä»¥è°ƒç”¨ <code>Test</code> åˆçº¦çš„ <code>YouCantUseIt</code> ä¸ºä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-keyword">await</span> contractTestNew.number()&#125;</span>`</span>)<br><span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> contractTestNew.<span class="hljs-title class_">YouCantUseIt</span>();<br><span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-keyword">await</span> contractTestNew.number()&#125;</span>`</span>)<br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç° <code>number</code> åŠ äº†1ã€‚</p><h3 id="è¿”å›å€¼å¤„ç†"><a href="#è¿”å›å€¼å¤„ç†" class="headerlink" title="è¿”å›å€¼å¤„ç†"></a>è¿”å›å€¼å¤„ç†</h3><p>ç”±äºè¿™ç§æ–¹å¼æ— æ³•æ¥æ”¶è¿”å›å€¼ï¼Œéœ€è¦æ—¶å¯ä»¥åœ¨å‡½æ•°é‡ŒåŠ ä¸ª <code>event</code>ï¼Œç„¶ååœ¨ä¸Šé¢çš„ <code>tx</code> é‡Œæ‰¾ã€‚</p><h1 id="5-åˆçº¦éƒ¨ç½²"><a href="#5-åˆçº¦éƒ¨ç½²" class="headerlink" title="5. åˆçº¦éƒ¨ç½²"></a>5. åˆçº¦éƒ¨ç½²</h1><p>é€šè¿‡ <code>ContractFactory</code> ç±»å®ç°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> contractFactoryExample = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">ContractFactory</span>(abi, bytecode, signer);<br></code></pre></td></tr></table></figure><p>è‹¥æœ‰æ„é€ å‡½æ•°ï¼Œåˆ™ <code>abi</code> ä¸­è¦åŒ…å«æ„é€ å‡½æ•°ã€‚<code>bytecode</code> ç›´æ¥åœ¨ Remix é‡Œå¤åˆ¶ã€‚</p><p> ç„¶åé€šè¿‡è¿™ä¸¤è¡Œå®ç°éƒ¨ç½²ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> contractExample = <span class="hljs-keyword">await</span> contractFactoryExample.<span class="hljs-title function_">deploy</span>(æ„é€ å‡½æ•°çš„å‚æ•°);<br><span class="hljs-keyword">await</span> contractExample.<span class="hljs-title function_">waitForDeployment</span>();<br></code></pre></td></tr></table></figure><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>ä»¥ä¸‹é¢è¿™ä¸ª <code>Test</code> åˆçº¦ä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract Test &#123;<br>    uint8 password;<br>    uint256 public number = 1;<br><br>    constructor(uint8 pw) payable &#123;<br>        password = pw;<br>    &#125;<br><br>    event getReturn(uint256 indexed num);<br>    event txReceive(string);<br><br>    function YouCanUseIt() public returns(uint256) &#123;<br>        number++;<br>        emit getReturn(number);<br>        return number;<br>    &#125;<br><br>    function transfer(address payable to, uint256 amount) public payable &#123;<br>        (bool success, ) = to.call&#123;value: amount&#125;(&quot;&quot;);<br>        if (!success) &#123;<br>            revert(&quot;Failed.&quot;);<br>        &#125;<br>    &#125;<br><br>    function getBalance() view public returns(uint256)&#123;<br>        return address(this).balance;<br>    &#125;<br><br>    receive() external payable &#123;<br>        emit txReceive(&quot;Has received.&quot;);<br>    &#125;<br><br>    fallback() external payable &#123;<br>        emit txReceive(&quot;Has fallbacked.&quot;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">contractDeploy</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-comment">// éƒ¨ç½²åˆçº¦ Testï¼Œæ„é€ å‡½æ•°è®¾ç½® paasword = 2ï¼Œå¹¶è½¬å…¥1 wei </span><br>    <span class="hljs-keyword">const</span> abiTest = [<br>        <span class="hljs-string">&quot;constructor(uint8 pw) payable&quot;</span>,<br>        <span class="hljs-string">&quot;function YouCanUseIt() public returns(uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function transfer(address payable to, uint256 amount) public payable&quot;</span>,<br>        <span class="hljs-string">&quot;function getBalance() public view returns(uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function password() external view returns(uint8)&quot;</span>,<br>        <span class="hljs-string">&quot;function number() external view returns(uint8)&quot;</span>,<br>        <span class="hljs-string">&quot;event getReturn(uint256 indexed num)&quot;</span>,<br>        <span class="hljs-string">&quot;event txReceive(string)&quot;</span>,<br>    ]<br>    <span class="hljs-keyword">const</span> bytecodeTest = <span class="hljs-string">&quot;ç•¥&quot;</span>;<br>    <span class="hljs-keyword">const</span> contractFactoryTest = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">ContractFactory</span>(abiTest, bytecodeTest, myWallet);<br>    <span class="hljs-keyword">const</span> contractTest = <span class="hljs-keyword">await</span> contractFactoryTest.<span class="hljs-title function_">deploy</span>(<span class="hljs-number">22</span>, &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">1</span>&#125;);<br>    <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">waitForDeployment</span>();<br>    <span class="hljs-comment">// è·å–åˆçº¦åœ°å€</span><br>    <span class="hljs-keyword">const</span> addressTest = contractTest.<span class="hljs-property">target</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆçº¦åœ°å€: <span class="hljs-subst">$&#123;addressTest&#125;</span>`</span>);<br>    <span class="hljs-comment">// è·å–ä½™é¢</span><br>    <span class="hljs-keyword">const</span> balance = <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">getBalance</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(balance);<br>&#125;<br><br><span class="hljs-title function_">contractDeploy</span>();<br></code></pre></td></tr></table></figure><h1 id="6-äº‹ä»¶çš„æ£€ç´¢ã€ç›‘å¬å’Œè¿‡æ»¤"><a href="#6-äº‹ä»¶çš„æ£€ç´¢ã€ç›‘å¬å’Œè¿‡æ»¤" class="headerlink" title="6. äº‹ä»¶çš„æ£€ç´¢ã€ç›‘å¬å’Œè¿‡æ»¤"></a>6. äº‹ä»¶çš„æ£€ç´¢ã€ç›‘å¬å’Œè¿‡æ»¤</h1><h2 id="1-äº‹ä»¶æ£€ç´¢"><a href="#1-äº‹ä»¶æ£€ç´¢" class="headerlink" title="1. äº‹ä»¶æ£€ç´¢"></a>1. äº‹ä»¶æ£€ç´¢</h2><p>ä½¿ç”¨åˆçº¦ç±»ä¸­çš„<code>queryFilter()</code> å‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> getEvents = <span class="hljs-keyword">await</span> contract.<span class="hljs-title function_">queryFilter</span>(<span class="hljs-string">&#x27;äº‹ä»¶å&#x27;</span>, èµ·å§‹åŒºå—, ç»“æŸåŒºå—)<br></code></pre></td></tr></table></figure><p>è¦æ£€ç´¢çš„äº‹ä»¶éœ€åŒ…å«åœ¨è‡ªå·±å†™çš„åˆçº¦ abi ä¸­ã€‚</p><h3 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><p>è¿˜æ˜¯ä¸Šé¢çš„ <code>Test</code> åˆçº¦ï¼Œè°ƒç”¨ä¸€æ¬¡ <code>YouCanUseIt</code> å‡½æ•°ï¼Œé€šè¿‡äº‹ä»¶ <code>getReturn</code> è·å– number çš„å€¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">events</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> abiTest = [<br>        <span class="hljs-string">&quot;constructor(uint8 pw) payable&quot;</span>,<br>        <span class="hljs-string">&quot;function YouCanUseIt() public returns(uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function transfer(address payable to, uint256 amount) public payable&quot;</span>,<br>        <span class="hljs-string">&quot;function getBalance() public view returns(uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function password() external view returns(uint8)&quot;</span>,<br>        <span class="hljs-string">&quot;function number() external view returns(uint8)&quot;</span>,<br>        <span class="hljs-string">&quot;event getReturn(uint256 indexed num)&quot;</span>,<br>        <span class="hljs-string">&quot;event txReceive(string)&quot;</span>,<br>    ]<br>    <span class="hljs-keyword">const</span> bytecodeTest = <span class="hljs-string">&quot;ç•¥&quot;</span>;<br>    <span class="hljs-keyword">const</span> contractFactoryTest = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">ContractFactory</span>(abiTest, bytecodeTest, myWallet);<br>    <span class="hljs-keyword">const</span> contractTest = <span class="hljs-keyword">await</span> contractFactoryTest.<span class="hljs-title function_">deploy</span>(<span class="hljs-number">22</span>, &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">1</span>&#125;);<br>    <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">waitForDeployment</span>();<br>    <br>    <span class="hljs-keyword">const</span> addressTest = contractTest.<span class="hljs-property">target</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆçº¦åœ°å€: <span class="hljs-subst">$&#123;addressTest&#125;</span>`</span>);<br>    <br>    <span class="hljs-keyword">const</span> balance = <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">getBalance</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆçº¦ä½™é¢: <span class="hljs-subst">$&#123;balance&#125;</span>`</span>);<br><br>    <span class="hljs-title function_">await</span> (<span class="hljs-keyword">await</span> contractTest.<span class="hljs-title class_">YouCanUseIt</span>()).<span class="hljs-title function_">wait</span>();<br>    <span class="hljs-keyword">const</span> currentHeight = <span class="hljs-keyword">await</span> providerSepolia.<span class="hljs-title function_">getBlockNumber</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰é«˜åº¦: <span class="hljs-subst">$&#123;currentHeight&#125;</span>`</span>);<br>    <span class="hljs-keyword">const</span> event_getReturn = <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">queryFilter</span>(<span class="hljs-string">&#x27;getReturn&#x27;</span>, currentHeight-<span class="hljs-number">100</span>, currentHeight);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event_getReturn[<span class="hljs-number">0</span>]);<br>&#125;<br><br><span class="hljs-title function_">events</span>()<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼Œ<code>topics</code> ç¬¬äºŒä¸ªå‚æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs eventLog">topics: [<br>&#x27;0x89add6c0d02657f10a2ccdbd6a2b4696a2e4a204ed5b7753ef58c26a16927fbb&#x27;,<br>    &#x27;0x0000000000000000000000000000000000000000000000000000000000000002&#x27;<br>],<br></code></pre></td></tr></table></figure><h2 id="2-äº‹ä»¶ç›‘å¬"><a href="#2-äº‹ä»¶ç›‘å¬" class="headerlink" title="2. äº‹ä»¶ç›‘å¬"></a>2. äº‹ä»¶ç›‘å¬</h2><p>å½“æˆ‘ä»¬æƒ³æŒç»­è·å–ä¸€ä¸ªäº‹ä»¶çš„å®æ—¶è°ƒç”¨æƒ…å†µæ—¶ï¼Œæ£€ç´¢å°±ä¸å¤ªè¡Œã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ <code>contract.on()</code> æŒç»­ç›‘å¬ï¼Œä½¿ç”¨ <code>contract.once()</code> ç›‘å¬ä¸€æ¬¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">contract.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;äº‹ä»¶å&quot;</span>, ç›‘å¬åˆ°äº‹ä»¶è§¦å‘æ—¶è°ƒç”¨çš„å‡½æ•°);<br>contract.<span class="hljs-title function_">once</span>(<span class="hljs-string">&quot;äº‹ä»¶å&quot;</span>, ç›‘å¬åˆ°äº‹ä»¶è§¦å‘æ—¶è°ƒç”¨çš„å‡½æ•°);<br></code></pre></td></tr></table></figure><h3 id="ä¾‹-1"><a href="#ä¾‹-1" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><p>è¿˜æ˜¯ <code>Test</code> åˆçº¦ï¼Œæˆ‘ä»¬æ‰‹åŠ¨åœ¨ Remix ä¸Šè°ƒç”¨å‡½æ•° <code>YouCanUseIt</code>ï¼ŒæŒç»­ç›‘å¬å®ƒçš„ <code>getReturn</code> äº‹ä»¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">events</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> abiTest = [<br>        <span class="hljs-string">&quot;constructor(uint8 pw) payable&quot;</span>,<br>        <span class="hljs-string">&quot;function YouCanUseIt() public returns(uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function transfer(address payable to, uint256 amount) public payable&quot;</span>,<br>        <span class="hljs-string">&quot;function getBalance() public view returns(uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;function password() external view returns(uint8)&quot;</span>,<br>        <span class="hljs-string">&quot;function number() external view returns(uint8)&quot;</span>,<br>        <span class="hljs-string">&quot;event getReturn(uint256 indexed num)&quot;</span>,<br>        <span class="hljs-string">&quot;event txReceive(string)&quot;</span>,<br>    ]<br>    <span class="hljs-keyword">const</span> bytecodeTest = <span class="hljs-string">&quot;ç•¥&quot;</span>;<br>    <span class="hljs-keyword">const</span> contractFactoryTest = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">ContractFactory</span>(abiTest, bytecodeTest, myWallet);<br>    <span class="hljs-keyword">const</span> contractTest = <span class="hljs-keyword">await</span> contractFactoryTest.<span class="hljs-title function_">deploy</span>(<span class="hljs-number">22</span>, &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">1</span>&#125;);<br>    <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">waitForDeployment</span>();<br>    <br>    <span class="hljs-keyword">const</span> addressTest = contractTest.<span class="hljs-property">target</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆçº¦åœ°å€: <span class="hljs-subst">$&#123;addressTest&#125;</span>`</span>);<br>    <br>    contractTest.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;getReturn&quot;</span>, <span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰ num çš„å€¼: <span class="hljs-subst">$&#123;num&#125;</span>`</span>);<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-äº‹ä»¶è¿‡æ»¤"><a href="#3-äº‹ä»¶è¿‡æ»¤" class="headerlink" title="3. äº‹ä»¶è¿‡æ»¤"></a>3. äº‹ä»¶è¿‡æ»¤</h2><p>é€šè¿‡ <code>contract.filters.äº‹ä»¶å</code> ï¼Œæ ¹æ®äº‹ä»¶çš„ <code>topic</code>ï¼ˆä¹Ÿå°±æ˜¯ <code>indexed</code> çš„é‚£ä¸ªå‚æ•°ï¼‰ï¼Œå¯¹äº‹ä»¶è¿›è¡Œç­›é€‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> filter = contract.<span class="hljs-property">filters</span>.<span class="hljs-title function_">EVENT_NAME</span>( ...args ) <br></code></pre></td></tr></table></figure><p><code>...args</code> æ˜¯è¯¥æ–¹æ³•çš„å‚æ•°ï¼Œä¸€èˆ¬æ˜¯ <code>null</code>ï¼Œå¯¹æŸä¸€å‚æ•°çš„ç­›é€‰æ¡ä»¶ï¼Œæˆ–æ•°ç»„ã€‚ç”±äºç¬¬0ä¸ª <code>topic</code> æ˜¯æ—¶é—´çš„å“ˆå¸Œï¼Œç­›é€‰ä»ç¬¬1ä¸ª <code>topic</code> å¼€å§‹ã€‚</p><ul><li><code>null</code> è¡¨ç¤ºä¸å¯¹è¯¥æ¡ä»¶è¿›è¡Œç­›é€‰ã€‚</li><li>æ•°ç»„ï¼Œå½“äº‹ä»¶å½“å‰ä½ç½®å‚æ•°çš„å€¼ä¸æ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªå…ƒç´ åŒ¹é…æ—¶ï¼Œé€šè¿‡ç­›é€‰ã€‚</li></ul><p>æˆ‘ä»¬æ”¹å†™ä¸€ä¸‹ <code>Test</code> åˆçº¦ä¸­çš„ <code>getReturn</code> äº‹ä»¶ï¼š<code>event getReturn(uint256 indexed num, bool indexed isOdd);</code></p><p>å®ƒæœ‰å¦‚ä¸‹3ä¸ª <code>topic</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs topics">topic 0: äº‹ä»¶å“ˆå¸Œ<br>topic 1: num// å½“å‰ num çš„å€¼<br>topic 2: isOdd// num æ˜¯å¦ä¸ºå¥‡æ•°<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆé’ˆå¯¹è¯¥äº‹ä»¶çš„è¿‡æ»¤å™¨çš„ä¸¤ä¸ªå‚æ•°å°±åˆ†åˆ«é’ˆå¯¹ topic1 å’Œ topic2ã€‚</p><p>å¦‚ï¼š</p><ol><li><p><code>num</code> ä»»æ„ï¼Œ<code>isOdd</code> ä¸º <code>true</code> </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> filter_getReturn = contractTest.<span class="hljs-property">filters</span>.<span class="hljs-title function_">getReturn</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>)<br></code></pre></td></tr></table></figure></li><li><p><code>num</code> ä¸º 1æˆ–2ï¼Œ<code>isOdd</code> ä»»æ„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> filter_getReturn = contractTest.<span class="hljs-property">filters</span>.<span class="hljs-title function_">getReturn</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]) <br></code></pre></td></tr></table></figure><p>ä½äºåé¢çš„ï¼Œä¸æŒ‡æ˜çš„ï¼Œé»˜è®¤ä¸ºä»»æ„ï¼Œä¸ç”¨å•ç‹¬å†™ <code>null</code>ã€‚</p></li></ol><p>å®Œæ•´æ¥çœ‹ï¼Œå°±æ˜¯ WTF ä¸Šçš„é‚£å¼ å›¾ç‰‡ï¼Œå·¦åˆ—æ˜¯è¯¥å‡½æ•°çš„å‚æ•°ï¼Œå³åˆ—ä¸ºå‚æ•°å¯¹åº”çš„ç­›é€‰æ¡ä»¶ã€‚ï¼ˆåªä¸è¿‡æ˜¯ç›´æ¥ä» <code>topic[1]</code> å¼€å§‹ï¼Œæ²¡æœ‰å¯¹ <code>topic[0]</code> çš„ç­›é€‰ï¼‰</p><p><img src="https://www.wtf.academy/assets/images/9-1-4273780b5cd8a46c30cc3fa2b0d174d5.png" alt="6.3.0"></p><h3 id="ä¾‹-2"><a href="#ä¾‹-2" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><p>å½“ <code>num</code> æ˜¯å¥‡æ•°æ—¶ï¼Œè¾“å‡ºè¯¥äº‹ä»¶çš„ä¸¤ä¸ªå‚æ•°ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">events</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> abiTest = [<br>        <span class="hljs-string">&quot;constructor(uint8 pw) payable&quot;</span>,<br>        <span class="hljs-string">&quot;function YouCanUseIt() public returns(uint256)&quot;</span>,<br>        <span class="hljs-string">&quot;event getReturn(uint256 indexed num, bool indexed isOdd)&quot;</span>,<br>    ]<br>    <span class="hljs-keyword">const</span> bytecodeTest = <span class="hljs-string">&quot;ç•¥&quot;</span>;<br>    <span class="hljs-keyword">const</span> contractFactoryTest = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">ContractFactory</span>(abiTest, bytecodeTest, myWallet);<br>    <span class="hljs-keyword">const</span> contractTest = <span class="hljs-keyword">await</span> contractFactoryTest.<span class="hljs-title function_">deploy</span>(<span class="hljs-number">22</span>);<br>    <span class="hljs-keyword">await</span> contractTest.<span class="hljs-title function_">waitForDeployment</span>();<br>    <br>    <span class="hljs-keyword">const</span> addressTest = contractTest.<span class="hljs-property">target</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆçº¦åœ°å€: <span class="hljs-subst">$&#123;addressTest&#125;</span>`</span>);<br><br>    <span class="hljs-keyword">const</span> filter_onlyOdd = contractTest.<span class="hljs-property">filters</span>.<span class="hljs-title function_">getReturn</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>);<br>    <br>    contractTest.<span class="hljs-title function_">on</span>(filter_onlyOdd, <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰ num çš„å€¼: <span class="hljs-subst">$&#123;res.args[<span class="hljs-number">0</span>]&#125;</span>, isOdd = <span class="hljs-subst">$&#123;res.args[<span class="hljs-number">1</span>]&#125;</span>`</span>);<br>    &#125;)<br><br></code></pre></td></tr></table></figure></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>javaScriptç¬”è®°</title>
    <link href="/2024/12/22/javaScript%E7%AC%94%E8%AE%B0/"/>
    <url>/2024/12/22/javaScript%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>ä¸º <code>ethers.js</code> çš„ <code>JavaScript</code> å…¥é—¨ï¼Œä¸»è¦å‚è€ƒï¼š</p><ul><li><a href="https://www.wtf.academy/docs/javascript-101/">WTF Academy</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript">JavaScript | MDN</a></li><li><a href="https://www.bilibili.com/video/BV18a4y1L7kD/?p=48&amp;share_source=copy_web&amp;vd_source=30458d0272bcd4393973b9abe093fff8">å¾®è½¯å®˜æ–¹ JavaScript å…¥é—¨æ•™ç¨‹</a></li><li><a href="https://www.bilibili.com/video/BV1b14y1w7Mg/?share_source=copy_web&amp;vd_source=30458d0272bcd4393973b9abe093fff8">JS å¼‚æ­¥ç¼–ç¨‹</a></li></ul><h1 id="1-å˜é‡å£°æ˜æ–¹å¼"><a href="#1-å˜é‡å£°æ˜æ–¹å¼" class="headerlink" title="1. å˜é‡å£°æ˜æ–¹å¼"></a>1. å˜é‡å£°æ˜æ–¹å¼</h1><p>ä¸»è¦æœ‰ä¸‰ç§ï¼š<code>var</code>ï¼Œ<code>let</code> å’Œ <code>const</code>ã€‚å…¶ä¸­ <code>var</code> ä¸æ¨èä½¿ç”¨ã€‚</p><h2 id="1-var"><a href="#1-var" class="headerlink" title="1. var"></a>1. <code>var</code></h2><p>åœ¨å‡½æ•°ä¸­ï¼Œä½œç”¨åŸŸä¸ºæ•´ä¸ªå‡½æ•°ï¼›å‡½æ•°å¤–åˆ™ä¸ºå…¨å±€ã€‚</p><p>ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºä¼šé€ æˆå…¨å±€å¯¹è±¡çš„æ±¡æŸ“ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Test</span> (<span class="hljs-params"></span>){<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {<br>        <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"In if, a = %d"</span>, a);<br>    }<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"a = %d"</span>, a);<br>}<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"%d"</span>, a);<br><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"%d"</span>, a);<br><span class="hljs-title class_">Test</span>();<br><span class="hljs-comment">/*è¾“å‡ºä¸ºï¼š</span><br><span class="hljs-comment">NaN</span><br><span class="hljs-comment">100</span><br><span class="hljs-comment">In if, a = 1</span><br><span class="hljs-comment">a = 1</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€å¤„è¾“å‡ºä¸º <code>NaN</code>ï¼Œä¹Ÿè¡¨æ˜äº†æ­¤æ—¶å˜é‡ <code>a</code> å·²å­˜åœ¨ï¼ˆåªæ˜¯æœªèµ‹å€¼ï¼‰ï¼Œè¡¨æ˜äº† <code>var</code> çš„ä½œç”¨åŸŸä¸ºå…¨å±€ä½œç”¨åŸŸï¼ˆ<code>function</code> å¤–çš„æ‰€æœ‰åœ°æ–¹ï¼‰ã€‚</p><h2 id="2-let"><a href="#2-let" class="headerlink" title="2. let"></a>2. <code>let</code></h2><p>ä½œç”¨åŸŸä¸ºå—çº§ï¼ˆä¹Ÿå°±æ˜¯ä¸€å¯¹ <code>{}</code> çš„èŒƒå›´å†…ï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Test</span> (<span class="hljs-params"></span>){<br>    <span class="hljs-keyword">let</span> a = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {<br>        <span class="hljs-keyword">let</span> a = <span class="hljs-number">1</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"In if, a = %d"</span>, a);<br>    }<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"a = %d"</span>, a);<br>}<br><br><span class="hljs-keyword">let</span> a = <span class="hljs-number">100</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"%d"</span>, a);<br><span class="hljs-title class_">Test</span>();<br><span class="hljs-comment">/*è¾“å‡ºä¸ºï¼š</span><br><span class="hljs-comment">100</span><br><span class="hljs-comment">In if, a = 1</span><br><span class="hljs-comment">a = 0</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œ <code>if</code> ä¸­çš„å˜é‡ <code>a</code> ä»…åœ¨ <code>if</code> å†…ç”Ÿæ•ˆï¼Œä¸”å¯¹ <code>a</code> çš„æ”¹å˜ä¸å½±å“å¤–éƒ¨çš„å¦ä¸€ä¸ª <code>a</code>ã€‚ï¼ˆä½†åº”å°½é‡é¿å…è¿™ç§è„‘æº¢è¡€è¡Œä¸ºï¼‰</p><h2 id="3-const"><a href="#3-const" class="headerlink" title="3. const"></a>3. <code>const</code></h2><p>ä¸ <code>let</code> ç±»ä¼¼ï¼Œä½†å¿…é¡»åœ¨å£°æ˜æ—¶èµ‹å€¼ï¼Œä¸”æ— æ³•æ”¹å˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">0</span>;<br><br><span class="hljs-comment">// è¿™æ ·æ˜¯ä¸å¯¹çš„ï¼Œå¿…é¡»åœ¨å£°æ˜æ—¶èµ‹å€¼</span><br><span class="hljs-keyword">const</span> b;<br>b = <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">// è¿™æ ·ä¹Ÿæ˜¯ä¸å¯ä»¥çš„ï¼Œå¸¸é‡çš„å€¼æ— æ³•æ”¹å˜</span><br>a = <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><h1 id="2-æ•°æ®ç±»å‹"><a href="#2-æ•°æ®ç±»å‹" class="headerlink" title="2. æ•°æ®ç±»å‹"></a>2. æ•°æ®ç±»å‹</h1><p>ä¸»è¦åˆ†ä¸ºï¼š</p><ol><li>å€¼ç±»å‹ï¼ˆ7ä¸ªåŸºæœ¬ç±»å‹ï¼‰ï¼š<code>Number</code>ï¼Œ<code>BigInt</code>ï¼ˆä»»æ„å¤§æ•´æ•°ï¼‰ï¼Œ<code>String</code>ï¼Œ<code>Boolean</code>ï¼Œ<code>Null</code>ï¼ˆç©ºï¼Œæ•…æ„çš„ç©ºå€¼ï¼‰ï¼Œ<code>Undefined</code>ï¼ˆæœªå®šä¹‰ï¼Œæš‚æœªèµ‹å€¼ï¼‰ï¼Œ<code>Symbol</code>ã€‚</li><li>å¼•ç”¨æ•°æ®ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ï¼‰ï¼š<code>Array</code>ï¼Œ<code>Function</code>ï¼Œ<code>Object</code>ï¼Œ<code>Date</code>ï¼Œ<code>RegExp</code>ï¼ˆæ­£åˆ™ï¼‰ç­‰ã€‚</li></ol><h2 id="åŸºæœ¬ç±»å‹"><a href="#åŸºæœ¬ç±»å‹" class="headerlink" title="åŸºæœ¬ç±»å‹"></a>åŸºæœ¬ç±»å‹</h2><h3 id="1-Number"><a href="#1-Number" class="headerlink" title="1. Number"></a>1. <code>Number</code></h3><p>æ•´æ•°æˆ–åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> a = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">let</span> b = <span class="hljs-number">1.23</span>;<br><span class="hljs-keyword">let</span> c = <span class="hljs-number">1e5</span>;<br></code></pre></td></tr></table></figure><h4 id="NaNï¼ŒInfinity-å’Œ-Infinity"><a href="#NaNï¼ŒInfinity-å’Œ-Infinity" class="headerlink" title="NaNï¼ŒInfinity å’Œ -Infinity"></a><code>NaN</code>ï¼Œ<code>Infinity</code> å’Œ <code>-Infinity</code></h4><p>ä¸‰ä¸ªç‰¹æ®Šçš„å€¼ã€‚</p><ol><li><p><code>NaN</code>ï¼ˆNot A Numberï¼‰ï¼šå½“è¿ç®—ç»“æœä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—æ—¶å‡ºç°ã€‚å¦‚ï¼š<code>let d = 0 / 0;</code> ç»“æœå°±æ˜¯ <code>NaN</code>ã€‚</p></li><li><p><code>Infinity</code>ï¼šæ­£æ— ç©·ã€‚å¤§äº <code>Number.MAX_VALUE</code>ï¼ˆ<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="8.416ex" height="2.09ex" role="img" focusable="false" viewBox="0 -841.7 3719.7 923.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(1000,0)"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(1500,0)"></path></g></g></g><g data-mml-node="mo" transform="translate(2219.4,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(3219.7,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container>ï¼‰çš„å€¼å°†è¢«è®°ä¸º <code>Infinity</code>ã€‚</p><p>å¦‚ä¸‹ä¸¤ç§æƒ…å†µç»“æœå‡ä¸º <code>Infinity</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> e = <span class="hljs-number">1</span> / <span class="hljs-number">0</span>;<br><span class="hljs-keyword">let</span> f = <span class="hljs-number">2e1024</span>;<br></code></pre></td></tr></table></figure></li><li><p><code>-Infinity</code>ï¼šè´Ÿæ— ç©·ã€‚å°äº <code>-Number.MAX_VALUE</code> çš„å€¼è¢«è®°ä¸º <code>-Infinity</code>ã€‚</p><p>å¦‚ä¸‹ä¸¤ç§æƒ…å†µç»“æœå‡ä¸º <code>-Infinity</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> g = <span class="hljs-number">1</span> / (-<span class="hljs-number">0</span>);<br><span class="hljs-keyword">let</span> h = -(<span class="hljs-number">2e1024</span>);<br></code></pre></td></tr></table></figure></li></ol><h3 id="2-BigInt"><a href="#2-BigInt" class="headerlink" title="2. BigInt"></a>2. <code>BigInt</code></h3><p>å¯ä»¥è¡¨ç¤ºä»»æ„å¤§å°çš„<strong>æ•´æ•°</strong>ã€‚</p><p>é€šè¿‡åœ¨æ•´æ•°æœ«å°¾åŠ  <code>n</code> æˆ–ä½¿ç”¨ <code>BigInt()</code> å‡½æ•°åˆ›å»ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> i = <span class="hljs-title class_">BigInt</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-property">MAX_VALUE</span>);<br><span class="hljs-keyword">let</span> j = i + <span class="hljs-number">1n</span>;<br></code></pre></td></tr></table></figure><h3 id="3-String"><a href="#3-String" class="headerlink" title="3. String"></a>3. <code>String</code></h3><h4 id="å­—ç¬¦ä¸²çš„åˆ›å»º"><a href="#å­—ç¬¦ä¸²çš„åˆ›å»º" class="headerlink" title="å­—ç¬¦ä¸²çš„åˆ›å»º"></a>å­—ç¬¦ä¸²çš„åˆ›å»º</h4><p>ä½¿ç”¨ <code>''</code> æˆ– <code>""</code> åˆ›å»ºã€‚ä¸€ä½†åˆ›å»ºå°±ä¸å¯ä¿®æ”¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> k = <span class="hljs-string">"Hello?"</span>;<span class="hljs-comment">// ä¸€èˆ¬ä½¿ç”¨ const åˆ›å»º</span><br>k[<span class="hljs-number">2</span>] = <span class="hljs-string">'L'</span>;<span class="hljs-comment">// è¿™æ­¥æ— æ³•æ‰§è¡Œ</span><br></code></pre></td></tr></table></figure><h4 id="å­—ç¬¦ä¸²çš„è®¿é—®"><a href="#å­—ç¬¦ä¸²çš„è®¿é—®" class="headerlink" title="å­—ç¬¦ä¸²çš„è®¿é—®"></a>å­—ç¬¦ä¸²çš„è®¿é—®</h4><p>å¯ä»¥ä½¿ç”¨ <code>[]</code> æˆ– <code>charAt()</code> æ¥è®¿é—®å­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—ç¬¦ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> l = k[<span class="hljs-number">2</span>];<br><span class="hljs-keyword">const</span> m = k.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure><p>ç»“æœå‡ä¸º <code>l</code>ã€‚</p><h4 id="å­—ç¬¦ä¸²çš„æ‹¼æ¥ä¸æ¯”è¾ƒ"><a href="#å­—ç¬¦ä¸²çš„æ‹¼æ¥ä¸æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦ä¸²çš„æ‹¼æ¥ä¸æ¯”è¾ƒ"></a>å­—ç¬¦ä¸²çš„æ‹¼æ¥ä¸æ¯”è¾ƒ</h4><p>å¯ä»¥é€šè¿‡ <code>+</code> ç›´æ¥æ‹¼æ¥ã€‚</p><p>å¯ä»¥ç›´æ¥é€šè¿‡ <code>&gt;</code>ï¼Œ<code>&lt;</code>ï¼Œ<code>==</code>ï¼Œ<code>===</code> ç­‰è¿›è¡Œæ¯”è¾ƒã€‚æ¯”è¾ƒæ—¶åŒºåˆ†å¤§å°å†™ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"a"</span> == <span class="hljs-string">"A"</span>);          <span class="hljs-comment">// false</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'a'</span> &gt;= <span class="hljs-string">'a'</span>);  <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"CUIT"</span> &lt; <span class="hljs-string">"cuit"</span>);         <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"CUI"</span> + <span class="hljs-string">'T'</span> === <span class="hljs-string">'CUIT'</span>);  <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><h4 id="æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²"></a>æ¨¡æ¿å­—ç¬¦ä¸²</h4><p>é€šè¿‡yä¸€å¯¹åå¼•å· <code>`` </code> åˆ›å»ºçš„å­—ç¬¦ä¸²ä¸ºæ¨¡æ¿å­—ç¬¦ä¸²ã€‚</p><p>æ¨¡æ¿å­—ç¬¦ä¸²ä¸­å¯ä»¥é€šè¿‡ <code>${}</code> æ’å…¥å˜é‡å¹¶è§£æã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Name</span> = <span class="hljs-string">"victifa"</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Age</span> = <span class="hljs-number">18</span>;<br><span class="hljs-keyword">const</span> msg = <span class="hljs-string">`å§“åï¼š<span class="hljs-subst">${Name}</span>ï¼Œå¹´é¾„ï¼š<span class="hljs-subst">${Age}</span>`</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg);<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆè¾“å‡ºï¼š<code>å§“åï¼švictifaï¼Œå¹´é¾„ï¼š18</code>ã€‚</p><h3 id="4-Boolean"><a href="#4-Boolean" class="headerlink" title="4. Boolean"></a>4. <code>Boolean</code></h3><p><code>true</code> æˆ– <code>false</code>ã€‚</p><h3 id="5-Null"><a href="#5-Null" class="headerlink" title="5. Null"></a>5. <code>Null</code></h3><p>è¡¨ç¤ºä¸å­˜åœ¨æˆ–æ— æ•ˆçš„å¯¹è±¡æˆ–åœ°å€å¼•ç”¨ã€‚ï¼ˆé€šå¸¸æ˜¯æœ‰æ„ä¸ºä¹‹ï¼‰</p><h3 id="6-Undefined"><a href="#6-Undefined" class="headerlink" title="6. Undefined"></a>6. <code>Undefined</code></h3><p>è‡ªåŠ¨èµ‹ç»™åˆšå£°æ˜çš„å˜é‡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> n;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n, o);<span class="hljs-comment">// å‡ä¸º undefined</span><br><span class="hljs-keyword">var</span> o = <span class="hljs-number">12</span>;<br></code></pre></td></tr></table></figure><h3 id="7-Symbol"><a href="#7-Symbol" class="headerlink" title="7. Symbol"></a>7. <code>Symbol</code></h3><p>ä¸€ç§å”¯ä¸€ä¸”ä¸å¯å˜çš„å€¼ï¼Œç›®çš„æ˜¯åˆ›å»ºå”¯ä¸€çš„å±æ€§é”®ï¼Œä¿è¯ä¸ä¸ä»£ç ä¸­çš„å…¶ä»–é”®å†²çªã€‚</p><p>é€šè¿‡ <code>Symbol([description])</code> åˆ›å»ºã€‚å…¶ä¸­ï¼Œ<code>description</code> å¯ä»¥æ²¡æœ‰ã€‚</p><p>æ¯ä¸€ä¸ªé€šè¿‡ <code>Symbol()</code> è¿”å›çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sym = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">"cuit"</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sym === <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">"cuit"</span>));<span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><h2 id="å¯¹è±¡ç±»å‹"><a href="#å¯¹è±¡ç±»å‹" class="headerlink" title="å¯¹è±¡ç±»å‹"></a>å¯¹è±¡ç±»å‹</h2><h3 id="1-æ•°ç»„-Array"><a href="#1-æ•°ç»„-Array" class="headerlink" title="1. æ•°ç»„ Array"></a>1. æ•°ç»„ <code>Array</code></h3><h4 id="æ•°ç»„çš„å£°æ˜å’Œè¯»å†™"><a href="#æ•°ç»„çš„å£°æ˜å’Œè¯»å†™" class="headerlink" title="æ•°ç»„çš„å£°æ˜å’Œè¯»å†™"></a>æ•°ç»„çš„å£°æ˜å’Œè¯»å†™</h4><p>æˆ‘ä»¬å¯ä»¥å°†ä¸åŒç±»å‹çš„æ•°æ®å­˜åœ¨åŒä¸€ä¸ªæ•°ç»„é‡Œã€‚</p><p>æ•°ç»„å£°æ˜æ—¶ï¼Œä¸éœ€è¦æŒ‡æ˜é•¿åº¦ã€‚</p><p>å¦‚ä¸‹ä¸‰ç§å£°æ˜æ–¹å¼éƒ½æ˜¯å¯ä»¥çš„ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> arr1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];<br><span class="hljs-keyword">let</span> arr2 = [<span class="hljs-number">1</span>, <span class="hljs-string">"vic"</span>, <span class="hljs-literal">true</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], arr1];<br><span class="hljs-keyword">let</span> arr3 = [];<br></code></pre></td></tr></table></figure><p>æ­£å¸¸è¯»å†™å³å¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">arr2[<span class="hljs-number">1</span>] = <span class="hljs-string">"victifa"</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr2);<span class="hljs-comment">// è¾“å‡ºï¼š[ 1, 'victifa', true, [ 1, 2, 3 ], [ 1, 2, 3, 4 ] ]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr2[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>], arr2[<span class="hljs-number">4</span>][<span class="hljs-number">2</span>]);<span class="hljs-comment">// è¾“å‡ºï¼št 3</span><br><span class="hljs-comment">// å¯¹äºè¶…å‡ºç°æœ‰é•¿åº¦çš„æ›´æ”¹ï¼Œä¼šè‡ªåŠ¨åœ°æ·»åŠ ç©ºæ§½æ¥ä½¿æ•°ç»„å˜é•¿</span><br>arr3[<span class="hljs-number">4</span>] = <span class="hljs-number">4</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr3);<span class="hljs-comment">// è¾“å‡ºï¼š[ &lt;4 empty items&gt;, 4 ]</span><br></code></pre></td></tr></table></figure><h4 id="æ•°ç»„çš„æˆå‘˜"><a href="#æ•°ç»„çš„æˆå‘˜" class="headerlink" title="æ•°ç»„çš„æˆå‘˜"></a>æ•°ç»„çš„æˆå‘˜</h4><h5 id="1-arr-length"><a href="#1-arr-length" class="headerlink" title="1. arr.length"></a>1. <code>arr.length</code></h5><p>æ•°ç»„çš„é•¿åº¦ã€‚</p><p>æ•°ç»„çš„ <code>length</code> å±æ€§ä¸æ•°å€¼å±æ€§æ˜¯ç›¸è¿æ¥çš„ã€‚å…·ä½“ä½“ç°åœ¨ï¼š</p><ul><li>å¢åŠ  <code>length</code> ä¼šé€šè¿‡æ·»åŠ ç©ºæ§½æ¥æ‰©å±•æ•°ç»„ï¼Œè€Œä¸æ˜¯åˆ›å»ºä»»ä½•æ–°å…ƒç´ â€”â€”ç”šè‡³ä¸ä¼šæ˜¯ <code>undefined</code>ã€‚</li><li>å‡å° <code>length</code> ä¼šæˆªæ–­æ•°ç»„ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> arr4 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];<br>arr4.<span class="hljs-property">length</span> = <span class="hljs-number">2</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr4);<span class="hljs-comment">// [ 1, 2 ]</span><br>arr4.<span class="hljs-property">length</span> = <span class="hljs-number">10</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr4);<span class="hljs-comment">// [ 1, 2, &lt;8 empty items&gt; ]</span><br></code></pre></td></tr></table></figure><h5 id="2-arr-pop-å’Œ-arr-push"><a href="#2-arr-pop-å’Œ-arr-push" class="headerlink" title="2. arr.pop() å’Œ arr.push()"></a>2. <code>arr.pop()</code> å’Œ <code>arr.push()</code></h5><p><code>arr.push()</code> å¯ä»¥åœ¨æ•°ç»„æœ«å°¾æ·»åŠ è‡³å°‘ä¸€ä¸ªå…ƒç´ ï¼Œ<code>arr.pop()</code> å¯ä»¥åˆ é™¤æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›å®ƒï¼ˆç©ºæ•°ç»„è¿”å› <code>undefined</code>ï¼‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> arr5 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br>arr5.<span class="hljs-title function_">push</span>(<span class="hljs-number">4</span>);<br>arr5.<span class="hljs-title function_">push</span>(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);<br>arr5.<span class="hljs-title function_">push</span>([<span class="hljs-number">7</span>, <span class="hljs-number">8</span>]);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr5);<span class="hljs-comment">// è¾“å‡ºï¼š[ 1, 2, 3, 4, 5, 6, [ 7, 8 ] ]</span><br><span class="hljs-keyword">let</span> tmp = arr5.<span class="hljs-title function_">pop</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tmp, arr5);<span class="hljs-comment">// è¾“å‡ºï¼š[ 7, 8 ] [ 1, 2, 3, 4, 5, 6 ]</span><br></code></pre></td></tr></table></figure><h5 id="3-arr-slice"><a href="#3-arr-slice" class="headerlink" title="3. arr.slice()"></a>3. <code>arr.slice()</code></h5><p>ç”¨æ³•ï¼š <code>arr.slice(start, end)</code>ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ˆåŸæ•°ç»„ä» <code>start</code> åˆ° <code>end</code> çš„ä¸€ä¸ªåˆ‡ç‰‡ï¼Œä½† <code>end</code> ä¸å–ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> arr6 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>];<br>arr6.<span class="hljs-property">length</span> = <span class="hljs-number">4</span>;<br>arr6.<span class="hljs-title function_">push</span>(<span class="hljs-number">5</span>, <span class="hljs-number">6</span>);<br><span class="hljs-comment">// [ 1, 2 , empty, empty, 5, 6 ], arr6.length = 6</span><br></code></pre></td></tr></table></figure><p>å‚æ•° <code>end</code> å’Œ <code>start</code> å‡ä¸ºå¯é€‰é¡¹ï¼Œå‡ä¸å†™è¿”å›å®Œæ•´çš„åŸæ•°ç»„ï¼Œåªå†™ä¸€ä¸ªé»˜è®¤ä¸º <code>start</code>ï¼Œå‡å­˜åœ¨æ—¶ï¼š</p><ol><li><p><code>start</code>ï¼šèµ·å§‹å¤„çš„ç´¢å¼•</p><ul><li><code>start &lt; 0</code>ï¼Œ ä»æ•°ç»„æœ«å°¾å¼€å§‹å–ï¼Œç­‰ä»·äº <code>start + arr.length</code></li><li>å¤§äºæ•°ç»„é•¿åº¦ï¼Œä¸æå»ä»»ä½•å…ƒç´ </li><li><code>&lt; -arr.length</code> æˆ–æ²¡å†™ï¼Œé»˜è®¤ä¸º 0</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">6</span>,<span class="hljs-number">5</span>));  <span class="hljs-comment">// ç›¸å½“äºå–ç´¢å¼• [0,5) çš„å€¼ï¼š[ 2, &lt;2 empty items&gt;, 5 ]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(<span class="hljs-number">7</span>, <span class="hljs-number">2</span>));<span class="hljs-comment">// å¤§äºæ•°ç»„é•¿åº¦ï¼Œä¸å–äº†ï¼š[]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">7</span>, <span class="hljs-number">2</span>));<span class="hljs-comment">// ç›¸å½“äºå– [0,2) çš„å€¼ï¼š[ 1, 2 ]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(<span class="hljs-string">''</span>,<span class="hljs-string">'2'</span>));<span class="hljs-comment">// åŒä¸Š</span><br></code></pre></td></tr></table></figure></li><li><p><code>end</code>ï¼šç»ˆæ­¢å¤„çš„ç´¢å¼•</p><ul><li><code>start &lt; 0</code>ï¼Œ ä»æ•°ç»„æœ«å°¾å¼€å§‹å–</li><li><code>&gt;= arr.length</code> æˆ–æ²¡å†™ï¼Œé»˜è®¤æå–åˆ°æ•°ç»„æœ«å°¾</li><li><code>&lt; -arr.length</code> æ—¶ï¼Œä½¿ç”¨ 0</li><li>é€šè¿‡ä¸Šè¿°ä¸‰ç§æ–¹å¼è§„èŒƒåï¼Œè‹¥ <code>end &lt;= start</code>ï¼Œåˆ™ä¸æå–</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">3</span>));<span class="hljs-comment">// ç›¸å½“äºç´¢å¼• [0, 3) çš„å€¼ï¼š[ 1, 2, &lt;1 empty item&gt; ]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>));<span class="hljs-comment">// ç›¸å½“äºç´¢å¼• [0, 6] çš„å€¼ï¼š[ 1, 2, &lt;2 empty items&gt;, 5, 6 ]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, ));<span class="hljs-comment">// ç›¸å½“äºç´¢å¼• [0, 6] çš„å€¼ï¼š[ 1, 2, &lt;2 empty items&gt;, 5, 6 ]</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr6.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">7</span>));<span class="hljs-comment">// ç›¸å½“äºç´¢å¼• [0, 0) çš„å€¼ï¼š[]</span><br></code></pre></td></tr></table></figure></li></ol><h5 id="4-arr-splice"><a href="#4-arr-splice" class="headerlink" title="4. arr.splice()"></a>4. <code>arr.splice()</code></h5><p>ç”¨æ³•ï¼š<code>splice(start, deleteCount, item1, item2, Â·Â·Â·, itemN)</code>ï¼Œç”¨äºå°±åœ°ç§»é™¤æ•°ç»„å…ƒç´ å¹¶æ·»åŠ æ–°çš„å…ƒç´ ï¼Œæˆ–ä»…ç§»é™¤ï¼Œä»…æ·»åŠ ï¼Œé¥­å›åˆ é™¤çš„å…ƒç´ ã€‚</p><p>å‚æ•°ä¸­ï¼Œ <code>start</code> å¿…é¡»æœ‰ï¼Œå…¶ä½™ä¸ºå¯é€‰é¡¹ã€‚</p><p>ä¸€ä¸‹æ¯ä¸€æ¬¡è¾“å‡ºå‡ä»¥åŸ <code>arr6</code>ï¼ˆ<code>[ 1, 2 , empty, empty, 5, 6 ]</code>ï¼Œlength = 6ï¼‰ ä¸ºåŸºç¡€</p><ol><li><code>start</code>ï¼šå¼€å§‹æ”¹å˜çš„ä½ç½®çš„ç´¢å¼•<ul><li><code>&lt; 0</code> æˆ– <code>&lt; -arr.length</code>ï¼ŒåŒä¸Šè¿›è¡Œè§„èŒƒåŒ–</li><li><code>&gt;= arr.length</code>ï¼Œé»˜è®¤åˆ°æ•°ç»„æœ«å°¾ï¼Œè¡¨ç°ä¸ºæ— æ³•åˆ é™¤å…ƒç´ ï¼Œä»…èƒ½æ·»åŠ </li></ul></li><li><code>deleteCount</code>ï¼šä» <code>start</code> å¼€å§‹ï¼Œåˆ é™¤çš„å…ƒç´ æ•°é‡<ul><li>ä¸å†™ï¼Œæˆ–å¤§äºç­‰äºä» <code>start</code> å¼€å§‹åˆ°ç»“æŸçš„å…ƒç´ çš„æ•°é‡ï¼Œåˆ™ä» <code>start</code> å¼€å§‹åˆ°ç»“æŸçš„æ‰€æœ‰å…ƒç´ å‡åˆ é™¤</li><li><code>&lt;= 0</code>ï¼Œä¸åˆ é™¤ï¼Œä½†åº”è‡³å°‘æŒ‡å®šä¸€ä¸ªæ–°å…ƒç´ </li></ul></li><li><code>item</code>ï¼šä» <code>start</code> å¼€å§‹ï¼ŒåŠ å…¥æ•°ç»„çš„å…ƒç´ ã€‚</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> tmp = arr6.<span class="hljs-title function_">splice</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-string">"Design"</span>, <span class="hljs-string">"ant."</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tmp, arr6);<br><span class="hljs-comment">// åˆ é™¤:[ &lt;2 empty items&gt;, 5 ]ï¼Œç»“æœï¼š[ 1, 2, 'Design', 'ant.', 6 ]</span><br><br><span class="hljs-comment">// è¿˜æ˜¯åŸæ¥çš„ arr6</span><br><span class="hljs-keyword">let</span> tmp = arr6.<span class="hljs-title function_">splice</span>(-<span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-string">"Designant"</span>, <span class="hljs-string">'.'</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tmp, arr6);<br><span class="hljs-comment">// åˆ é™¤ï¼š[]ï¼Œç»“æœï¼š[ 1, 'Designant', '.', 2, &lt;2 empty items&gt;, 5, 6 ]</span><br><br><span class="hljs-keyword">let</span> tmp = arr6.<span class="hljs-title function_">splice</span>(-<span class="hljs-number">7</span>, <span class="hljs-title class_">Infinity</span>, <span class="hljs-string">"Swan Song"</span>, <span class="hljs-string">"Astral Quantization"</span>, <span class="hljs-string">"Designant."</span> );<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tmp, arr6);<br><span class="hljs-comment">// åˆ é™¤ï¼š[ 1, 2, &lt;2 empty items&gt;, 5, 6 ]ï¼Œç»“æœï¼š[ 'Swan Song', 'Astral Quantization', 'Designant.' ]</span><br></code></pre></td></tr></table></figure><h5 id="5-arr-indexOf"><a href="#5-arr-indexOf" class="headerlink" title="5. arr.indexOf()"></a>5. <code>arr.indexOf()</code></h5><p>ç”¨æ³•ï¼š<code>indexOf(searchElement, fromIndex)</code>ï¼Œè¿”å›æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°ç»™å®šå…ƒç´ çš„ä¸‹æ ‡ï¼ˆä½¿ç”¨ <code>===</code> åˆ¤æ–­ï¼Œ<code>empty</code> ä¼šè¢«è·³è¿‡ï¼‰ï¼Œä¸å­˜åœ¨è¿”å› -1ã€‚</p><p>ä¸¤ä¸ªå‚æ•°ä¸­ï¼Œ<code>searchElement</code> å¿…é¡»æœ‰ï¼Œ<code>fromIndex</code> åŒä¸Šä¸¤ç§ä¸€æ ·è§„èŒƒåŒ–ã€‚</p><p>ä»¥ä¸‹å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">updateSongList</span>(<span class="hljs-params">songList, songName</span>) {<br><span class="hljs-keyword">if</span> (songList.<span class="hljs-title function_">indexOf</span>(songName) === -<span class="hljs-number">1</span>) {<br>songList.<span class="hljs-title function_">push</span>(songName);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`"<span class="hljs-subst">${songName}</span>" is now added to the collection.`</span>);<br>}<br><span class="hljs-keyword">else</span> {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`"<span class="hljs-subst">${songName}</span>" is already in the collection.`</span>);<br>}<br>}<br><br><span class="hljs-keyword">let</span> songList = [ <span class="hljs-string">"Dual Doom Deathmatch"</span>, <span class="hljs-string">"Waltz for Lorelei"</span>, <span class="hljs-string">"Inverted World"</span>, <span class="hljs-string">"MVURBD"</span> ];<br><span class="hljs-title function_">updateSongList</span>(songList, <span class="hljs-string">"Vulcanus"</span>);<br><span class="hljs-title function_">updateSongList</span>(songList, <span class="hljs-string">"Inverted World"</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(songList);<br><span class="hljs-comment">/* è¾“å‡º</span><br><span class="hljs-comment">"Vulcanus" is now added to the collection.</span><br><span class="hljs-comment">"Inverted World" is already in the collection.</span><br><span class="hljs-comment">[</span><br><span class="hljs-comment">  'Dual Doom Deathmatch',</span><br><span class="hljs-comment">  'Waltz for Lorelei',</span><br><span class="hljs-comment">  'Inverted World',</span><br><span class="hljs-comment">  'MVURBD',</span><br><span class="hljs-comment">  'Vulcanus'</span><br><span class="hljs-comment">]</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><h3 id="2-å‡½æ•°-Function"><a href="#2-å‡½æ•°-Function" class="headerlink" title="2. å‡½æ•° Function"></a>2. å‡½æ•° <code>Function</code></h3><p>ä¸€ä¸ªç®€å•çš„å‡½æ•°çš„å£°æ˜å’Œä½¿ç”¨è§ä¸Šæ–¹ <code>updateSongList</code> å‡½æ•°å³å¯ã€‚</p><p>ä¸‹é¢ç€é‡çœ‹å‡½æ•°è¡¨è¾¾å¼å’Œç®­å¤´å‡½æ•°ã€‚</p><h4 id="å‡½æ•°è¡¨è¾¾å¼"><a href="#å‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="å‡½æ•°è¡¨è¾¾å¼"></a>å‡½æ•°è¡¨è¾¾å¼</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> function_expression = <span class="hljs-keyword">function</span> [name]([param1[, param2[, ..., paramN]]]) {<br>   <span class="hljs-comment">/* statements */</span><br>};<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ <code>[name]</code> å¯ä»¥çœç•¥ï¼Œä»è€Œåˆ›å»ºåŒ¿åå‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> factorial = <span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) {<br>    <span class="hljs-keyword">if</span> (num === <span class="hljs-number">0</span>) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    }<br>    <span class="hljs-keyword">else</span> {<br>        <span class="hljs-keyword">let</span> res = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= num; i++) {<br>            res *= i;<br>        }<br>        <span class="hljs-keyword">return</span> res;<br>    }<br>}<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">factorial</span>(<span class="hljs-number">10</span>));<br></code></pre></td></tr></table></figure><p>å…·ä½“ä½¿ç”¨ä¸æ™®é€šçš„å‡½æ•°æ²¡ä»€ä¹ˆå·®åˆ«ã€‚</p><h4 id="ç®­å¤´å‡½æ•°è¡¨è¾¾å¼"><a href="#ç®­å¤´å‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="ç®­å¤´å‡½æ•°è¡¨è¾¾å¼"></a>ç®­å¤´å‡½æ•°è¡¨è¾¾å¼</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">funcName</span> = (<span class="hljs-params">param1, Â·Â·Â·, paramN</span>) =&gt; {<br>  <span class="hljs-comment">/* statements */</span><br>}<br></code></pre></td></tr></table></figure><p>å½“åªæœ‰ä¸€ä¸ªç®€å•å‚æ—¶ï¼Œå¯ä»¥çœç•¥å‚æ•°çš„æ‹¬å·ï¼Œç®€åŒ–ä¸ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">funcName</span> = param =&gt; {<br>  <span class="hljs-comment">/* statements */</span><br>}<br></code></pre></td></tr></table></figure><p>å½“å‡½æ•°ç›´æ¥è¿”å›è¡¨è¾¾å¼æ—¶ï¼Œå¯ä»¥çœå»å¤§æ‹¬å·ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">funcName</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;<br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç®­å¤´å‡½æ•°åº”ç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">fact</span> = num =&gt; {<br><span class="hljs-keyword">if</span> (num === <span class="hljs-number">0</span>) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    }<br>    <span class="hljs-keyword">else</span> {<br>        <span class="hljs-keyword">let</span> res = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= num; i++) {<br>            res *= i;<br>        }<br>        <span class="hljs-keyword">return</span> res;<br>    }<br>}<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">fact</span>(<span class="hljs-number">10</span>));<br></code></pre></td></tr></table></figure><h3 id="3-å¯¹è±¡-Object"><a href="#3-å¯¹è±¡-Object" class="headerlink" title="3. å¯¹è±¡ Object"></a>3. å¯¹è±¡ <code>Object</code></h3><p>æŠŠä¸€å †é”®å€¼å¯¹åŒ…è£¹èµ·æ¥ï¼Œç±»ä¼¼äºå­—å…¸ã€‚å…¶ä¸­ï¼Œå±æ€§é”®å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ– <code>Symbol</code> ç±»å‹ï¼Œå±æ€§å€¼ä»»æ„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> empty = {};<br><span class="hljs-keyword">const</span> sym = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">"cuit"</span>);<br><span class="hljs-keyword">const</span> example = {<br><span class="hljs-attr">name</span>: <span class="hljs-string">"vic"</span>,<br><span class="hljs-attr">sym</span>: <span class="hljs-literal">true</span>,<br><span class="hljs-attr">hi</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) { <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello"</span>; },<br>}<br></code></pre></td></tr></table></figure><h4 id="å¯¹è±¡çš„è¯»å†™"><a href="#å¯¹è±¡çš„è¯»å†™" class="headerlink" title="å¯¹è±¡çš„è¯»å†™"></a>å¯¹è±¡çš„è¯»å†™</h4><p>è¯»å–ï¼š<code>å¯¹è±¡å['é”®å']</code> æˆ– <code>å¯¹è±¡å.é”®å</code></p><p>å†™å…¥ï¼šè¯»å–ä¸å­˜åœ¨çš„é”®æ—¶ä¼šæ·»åŠ è¿™ä¸ªé”®ï¼Œå¹¶å†™å…¥ç»™å‡ºçš„å€¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">example.<span class="hljs-property">name</span> = <span class="hljs-string">"victifa"</span>;<br>exapmle.<span class="hljs-property">age</span> = <span class="hljs-number">18</span>;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(example.<span class="hljs-property">age</span>);<span class="hljs-comment">// 18</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(example[<span class="hljs-string">'name'</span>]);<span class="hljs-comment">// victifa</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(example.<span class="hljs-title function_">hi</span>());<span class="hljs-comment">// Hello</span><br></code></pre></td></tr></table></figure><h4 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h4><ol><li>ä½¿ç”¨ <code>for-in</code> éå†</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> example) {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`example.<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${example[key]}</span>`</span>);<br>}<br><span class="hljs-comment">/* è¾“å‡ºï¼š</span><br><span class="hljs-comment">example.name: victifa</span><br><span class="hljs-comment">example.sym: true</span><br><span class="hljs-comment">example.hi: function() { return "Hello"; }</span><br><span class="hljs-comment">example.age: 18</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><ol><li>ä½¿ç”¨ <code>Object.keys(å¯¹è±¡å)</code> è·å–æ‰€æœ‰é”®å</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(example);<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`example.<span class="hljs-subst">${keys[i]}</span>: <span class="hljs-subst">${example[keys[i]]}</span>`</span>);<br>}<br><span class="hljs-comment">// è¾“å‡ºåŒä¸Š</span><br></code></pre></td></tr></table></figure><h4 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h4><p>ä½¿ç”¨ <code>delete</code> åˆ é™¤é”®å€¼å¯¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">delete</span> example.<span class="hljs-property">age</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(example) );<br><span class="hljs-comment">// [ 'name', 'sym', 'hi' ]</span><br></code></pre></td></tr></table></figure><h1 id="3-è¿ç®—"><a href="#3-è¿ç®—" class="headerlink" title="3. è¿ç®—"></a>3. è¿ç®—</h1><h2 id="æ•°å­¦è¿ç®—"><a href="#æ•°å­¦è¿ç®—" class="headerlink" title="æ•°å­¦è¿ç®—"></a>æ•°å­¦è¿ç®—</h2><p>åŒºåˆ«è¾ƒå¤§çš„ä¸ºé™¤æ³• <code>/</code>ï¼Œè¡¨ç¤ºæ•°å­¦æ„ä¹‰ä¸Šçš„é™¤æ³•ï¼Œå‘ä¸‹å–æ•´éœ€è¦ä½¿ç”¨ <code>Math.floor()</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> p = <span class="hljs-number">114</span> / <span class="hljs-number">514</span>;<span class="hljs-comment">// 0.22178988326848248</span><br><span class="hljs-keyword">let</span> q = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-number">114</span> / <span class="hljs-number">514</span>);    <span class="hljs-comment">// 0</span><br><span class="hljs-keyword">let</span> r = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-number">114</span> / <span class="hljs-number">514</span>) + <span class="hljs-number">1</span>;  <span class="hljs-comment">// 1</span><br></code></pre></td></tr></table></figure><h2 id="æ¯”è¾ƒè¿ç®—"><a href="#æ¯”è¾ƒè¿ç®—" class="headerlink" title="æ¯”è¾ƒè¿ç®—"></a>æ¯”è¾ƒè¿ç®—</h2><p>ç‰¹æ®Šçš„ä¸º <code>===</code>ï¼ˆä¸¥æ ¼ç­‰äºï¼‰å’Œ <code>!==</code> ï¼ˆä¸¥æ ¼ä¸ç­‰äºï¼‰ã€‚</p><p>ç”±äº javaScript æ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œä½¿ç”¨ <code>==</code>ï¼Œ<code>!=</code> æ¯”è¾ƒä¸åŒç±»å‹æ•°æ®æ—¶ä¼šè¿›è¡Œéšå¼è½¬æ¢ï¼Œæœ‰æ—¶ä¼šå¯¼è‡´æ„æ–™ä¹‹å¤–çš„ç»“æœã€‚å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-number">5</span> == <span class="hljs-string">'5'</span>;<span class="hljs-comment">// true</span><br><span class="hljs-string">''</span> == <span class="hljs-string">'0'</span>;<span class="hljs-comment">// false</span><br><span class="hljs-string">''</span> == <span class="hljs-number">0</span>;    <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>å› æ­¤å¼•å…¥ä¸¥æ ¼åˆ¤æ–­ï¼š</p><ul><li><code>===</code>ï¼šæ•°æ®ç±»å‹ä¸æ•°æ®å‡ç›¸ç­‰æ—¶æ‰ä¸º <code>true</code>ã€‚</li><li><code>!==</code>ï¼šæ•°æ®ç±»å‹æˆ–æ•°æ®æœ‰ä¸€ä¸ªä¸åŒå°±ä¸º <code>true</code>ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-number">5</span> === <span class="hljs-string">'5'</span>;<span class="hljs-comment">// false</span><br><span class="hljs-string">''</span> === <span class="hljs-string">'0'</span><span class="hljs-comment">// false</span><br><span class="hljs-string">''</span> === <span class="hljs-number">0</span><span class="hljs-comment">// false</span><br><span class="hljs-string">'5'</span> !== <span class="hljs-number">5</span><span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><h1 id="4-å¼‚æ­¥"><a href="#4-å¼‚æ­¥" class="headerlink" title="4. å¼‚æ­¥"></a>4. å¼‚æ­¥</h1><h2 id="åŒæ­¥æ¨¡å¼"><a href="#åŒæ­¥æ¨¡å¼" class="headerlink" title="åŒæ­¥æ¨¡å¼"></a>åŒæ­¥æ¨¡å¼</h2><p>å•çº¿ç¨‹ä¸‹ï¼Œç¨‹åºæŒ‰ç¼–å†™é¡ºåºæ’é˜Ÿè¿›è¡Œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Let's start!"</span>);<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params"></span>) {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"a"</span>);<br>}<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">b</span>(<span class="hljs-params"></span>) {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"b"</span>);<br><span class="hljs-title function_">a</span>();<br>}<br><br><span class="hljs-title function_">b</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"World Ender"</span>);<br></code></pre></td></tr></table></figure><p>å¤§è‡´æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:left">è°ƒç”¨æ ˆçš„æƒ…å†µ</th><th style="text-align:center">æ“ä½œ</th><th style="text-align:left">console</th></tr></thead><tbody><tr><td style="text-align:left"><code>(anoymous)</code> ï¼ˆåŒ¿åè°ƒç”¨ï¼‰</td><td style="text-align:center">å…¨ä»£ç æ‰“åŒ…ä½œä¸ºåŒ¿åè°ƒç”¨å‹å…¥æ ˆ</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>console.log("Let's start!")</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("Let's start!")</code> å…¥æ ˆæ‰§è¡Œ</td><td style="text-align:left">Letâ€™s start!</td></tr><tr><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("Let's start!")</code> å‡ºæ ˆ</td><td style="text-align:left">Letâ€™s start!</td></tr><tr><td style="text-align:left"><code>b()</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>b()</code> å…¥æ ˆ</td><td style="text-align:left">Letâ€™s start!</td></tr><tr><td style="text-align:left"><code>console.log("b")</code> <br><code>b()</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("b")</code> å…¥æ ˆæ‰§è¡Œ</td><td style="text-align:left">Letâ€™s start!<br>b</td></tr><tr><td style="text-align:left"><code>b()</code><br><code>`(anoymous)</code> `</td><td style="text-align:center"><code>console.log("b")</code> å‡ºæ ˆ</td><td style="text-align:left">Letâ€™s start!<br>b</td></tr><tr><td style="text-align:left"><code>a()</code><br><code>b()</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>a()</code> å…¥æ ˆ</td><td style="text-align:left">Letâ€™s start!<br>b</td></tr><tr><td style="text-align:left"><code>console.log("a")</code> <br><code>a()</code><br><code>b()</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("a")</code> å…¥æ ˆæ‰§è¡Œ</td><td style="text-align:left">Letâ€™s start!<br>b<br>a</td></tr><tr><td style="text-align:left"><code>a()</code><br><code>b()</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("a")</code> å‡ºæ ˆ</td><td style="text-align:left">Letâ€™s start!<br>b<br>a</td></tr><tr><td style="text-align:left"><code>b()</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>a()</code> å‡ºæ ˆ</td><td style="text-align:left">Letâ€™s start!<br>b<br>a</td></tr><tr><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center"><code>b()</code> å‡ºæ ˆ</td><td style="text-align:left">Letâ€™s start!<br>b<br>a</td></tr><tr><td style="text-align:left"><code>console.log("World Ender")</code><br><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("World Ender")</code> å…¥æ ˆæ‰§è¡Œ</td><td style="text-align:left">Letâ€™s start!<br>b<br>a<br>World Ender</td></tr><tr><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("World Ender")</code> å‡ºæ ˆ</td><td style="text-align:left">Letâ€™s start!<br>b<br>a<br>World Ender</td></tr><tr><td style="text-align:left"></td><td style="text-align:center">å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè°ƒç”¨æ ˆæ¸…ç©º</td><td style="text-align:left">Letâ€™s start!<br>b<br>a<br>World Ender</td></tr></tbody></table></div><h2 id="å¼‚æ­¥æ¨¡å¼"><a href="#å¼‚æ­¥æ¨¡å¼" class="headerlink" title="å¼‚æ­¥æ¨¡å¼"></a>å¼‚æ­¥æ¨¡å¼</h2><h3 id="setTimeout"><a href="#setTimeout" class="headerlink" title="setTimeout()"></a><code>setTimeout()</code></h3><p><code>setTimeot(func, time)</code> æŒ‡åœ¨ç»è¿‡ time(ms) åï¼Œå†æ‰§è¡Œ <code>func</code> å‡½æ•°ï¼ˆå›è°ƒå‡½æ•°ï¼‰çš„å†…å®¹ï¼ŒæœŸé—´å¯ä»¥æ‰§è¡Œç¨‹åºä¸­çš„å…¶ä»–æ­¥éª¤ã€‚</p><p>ä¸‹æ–¹å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚è¾“å‡ºæ•ˆæœä¸ºï¼š</p><p>â€œLetâ€™s start!â€  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="2.058ex" role="img" focusable="false" viewBox="0 -898.8 1000 909.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g><g data-mml-node="mpadded" transform="translate(205.5,798.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mspace"></g></g></g></g></g></g></svg></mjx-container>  â€œWorld Enderâ€  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="2.883ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1274.2 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(274.2,0)"></path><svg width="374.2" height="865" x="0" y="-182" viewBox="93.6 -182 374.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(0.721,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(969,0)"></g></g></g></g></g></g></svg></mjx-container>  â€œtimer 2â€  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="4.127ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1824.3 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(824.3,0)"></path><svg width="924.3" height="865" x="0" y="-182" viewBox="231.1 -182 924.3 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(1.782,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z" transform="translate(778,0)"></path></g><g data-mml-node="mi" transform="translate(1278,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(1747,0)"></g></g></g></g></g></g></svg></mjx-container>  â€œtimer 1â€  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="4.127ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1824.3 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(824.3,0)"></path><svg width="924.3" height="865" x="0" y="-182" viewBox="231.1 -182 924.3 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(1.782,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(778,0)"></path></g><g data-mml-node="mi" transform="translate(1278,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(1747,0)"></g></g></g></g></g></g></svg></mjx-container>  â€œInside timer 2â€</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Let's start!"</span>);<br><br><span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">() =&gt;</span> {<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"timer 1"</span>);<br>}, <span class="hljs-number">1800</span>);<br><br><span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">() =&gt;</span> {<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"timer 2"</span>);<br>    <span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">() =&gt;</span> {<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Inside timer 2"</span>);<br>    }, <span class="hljs-number">1000</span>);<br>}, <span class="hljs-number">1000</span>);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"World Ender"</span>);<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨ <code>Timer 1</code>ï¼Œ<code>Timer 2</code> å’Œ <code>Inside</code> æ¥ä»£æŒ‡ä¸‰ä¸ªåŒ¿åå‡½æ•°ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">Queue</th><th style="text-align:center">Web API</th><th style="text-align:left">è°ƒç”¨æ ˆçš„æƒ…å†µ</th><th style="text-align:center">æ“ä½œ</th><th>Console</th></tr></thead><tbody><tr><td style="text-align:center">å¾…åŠé˜Ÿåˆ—</td><td style="text-align:center">è¿™æ¬¡ä¸­å°±æ˜¯è®¡æ—¶å™¨</td><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center">å…¨ä»£ç æ‰“åŒ…ä½œä¸ºåŒ¿åè°ƒç”¨å‹å…¥æ ˆ</td><td></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("Let's start!")</code> <br>å…¥æ ˆï¼Œæ‰§è¡Œï¼Œå‡ºæ ˆ</td><td>Letâ€™s start!</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"><strong>1.8s å€’è®¡æ—¶å¼€å§‹</strong></td><td style="text-align:left"><code>setTimeout(Timer 1)</code> <br><code>(anoymous)</code></td><td style="text-align:center"><code>setTimeout(Timer 1)</code> å…¥æ ˆ</td><td>Letâ€™s start!</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ</td><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center"><code>setTimeout(Timer 1)</code> å‡ºæ ˆ</td><td>Letâ€™s start!</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ<br><strong>1s å€’è®¡æ—¶å¼€å§‹</strong></td><td style="text-align:left"><code>setTimeout(Timer 2)</code> <br><code>(anoymous)</code></td><td style="text-align:center"><code>setTimeout(Timer 2)</code> å…¥æ ˆ</td><td>Letâ€™s start!</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ<br>1s å€’è®¡æ—¶è¿›è¡Œ</td><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center"><code>setTimeout(Timer 2)</code> å‡ºæ ˆ</td><td>Letâ€™s start!</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ<br>1s å€’è®¡æ—¶è¿›è¡Œ</td><td style="text-align:left"><code>(anoymous)</code></td><td style="text-align:center"><code>console.log("World Ender")</code> <br>å…¥æ ˆï¼Œæ‰§è¡Œï¼Œå‡ºæ ˆ</td><td>Letâ€™s start<br>World Ender</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ<br>1s å€’è®¡æ—¶è¿›è¡Œ</td><td style="text-align:left"></td><td style="text-align:center">å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè°ƒç”¨æ ˆæ¸…ç©º</td><td>Letâ€™s start<br>World Ender</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"></td><td style="text-align:center"><strong><em>æ¼«é•¿çš„ç­‰å¾…</em></strong></td><td></td></tr><tr><td style="text-align:center">Timer 2</td><td style="text-align:center"><em>1s å€’è®¡æ—¶ç»“æŸ</em><br>1.8s å€’è®¡æ—¶è¿›è¡Œ</td><td style="text-align:left"></td><td style="text-align:center"><code>Timer 2</code> è¿›å…¥å¾…åŠé˜Ÿåˆ—ï¼Œè¢«äº‹ä»¶å¾ªç¯ç›‘å¬åˆ°</td><td>Letâ€™s start!<br>World Ender</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ</td><td style="text-align:left"><code>Timer 2</code></td><td style="text-align:center"><code>timer 2</code>å…¥æ ˆ</td><td>Letâ€™s start!<br>World Ender</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ</td><td style="text-align:left"><code>Timer 2</code></td><td style="text-align:center"><code>console.log("timer 2")</code> <br>å…¥æ ˆï¼Œæ‰§è¡Œï¼Œå‡ºæ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ<br><strong>1s å€’è®¡æ—¶(2) å¼€å§‹</strong></td><td style="text-align:left"><code>setTimeout(Inside)</code> <br><code>Timer 2</code></td><td style="text-align:center"><code>setTimeout(Inside)</code> å…¥æ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ<br>1s å€’è®¡æ—¶(2) è¿›è¡Œ</td><td style="text-align:left"><code>Timer 2</code></td><td style="text-align:center"><code>setTimeout(Inside)</code> å‡ºæ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1.8s å€’è®¡æ—¶è¿›è¡Œ<br>1s å€’è®¡æ—¶(2) è¿›è¡Œ</td><td style="text-align:left"></td><td style="text-align:center"><code>Timer 2</code> æ‰§è¡Œå®Œæ¯•ï¼Œå‡ºæ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"></td><td style="text-align:center"><strong><em>å¹¶ä¸æ¼«é•¿çš„ç­‰å¾…</em></strong></td><td></td></tr><tr><td style="text-align:center">Timer 1</td><td style="text-align:center"><em>1.8 s å€’è®¡æ—¶ç»“æŸ</em><br>1s å€’è®¡æ—¶(2) è¿›è¡Œ</td><td style="text-align:left"></td><td style="text-align:center"><code>Timer 1</code> è¿›å…¥å¾…åŠé˜Ÿåˆ—ï¼Œè¢«äº‹ä»¶å¾ªç¯ç›‘å¬åˆ°</td><td>Letâ€™s start!<br>World Ender<br>timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1s å€’è®¡æ—¶(2) è¿›è¡Œ</td><td style="text-align:left"><code>Timer 1</code></td><td style="text-align:center"><code>Timer 1</code> å…¥æ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1s å€’è®¡æ—¶(2) è¿›è¡Œ</td><td style="text-align:left"><code>Timer 1</code></td><td style="text-align:center"><code>console.log("timer 1")</code>  <br>å…¥æ ˆï¼Œæ‰§è¡Œï¼Œå‡ºæ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2<br>timer 1</td></tr><tr><td style="text-align:center"></td><td style="text-align:center">1s å€’è®¡æ—¶(2) è¿›è¡Œ</td><td style="text-align:left"></td><td style="text-align:center"><code>Timer 1</code> æ‰§è¡Œå®Œæ¯•ï¼Œå‡ºæ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2<br>timer 1</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"></td><td style="text-align:center"><strong><em>ç®€çŸ­çš„ç­‰å¾…</em></strong></td><td></td></tr><tr><td style="text-align:center">Inside</td><td style="text-align:center"><em>1s å€’è®¡æ—¶(2)ç»“æŸ</em></td><td style="text-align:left"></td><td style="text-align:center"><code>Inside</code> è¿›å…¥å¾…åŠé˜Ÿåˆ—ï¼Œè¢«äº‹ä»¶å¾ªç¯ç›‘å¬åˆ°</td><td>Letâ€™s start!<br>World Ender<br>timer 2<br>timer 1</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"><code>Inside</code></td><td style="text-align:center"><code>Inside</code> å…¥æ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2<br>timer 1</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"><code>Inside</code></td><td style="text-align:center"><code>console.log("Inside timer 2")</code><br>å…¥æ ˆï¼Œæ‰§è¡Œï¼Œå‡ºæ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2<br>timer 1<br>Inside timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"></td><td style="text-align:center"><code>Inside</code> å‡ºæ ˆ</td><td>Letâ€™s start!<br>World Ender<br>timer 2<br>timer 1<br>Inside timer 2</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:left"></td><td style="text-align:center"><strong><em>å®Œ</em></strong></td></tr></tbody></table></div><p>ç”±äº <code>setTimeout()</code> å¤šå±‚åµŒå¥—éš¾ä»¥è¯†åˆ«å’Œç»´æŠ¤ï¼Œè¢«ç§°ä¸ºâ€œå›è°ƒåœ°ç‹±â€ï¼ˆcallback hellï¼‰ ï¼Œç°åœ¨ä½¿ç”¨ <code>Promise</code> ä»£æ›¿ã€‚</p><p>ä¸‹é¢å±•ç¤ºäº†ä¸€ä¸ªå¤šå±‚åµŒå¥—çš„ <code>setTimeout()</code>ï¼Œå®é™…æ•ˆæœä¸ºæ¯éš”ä¸€ç§’è¿›è¡Œä¸€æ¬¡è¾“å‡ºã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">() =&gt;</span> {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>);<br><span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">() =&gt;</span> {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span>);<br><span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">() =&gt;</span> {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">3</span>);<br>}, <span class="hljs-number">1000</span>);<br>}, <span class="hljs-number">1000</span>);<br>}, <span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure><h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a><code>Promise</code></h3><p>ä¸€ä¸ªæ‰¿è¯ºï¼Œæœ‰ <code>pending</code>ï¼ˆè¿›è¡Œä¸­ï¼‰ï¼Œ<code>fullfilled</code>ï¼ˆå·²æˆåŠŸï¼‰ï¼Œ<code>rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰ä¸‰ç§çŠ¶æ€ã€‚è§†ç»“æœæˆåŠŸä¸å¦å¯ä»¥è¿”å›ä¸åŒçš„å€¼ã€‚</p><p><code>Promise</code> å¯¹è±¡é€šè¿‡ <code>new</code> æ¥åˆ›å»ºï¼Œæœ‰ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ã€‚å…¶åŸºæœ¬å½¢å¼å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>( <span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {<br><span class="hljs-comment">/* è¿™é‡Œå¯ä»¥æœ‰ä¸€äº›æ“ä½œï¼Œå¦‚setTimeoutç­‰ */</span><br><span class="hljs-title function_">resolve</span>(æˆåŠŸæ—¶çš„è¿”å›å€¼);<span class="hljs-comment">// ä¸€èˆ¬éƒ½è¦æœ‰,è¿”å›å€¼ç©ºç€ä¹Ÿè¡Œ</span><br><span class="hljs-title function_">reject</span>( <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(å¤±è´¥æ—¶å¼¹å‡ºçš„æç¤º) );<span class="hljs-comment">// å¯ä»¥æ²¡æœ‰</span><br>} )<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å°†å…¶ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ä»¥ä¼ å…¥ä¸€äº›å‚æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">promiseWithSetTimeout</span>(<span class="hljs-params">ms</span>) {<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>( <span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {<br><span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">() =&gt;</span> {<br><span class="hljs-title function_">resolve</span>(<span class="hljs-string">"It's resolved."</span>);<br><span class="hljs-title function_">reject</span>( <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"It's rejected."</span>) );<br>}, ms );<br>} );<br>}<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡ <code>.then</code> æ¥ä½¿ç”¨ <code>Promise</code>ï¼Œ<code>.catch</code> æ¥æ•è· <code>Promise</code> å¤±è´¥åçš„é”™è¯¯ã€‚</p><p>ç®€åŒ–ä¸€ä¸‹ä¸Šé¢çš„å‡½æ•°ï¼Œè¿”å›å€¼å°±ä¸è¦äº†ï¼Œä½¿å…¶æ°¸è¿œè§¦å‘ <code>resolved</code>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">promiseWithSetTimeout</span>(<span class="hljs-params">ms</span>) {<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>( <span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {<br><span class="hljs-built_in">setTimeout</span>( resolve, ms );<br>} );<br>}<br></code></pre></td></tr></table></figure><p><code>.then</code> çš„å‚æ•°ä¸ºä¸¤ä¸ªå‡½æ•°ï¼Œå½“ <code>resolve</code> æ—¶è¿è¡Œç¬¬ä¸€ä¸ªï¼Œ<code>reject</code> æ—¶è¿è¡Œç¬¬äºŒä¸ªï¼ˆæ²¡æœ‰ä¹Ÿè¡Œï¼Œå°±æ˜¯ä¼šæŠ¥é”™ï¼Œç›´æ¥å¼¹å‡ºé¢„è®¾çš„é”™è¯¯æç¤ºï¼‰ï¼Œé”™è¯¯ä¼šå…ˆè¢«ç¬¬äºŒä¸ªå‡½æ•°æ•æ‰ï¼Œä¸å­˜åœ¨æ—¶æ‰ä¼šè¢« <code>.catch</code> æ•æ‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">promiseWithSetTimeout</span>(<span class="hljs-number">1000</span>)<br>.<span class="hljs-title function_">then</span>( <span class="hljs-function">() =&gt;</span> {<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1st Resolved."</span>);<br>},<br>         <span class="hljs-function">() =&gt;</span> {<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1st Rejected."</span>);<br>}<br>    )<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"World Ender"</span>);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š<code>World Ender</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="2.883ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1274.2 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(274.2,0)"></path><svg width="374.2" height="865" x="0" y="-182" viewBox="93.6 -182 374.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(0.721,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(969,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>1st Resolved.</code></p><p>æ”¹æˆ <code>setTimeout(rejected, ms)</code>ï¼š<code>World Ender</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="2.883ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1274.2 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(274.2,0)"></path><svg width="374.2" height="865" x="0" y="-182" viewBox="93.6 -182 374.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(0.721,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(969,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>1st Rejected.</code></p><p>æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°ä¸­å†è¿”å›ä¸€æ¬¡ <code>promiseWithSetTimeout()</code>ï¼Œå®ç° <code>Promise</code> çš„é“¾å¼è°ƒç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Js"><span class="hljs-title function_">promiseWithSetTimeout</span>(<span class="hljs-number">1000</span>)<br>.<span class="hljs-title function_">then</span>( <span class="hljs-function">() =&gt;</span> {<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1st Resolved."</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">promiseWithSetTimeout</span>(<span class="hljs-number">2000</span>);<br>} )<br>.<span class="hljs-title function_">then</span>( <span class="hljs-function">() =&gt;</span> {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"2nd Resolved."</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">"More."</span>);<br>} )<br>.<span class="hljs-title function_">then</span>( <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res + <span class="hljs-string">" 3rd Resolved."</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">"No more."</span>);<br>} )<br>.<span class="hljs-title function_">catch</span>( <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value + <span class="hljs-string">" Finally Rejected."</span>);<br>} )<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"World Ender"</span>);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š<code>World Ender</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="2.883ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1274.2 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(274.2,0)"></path><svg width="374.2" height="865" x="0" y="-182" viewBox="93.6 -182 374.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(0.721,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(969,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>1st Resolved.</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="2.883ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1274.2 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(274.2,0)"></path><svg width="374.2" height="865" x="0" y="-182" viewBox="93.6 -182 374.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(0.721,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(969,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>2nd Resolved.</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="4.532ex" height="3.262ex" role="img" focusable="false" viewBox="0 -1359.7 2003.2 1441.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(1003.2,0)"></path><svg width="1103.2" height="865" x="0" y="-182" viewBox="275.8 -182 1103.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(2.127,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç«‹</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">åˆ»</text></g><g data-mml-node="mspace" transform="translate(2000,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>More. 3rd Resolved.</code> <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="4.532ex" height="3.262ex" role="img" focusable="false" viewBox="0 -1359.7 2003.2 1441.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(1003.2,0)"></path><svg width="1103.2" height="865" x="0" y="-182" viewBox="275.8 -182 1103.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(2.127,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç«‹</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">åˆ»</text></g><g data-mml-node="mspace" transform="translate(2000,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>No more. Finally Rejected.</code></p><h3 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async / Await"></a><code>Async / Await</code></h3><p>åœ¨ <code>function</code> å‰åŠ ä¸Š <code>async</code>ï¼Œå‡½æ•°ä¼šå˜ä¸ºå¼‚æ­¥å‡½æ•°ï¼Œè¿”å›å€¼è¢«è‡ªåŠ¨åŒ…è£…ä¸º <code>Promise</code> å¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span> (<span class="hljs-params"></span>) {<br><span class="hljs-keyword">return</span> <span class="hljs-number">42</span>;<br>}<br><span class="hljs-keyword">const</span> tmp = <span class="hljs-title function_">test</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tmp);<span class="hljs-comment">// Promise { 42 }</span><br></code></pre></td></tr></table></figure><p><code>await</code> <strong>åªèƒ½åœ¨ <code>async</code> å‡½æ•°å†…</strong>å·¥ä½œï¼Œåé¢ä¸€èˆ¬è·Ÿä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œæ•ˆæœä¸ºç­‰å¾…ï¼Œç›´åˆ° <code>Promise</code> å®Œæˆå¹¶è¿”å›ç»“æœã€‚ </p><p>åœ¨ <code>await</code> é€ æˆçš„ç­‰å¾…ä¸­ï¼Œ<code>async</code> å‡½æ•°å†…ä¼šæš‚åœç­‰å¾… <code>Promise</code> å¯¹è±¡çš„ååº”ï¼Œä½†å‡½æ•°å¤–çš„ç¨‹åºä»ä¼šæ­£å¸¸è¿›è¡Œã€‚ </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">promiseWithSetTimeout</span>(<span class="hljs-params">ms</span>) {<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>( <span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {<br><span class="hljs-built_in">setTimeout</span>( resolve, ms );<br>} );<br>}<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span> (<span class="hljs-params"></span>) {<br><span class="hljs-keyword">return</span> <span class="hljs-number">42</span>;<br>}<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>) {<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Let's start!"</span>);<br><span class="hljs-keyword">await</span> <span class="hljs-title function_">promiseWithSetTimeout</span>(<span class="hljs-number">1000</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Stop running."</span>);<br>}<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">run2</span>(<span class="hljs-params"></span>) {<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">test</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>}<br><br><span class="hljs-title function_">run</span>();<br><span class="hljs-title function_">run2</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"World Ender"</span>);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š<code>Let's start!</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="4.532ex" height="3.262ex" role="img" focusable="false" viewBox="0 -1359.7 2003.2 1441.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(1003.2,0)"></path><svg width="1103.2" height="865" x="0" y="-182" viewBox="275.8 -182 1103.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(2.127,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç«‹</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">åˆ»</text></g><g data-mml-node="mspace" transform="translate(2000,0)"></g></g></g></g></g></g></svg></mjx-container>   <code>World Ender</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="4.532ex" height="3.262ex" role="img" focusable="false" viewBox="0 -1359.7 2003.2 1441.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(1003.2,0)"></path><svg width="1103.2" height="865" x="0" y="-182" viewBox="275.8 -182 1103.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(2.127,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç«‹</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">åˆ»</text></g><g data-mml-node="mspace" transform="translate(2000,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>42</code>  <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="2.883ex" height="3.127ex" role="img" focusable="false" viewBox="0 -1300.3 1274.2 1382.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="mstyle"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" transform="translate(274.2,0)"></path><svg width="374.2" height="865" x="0" y="-182" viewBox="93.6 -182 374.2 865"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" transform="scale(0.721,1)"></path></svg></g></g><g data-mml-node="mpadded" transform="translate(0,870.8) scale(0.707)"><g transform="translate(278,-200)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mspace" transform="translate(969,0)"></g></g></g></g></g></g></svg></mjx-container>  <code>Stop running.</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Solidity102ç¬”è®°</title>
    <link href="/2024/12/08/Solidity102/"/>
    <url>/2024/12/08/Solidity102/</url>
    
    <content type="html"><![CDATA[<h2 id="15-é‡è½½"><a href="#15-é‡è½½" class="headerlink" title="15. é‡è½½"></a>15. é‡è½½</h2><ul><li><p>å³åå­—ç›¸åŒä½†å‚æ•°ä¸åŒçš„å‡½æ•°å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œå¹¶è¢«è§†ä¸ºä¸åŒçš„å‡½æ•°ã€‚</p></li><li><p>ä¿®é¥°å™¨ <strong>ä¸èƒ½</strong> é‡è½½</p></li><li>åŸç†ï¼šå‡½æ•°é€‰æ‹©å™¨</li></ul><p>ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function me() external pure returns(string memory) &#123;<br>return (&quot;victifa&quot;);<br>&#125;// è¾“å‡º &quot;victifa&quot;<br><br>function me(string memory _str) external pure returns(string memory) &#123;<br>return (_str);<br>&#125;// è¾“å‡º _str<br></code></pre></td></tr></table></figure><h3 id="å®å‚åŒ¹é…ï¼ˆArgument-Matchingï¼‰"><a href="#å®å‚åŒ¹é…ï¼ˆArgument-Matchingï¼‰" class="headerlink" title="å®å‚åŒ¹é…ï¼ˆArgument Matchingï¼‰"></a>å®å‚åŒ¹é…ï¼ˆArgument Matchingï¼‰</h3><p>åœ¨è°ƒç”¨é‡è½½å‡½æ•°æ—¶ï¼Œä¼šæŠŠè¾“å…¥çš„å®é™…å‚æ•°å’Œå‡½æ•°å‚æ•°çš„å˜é‡ç±»å‹åšåŒ¹é…ã€‚ å¦‚æœå‡ºç°å¤šä¸ªåŒ¹é…çš„é‡è½½å‡½æ•°ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function f(uint8 _in) public pure returns (uint8 out) &#123;<br>out = _in;<br>&#125;<br><br>function f(uint256 _in) public pure returns (uint256 out) &#123;<br>out = _in;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç†è®ºä¸Šï¼Œè¾“å…¥50è°ƒç”¨å‡½æ•°åº”è¯¥ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ï¼Œå®é™…ä½¿ç”¨æ—¶å‘ç°å‡ºç°æŠ¥é”™çš„æ¡ä»¶æ¯”è¾ƒä¸¥è‹›ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.0;<br><br>interface Test &#123;<br>    function f(uint256 _in) external returns (uint256 out);<br>    function f(uint8 _in) external returns (uint256 out);<br>&#125;<br><br>contract test &#123;<br>    function f(uint8 _in) public pure returns (uint8 out) &#123;<br>        out = _in;<br>    &#125;<br><br>    function f(uint256 _in) public pure returns (uint256 out) &#123;<br>        out = _in;<br>    &#125;<br>&#125;<br><br>contract A &#123;<br>    function AA(address from) public returns(uint rs) &#123;<br>        rs = Test(from).f(50);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»…åœ¨ä»¥ä¸Šæƒ…å†µä¸‹ï¼Œä¼šåœ¨ç¼–è¯‘ç•Œé¢ç›´æ¥ç”»çº¢çº¿æŠ¥é”™ã€‚</p><p>ä»¥ä¸‹æ˜¯å‡ ç§ä¸ä¼šæŠ¥é”™çš„æƒ…å½¢ï¼š</p><ol><li><p>ç›´æ¥åœ¨éƒ¨ç½²æ è°ƒç”¨å‡½æ•° <code>f()</code></p></li><li><p>æ¥å£å¤„ä»…æœ‰ä¸¤ä¸ª <code>f()</code> ä¸­çš„ä¸€ä¸ª</p></li><li><p>ä½¿ç”¨å‚æ•°è¾“å…¥50ï¼ˆå¦‚ä¸‹ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract A &#123;<br>    function AA(address from, uint num) public returns(uint rs) &#123;<br>        rs = Test(from).f(num);<br>    &#125;<br>    &#125;<br></code></pre></td></tr></table></figure></li></ol><h2 id="17-åº“åˆçº¦"><a href="#17-åº“åˆçº¦" class="headerlink" title="17. åº“åˆçº¦"></a>17. åº“åˆçº¦</h2><p>ä¸€ç§ç‰¹æ®Šçš„åˆçº¦ï¼Œæ˜¯ä¸€ç³»åˆ—å‡½æ•°çš„åˆé›†ï¼Œæœ‰å¤§ä½¬åˆ¶ä½œï¼Œä¼šç”¨å°±è¡Œã€‚</p><ul><li><p>ä½ å¦‚æœæ˜¯å¤§ä½¬ï¼Œå°±è¦çŸ¥é“ï¼š</p><ul><li><p>ä¸æ™®é€šåˆçº¦åŒºåˆ«ï¼š</p><ol><li><p>æ²¡æœ‰çŠ¶æ€å˜é‡</p></li><li><p>ä¸èƒ½ç»§æ‰¿æˆ–è¢«ç»§æ‰¿</p></li><li><p>ä¸èƒ½æ¥å—ä»¥å¤ªå¸</p></li><li><p>ä¸èƒ½è¢«é”€æ¯</p></li></ol></li><li><p>å‡½æ•°è®¾ç½®ä¸º <code>public</code> æˆ– <code>external</code>ï¼Œè°ƒç”¨æ—¶ä¼šè§¦å‘ <code>delegatecall</code>ï¼Œ<code>internal</code> æ—¶æ— äº‹å‘ç”Ÿï¼Œ<code>private</code> åˆ™ä»…åœ¨åœ¨åº“åˆçº¦ä¸­å¯è§</p></li></ul></li></ul><h3 id="Stringsåº“åˆçº¦"><a href="#Stringsåº“åˆçº¦" class="headerlink" title="Stringsåº“åˆçº¦"></a>Stringsåº“åˆçº¦</h3><p>ä¸»è¦åŒ…å«ä¸¤ä¸ªå‡½æ•°ï¼š</p><ol><li><code>toString()</code> å°† <code>uint256</code> è½¬ä¸º<code>string</code></li><li><code>toHexString</code> å°† <code>uint256</code> è½¬ä¸º 16è¿›åˆ¶ å†è½¬ä¸º<code>string</code></li></ol><h3 id="ä½¿ç”¨åº“åˆçº¦"><a href="#ä½¿ç”¨åº“åˆçº¦" class="headerlink" title="ä½¿ç”¨åº“åˆçº¦"></a>ä½¿ç”¨åº“åˆçº¦</h3><p>å‡è®¾æˆ‘ä»¬å®šä¹‰äº†å¦‚ä¸‹åº“åˆçº¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs solidity">library safeMath&#123;<br>    function add(uint a, uint b) public pure returns(uint256) &#123;<br>uint256 c = a + b;<br>        assert(c &gt;= a);<br>        return c;<br>&#125;<br><br>function sub(uint256 a, uint256 b) public pure returns (uint256) &#123;<br>    assert(b &lt;= a);<br>    return a - b;<br>    &#125;<br> <br>&#125;<br></code></pre></td></tr></table></figure><p>è°ƒç”¨è¯¥åº“åˆçº¦çš„æ–¹æ³•æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p><ol><li><p><code>using A for B</code></p><p>é™„åŠ åº“åˆçº¦(A)åˆ°ä»»æ„ç±»å‹(B)ï¼Œåº“ A ä¸­çš„å‡½æ•°ä¼šè‡ªåŠ¨æ·»åŠ  B ç±»å‹çš„å˜é‡æˆå‘˜ï¼Œç›´æ¥è°ƒç”¨ï¼Œè¿™ä¸ªå˜é‡ä½œä¸ºç¬¬ä¸€ä¸ªå˜é‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">using safeMath for uint256;<br>contract libraryUsage &#123;<br>    function usingTest(uint256 _num1, uint256 _num2) external pure returns(uint256)&#123;<br>        return _num1.add(_num2);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ä¸Šï¼Œé€šè¿‡ <code>using safeMath for uint256;</code>ï¼Œå°±ç›¸å½“äºæˆ‘ä»¬æœ‰äº†ä»¥ä¸‹è¯­å¥ï¼ˆå‡è®¾æˆ‘ä»¬å·²ç»å®šä¹‰äº† <code>uint256</code> ç±»å‹çš„å˜é‡ a å’Œ bï¼‰ï¼š</p><ul><li><code>a.add(ç¬¬äºŒä¸ªå‚æ•°);</code>ï¼Œ<code>b.add(ç¬¬äºŒä¸ªå‚æ•°);</code></li><li><code>a.sub(ç¬¬äºŒä¸ªå‚æ•°);</code>ï¼Œ<code>b.sub(ç¬¬äºŒä¸ªå‚æ•°);</code></li></ul></li><li><p>ç›´æ¥è°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function directlyUse (uint256 _num1, uint256 _num2) external pure returns(uint256)&#123;<br>return safeMath.sub(_num1, _num2);<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h2 id="18-Import"><a href="#18-Import" class="headerlink" title="18. Import"></a>18. Import</h2><ol><li><p>æœ¬åœ°ç›¸å¯¹ä½ç½®å¼•å…¥ï¼Œå¦‚å¼•å…¥10ä¸­å†’æ³¡æ’åºï¼š <code>import &#39;./bubbleSort.sol&#39;;</code></p></li><li><p>é€šè¿‡ç½‘å€å¯¼å…¥ </p><p><code>import &#39;https://github.com/OpenZeppelin/openzeppelincontracts/blob/master/contracts/utils/Address.sol&#39;;</code></p></li><li><p>é€šè¿‡ npm å¯¼å…¥ <code>*import* &#39;@openzeppelin/contracts/access/Ownable.sol&#39;;</code></p></li><li><p>ä»…å¯¼å…¥æœ¬åœ°æŸä¸ªç‰¹å®šçš„åˆçº¦ <code>import &#123;Sort&#125; from &#39;./bubbleSort.sol&#39;;</code></p></li></ol><ul><li>ä½ç½®ï¼šç‰ˆæœ¬å·åï¼Œå…¶ä½™ä»£ç å‰</li><li><strong>æ³¨æ„ï¼š</strong>==æœ¬åœ°åˆçº¦åå­—ä¸èƒ½æœ‰ä¸­æ–‡ï¼ï¼ï¼==</li></ul><p>ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.21;<br><br>import &#123;Sort&#125; from &#x27;./bubbleSort.sol&#x27;;<br><br>contract importTest &#123;<br>    function test(uint[] memory arr) external &#123;<br>        Sort a = new Sort();<br>        a.bubbleSort(arr);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="19-æ¥æ”¶ETH"><a href="#19-æ¥æ”¶ETH" class="headerlink" title="19. æ¥æ”¶ETH"></a>19. æ¥æ”¶ETH</h2><p>ä¸»è¦ä½¿ç”¨ <code>receive()</code> å’Œ <code>fallback()</code></p><p><strong>æ³¨æ„</strong>ï¼š0.6.xç‰ˆæœ¬å‰åªæœ‰ <code>fallback</code></p><h3 id="æ¥å—å‡½æ•°-receive"><a href="#æ¥å—å‡½æ•°-receive" class="headerlink" title="æ¥å—å‡½æ•° receive"></a>æ¥å—å‡½æ•° receive</h3><ul><li>ä¸€ä¸ªåˆçº¦æœ€å¤šä¸€ä¸ª</li><li>é£Ÿç”¨æ–¹å¼ï¼š<code>receive() external payable&#123; Â·Â·Â· &#125;</code>ï¼Œ<strong>æ— å‚æ•°</strong>ï¼Œ<strong>æ— è¿”å›å€¼</strong>ï¼Œ<strong>å¿…é¡»æ˜¯ </strong><code>external</code> å’Œ <code>payable</code></li><li>æœ€å¥½ä¸è¦æ‰§è¡Œå¤ªå¤šé€»è¾‘ï¼ˆè§ 20. å‘é€ETHï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">event hasReceived(address Sender, uint Value);<br>receive() external payable &#123;<br>emit hasReceived(msg.sender, msg.value);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å›é€€å‡½æ•°-fallback"><a href="#å›é€€å‡½æ•°-fallback" class="headerlink" title="å›é€€å‡½æ•° fallback"></a>å›é€€å‡½æ•° fallback</h3><ul><li>è°ƒç”¨åˆçº¦ä¸å­˜åœ¨çš„å‡½æ•°æ—¶ä½¿ç”¨ï¼ˆä¼ è¾¾å‚æ•°ä¸åŒä¹Ÿè¢«è§†ä¸ºä¸å­˜åœ¨çš„å‡½æ•°ï¼‰ã€‚</li><li>å¯ç”¨äºæ¥æ”¶ ETHï¼Œä»£ç†åˆçº¦ <code>proxy contract</code></li><li>é£Ÿç”¨æ–¹å¼ï¼š<code>fallback external payable &#123; Â·Â·Â· &#125;</code>ï¼ŒåŒæ ·ï¼Œ<strong>æ— å‚æ•°</strong>ï¼Œ<strong>æ— è¿”å›å€¼</strong>ï¼Œ<strong>å¿…é¡»æ˜¯</strong> <code>external</code> å’Œ <code>payable</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">event hasFallbacked(address Sender, uint Value, bytes Data);<br>fallback() external payable &#123;<br>        emit hasFallbacked(msg.sender, msg.value, msg.data);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="fallback-or-receive"><a href="#fallback-or-receive" class="headerlink" title="fallback or receive?"></a>fallback or receive?</h3><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs gcode">             æ¥æ”¶ETH<br>|<br>   msg.dataæ˜¯ç©ºï¼Ÿ<br>           /      \<br>           æ˜¯        å¦<br>         /           \<br>receive<span class="hljs-comment">()</span>å­˜åœ¨?   fallback<span class="hljs-comment">()</span><br>       /    \<br>      æ˜¯     å¦<br> /        \<br>receive<span class="hljs-comment">()</span>   fallback<span class="hljs-comment">()</span><br></code></pre></td></tr></table></figure><p>å³ï¼šä»…å½“ msg.data ä¸ºç©ºä¸”å­˜åœ¨ receive() æ—¶è§¦å‘ receive()ï¼›å¦åˆ™è§¦å‘ fallback()ï¼›</p><p>â€‹       å‡ä¸å­˜åœ¨æ—¶ä¸èƒ½ç›´æ¥å‘é€ï¼Œå¯ä»¥ç”¨ <code>payable</code> çš„ <code>function</code> å‘é€</p><h2 id="é—´ç« ï¼šæŸ¥è¯¢å’Œéƒ¨ç½²æ—¶å‘é€-ETH"><a href="#é—´ç« ï¼šæŸ¥è¯¢å’Œéƒ¨ç½²æ—¶å‘é€-ETH" class="headerlink" title="é—´ç« ï¼šæŸ¥è¯¢å’Œéƒ¨ç½²æ—¶å‘é€ ETH"></a>é—´ç« ï¼šæŸ¥è¯¢å’Œéƒ¨ç½²æ—¶å‘é€ ETH</h2><h3 id="æŸ¥è¯¢å½“å‰åˆçº¦çš„-ETH"><a href="#æŸ¥è¯¢å½“å‰åˆçº¦çš„-ETH" class="headerlink" title="æŸ¥è¯¢å½“å‰åˆçº¦çš„ ETH"></a>æŸ¥è¯¢å½“å‰åˆçº¦çš„ ETH</h3><p>æˆ‘ä»¬ä½¿ç”¨ <code>address(è¿™é‡Œæ˜¯åœ°å€).balance</code> æŸ¥è¯¢åˆçº¦çš„ ETH ä½™é¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract receiveETH &#123;<br>    event log(uint amount, uint gas);<br>    receive() external payable &#123;<br>        emit log(msg.value, gasleft()); //è¿”å›ETHå€¼ä¸æ¶ˆè€—çš„gas<br>    &#125;<br>    function getBalance() view public returns(uint) &#123;<br>        return address(this).balance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åœ¨éƒ¨ç½²åˆçº¦æ—¶å‘é€-ETH"><a href="#åœ¨éƒ¨ç½²åˆçº¦æ—¶å‘é€-ETH" class="headerlink" title="åœ¨éƒ¨ç½²åˆçº¦æ—¶å‘é€ ETH"></a>åœ¨éƒ¨ç½²åˆçº¦æ—¶å‘é€ ETH</h3><p>æˆ‘ä»¬åœ¨åˆçº¦ä¸­åŠ å…¥ <code>payable</code> çš„æ„é€ å‡½æ•°ï¼Œä½¿éƒ¨ç½²åˆçº¦æ—¶å¯ä»¥å‘å…¶ä¸­è½¬å…¥ ETH</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract sendETTH&#123;<br>    constructor() payable &#123;&#125;<br>    receive() external payable &#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="20-å‘é€-ETH"><a href="#20-å‘é€-ETH" class="headerlink" title="20. å‘é€ ETH"></a>20. å‘é€ ETH</h2><p>ä½¿ç”¨ <code>transfer()</code>, <code>send()</code> æˆ– <code>call()</code>ï¼Œé¼“åŠ±ä½¿ç”¨ <code>call()</code></p><h3 id="transfer"><a href="#transfer" class="headerlink" title="transfer"></a>transfer</h3><ul><li>ç”¨æ³•ï¼š<code>æ¥æ”¶æ–¹åœ°å€.transfer(æ•°é¢)</code></li><li>gas é™åˆ¶ 2300</li><li>è½¬è´¦å¤±è´¥ä¼šè‡ªåŠ¨ <code>revert</code>ï¼ˆå›æ»šäº¤æ˜“ï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function trans(address payable _to, uint _amount) external payable &#123;<br>_to.transfer(_amount);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="send"><a href="#send" class="headerlink" title="send"></a>send</h3><ul><li>ç”¨æ³•ï¼š<code>æ¥æ”¶æ–¹åœ°å€.send(æ•°é¢)</code></li><li>gas é™åˆ¶ 2300</li><li>ä¸ä¼šè‡ªåŠ¨ <code>revert</code>ï¼Œè¦æ‰‹åŠ¨åˆ¤æ–­</li><li>è¿”å›å€¼ä¸º <code>bool</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">error sendFailed();<br>    function sends(address payable _to, uint _amount) external payable &#123;<br>        bool success = _to.send(_amount);<br>        if (!success) &#123;<br>            revert sendFailed();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="call"><a href="#call" class="headerlink" title="call"></a>call</h3><ul><li>ç”¨æ³•ï¼š<code>æ¥æ”¶æ–¹åœ°å€.call&#123;value: æ•°é¢&#125;(&quot;&quot;)</code></li><li>æ—  gas é™åˆ¶ï¼Œ<code>receive</code> å¯æ‰§è¡Œå¤æ‚é€»è¾‘</li><li>ä¸ä¼šè‡ªåŠ¨ <code>revert</code>ï¼Œè¦æ‰‹åŠ¨åˆ¤æ–­</li><li>è¿”å›å€¼ä¸º <code>(bool, bytes)</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">error callFailed(string);<br>function calls(address payable _to, uint _amount) external payable &#123;<br>    (bool success, ) = _to.call&#123;value: _amount&#125;(&quot;&quot;);<br>        if (!success) &#123;<br>       revert callFailed(&quot;Failed to call&quot;);<br>        &#125;   <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="21-è°ƒç”¨å…¶ä»–åˆçº¦"><a href="#21-è°ƒç”¨å…¶ä»–åˆçº¦" class="headerlink" title="21. è°ƒç”¨å…¶ä»–åˆçº¦"></a>21. è°ƒç”¨å…¶ä»–åˆçº¦</h2><p>å·²çŸ¥æˆ‘ä»¬æ‹¥æœ‰å¦‚ä¸‹åˆçº¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract tar&#123;<br>    uint private _x;<br>    event log(uint amount, uint gas);<br><br>    function setX(uint x) external payable &#123;// è°ƒæ•´ _x çš„å€¼ï¼Œæˆ–å¾€åˆçº¦é‡Œè½¬ETHï¼Œå¹¶è®°å½•è½¬å…¥å€¼å’Œ gas å‰©ä½™<br>        _x = x;<br>        if (msg.value &gt; 0) &#123;<br>            emit log(msg.value, gasleft());<br>        &#125;<br>    &#125;<br><br>    function getX() external view returns(uint x)&#123;// è·å¾— _x çš„å€¼<br>        x = _x;<br>    &#125;<br><br>    function getBalance() external view returns(uint) &#123;// è¿”å›å½“å‰åˆçº¦çš„ETHä½™é¢<br>        return address(this).balance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-ä¼ å…¥åˆçº¦åœ°å€è°ƒç”¨å‡½æ•°"><a href="#1-ä¼ å…¥åˆçº¦åœ°å€è°ƒç”¨å‡½æ•°" class="headerlink" title="1. ä¼ å…¥åˆçº¦åœ°å€è°ƒç”¨å‡½æ•°"></a>1. ä¼ å…¥åˆçº¦åœ°å€è°ƒç”¨å‡½æ•°</h3><p>ä¼ å…¥ç›®æ ‡åˆçº¦çš„åœ°å€ï¼Œç”Ÿæˆå¼•ç”¨ï¼Œè°ƒç”¨ç›®æ ‡å‡½æ•°</p><p>æ ¼å¼ï¼š<code>åˆçº¦å(åˆçº¦åœ°å€).å‡½æ•°å(å‡½æ•°å‚æ•°);</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract useTar&#123;<br>    // _addr ä¸º tar åˆçº¦çš„åœ°å€,y ä¸º setX å‡½æ•°çš„å‚æ•°(uint x)<br>    function callSetX(address _addr, uint y) external&#123;<br>        tar(_addr).setX(y);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬è¿™ç§å·²ç»å¤Ÿç”¨äº†ã€‚</p><h4 id="è°ƒç”¨å‡½æ•°çš„åŒæ—¶å‘é€-ETH"><a href="#è°ƒç”¨å‡½æ•°çš„åŒæ—¶å‘é€-ETH" class="headerlink" title="è°ƒç”¨å‡½æ•°çš„åŒæ—¶å‘é€ ETH"></a>è°ƒç”¨å‡½æ•°çš„åŒæ—¶å‘é€ ETH</h4><p>è‹¥ç›®æ ‡å‡½æ•°ä¸º <code>payable</code>ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è°ƒç”¨å®ƒç»™åˆçº¦è½¬è´¦ï¼š<code>_Name(_Address).f&#123;value: _Value&#125;();</code></p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-variable">_Name</span>åˆçº¦å<br><span class="hljs-variable">_Address</span>åˆçº¦åœ°å€<br>fç›®æ ‡å‡½æ•°å<br><span class="hljs-variable">_Value</span>ETH æ•°é¢ï¼Œå‰ä¸€ä¸ª value: ä¸ºæ ¼å¼<br>()ä¼ å…¥ç›®æ ‡å‡½æ•°çš„å‚æ•°<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯åœ¨ä¸Šè¿°è°ƒç”¨æ–¹æ³•é‡ŒåŠ ä¸ª<code>&#123;&#125;</code>ï¼Œæ³¨æ˜å‘é€æ•°é¢ã€‚</p><p>å¦‚ä¸‹å¯ä»¥å‘ tar åˆçº¦ä¸­è½¬è´¦1 weiï¼Œå¹¶ä¼ å…¥ y</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function sendETH(address _addr, uint y) external payable &#123;<br>    tar(_addr).setX&#123;value: 1&#125;(y);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-ä¼ å…¥åˆçº¦å˜é‡"><a href="#2-ä¼ å…¥åˆçº¦å˜é‡" class="headerlink" title="2. ä¼ å…¥åˆçº¦å˜é‡"></a>2. ä¼ å…¥åˆçº¦å˜é‡</h3><p>ç›´æ¥åœ¨å‡½æ•°çš„å‚æ•°é‡Œä¼ å…¥åˆçº¦çš„å¼•ç”¨ã€‚</p><p>æ–¹æ³•ï¼šå°† <code>address</code> ç±»å‹æ¢ä¸ºç›®æ ‡åˆçº¦åã€‚è°ƒç”¨æ ¼å¼ï¼š<code>ä»¥åˆçº¦åä¸ºç±»å‹çš„å‚æ•°.ç›®æ ‡å‡½æ•°(å‚æ•°)ï¼›</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function callAndGetX(tar _addr, uint y) external returns(uint x)&#123;<br>_addr.setX(y);// æ•ˆæœåŒä¸Š<br>x = _addr.getX();// è·å¾— x çš„å€¼<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨ï¼š<code>tar _addr</code> åº•å±‚ç±»å‹ä»æ˜¯ <code>address</code>ï¼Œç”Ÿæˆçš„ ABI ä¸­ï¼Œè°ƒç”¨æ—¶ä¼ å…¥çš„å‚æ•°ä»æ˜¯ <code>address</code> ç±»å‹</p><h3 id="3-åˆ›å»ºåˆçº¦å˜é‡"><a href="#3-åˆ›å»ºåˆçº¦å˜é‡" class="headerlink" title="3. åˆ›å»ºåˆçº¦å˜é‡"></a>3. åˆ›å»ºåˆçº¦å˜é‡</h3><p>åˆ›å»ºä¸€ä¸ªæ–°å˜é‡å­˜å‚¨ç›®æ ‡åˆçº¦çš„å¼•ç”¨ã€‚</p><p>å‰ç½®ï¼š<code>ç›®æ ‡åˆçº¦å å˜é‡å = ç›®æ ‡åˆçº¦å(åˆçº¦çš„åœ°å€);</code></p><p>ä½¿ç”¨ï¼š<code>å˜é‡å.ç›®æ ‡å‡½æ•°(å‚æ•°);</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function newVar(address _addr, uint y) external returns(uint x) &#123;<br>    tar usetar = tar(_addr);// å‰ç½®æ­¥éª¤ï¼Œç”¨å˜é‡ usetar å‚¨å­˜äº† åˆçº¦tarçš„å¼•ç”¨ï¼Œå‰©ä½™æ­¥éª¤æ•ˆæœåŒä¸Š<br>    usetar.setX(y);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="22-é€šè¿‡Callè°ƒç”¨åˆçº¦"><a href="#22-é€šè¿‡Callè°ƒç”¨åˆçº¦" class="headerlink" title="22. é€šè¿‡Callè°ƒç”¨åˆçº¦"></a>22. é€šè¿‡Callè°ƒç”¨åˆçº¦</h2><p><code>call</code> æ˜¯ <code>address</code> ç±»å‹çš„ä½çº§æˆå‘˜ï¼Œè¿”å› <code>(bool, bytes memory)</code>ï¼Œå¯¹åº” call æ˜¯å¦æˆåŠŸåŠå‡½æ•°è¿”å›å€¼</p><ul><li>call æ˜¯æ¨èçš„å‘é€ ETH çš„æ–¹å¼ï¼Œä¸æ¨èç”¨æ¥è°ƒç”¨åˆçº¦ï¼Œå› ä¸ºè¿™æ ·ä¼šæŠŠæ§åˆ¶æƒäº¤ç»™å¯èƒ½ä¸å®‰å…¨çš„åˆçº¦ï¼ˆæ¨èä½¿ç”¨ä¸Šè¿°æ³•3ï¼‰</li><li>å½“ä¸çŸ¥é“å¯¹æ–¹æºç æˆ– ABI æ—¶ï¼Œæ— æ³•ç”Ÿæˆåˆçº¦å˜é‡ï¼Œæ­¤æ—¶å°±å¯ä»¥ç”¨ call è°ƒç”¨å¯¹æ–¹çš„å‡½æ•°</li></ul><p>ä½¿ç”¨è§„åˆ™ï¼š<code>ç›®æ ‡åˆçº¦åœ°å€.call(å­—èŠ‚ç );</code></p><ul><li>å­—èŠ‚ç é€šè¿‡ <code>abi.encodeWithSignature(&quot;å‡½æ•°ç­¾å&quot;, é€—å·åˆ†éš”çš„å…·ä½“å‚æ•°)</code> è·å¾—<ul><li>å‡½æ•°ç­¾åä¸º <code>å‡½æ•°å(é€—å·åˆ†éš”çš„å‚æ•°ç±»å‹)</code></li><li>ä»¥ <code>callSetX</code> ä¸ºä¾‹ï¼š<code>abi.encodeWithSignature(&quot;callSetX(address,uint256)&quot;, _addr, y)</code></li><li>==<strong>æ³¨æ„ï¼ï¼ï¼</strong>==ï¼šåœ¨å‚æ•°ç±»å‹ä¸­ <strong>ä¸èƒ½æœ‰</strong> ä»»ä½•ç©ºæ ¼ï¼Œå³ <code>&quot;callSetX(address, uint)&quot;</code> æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºé€—å·åå­˜åœ¨ç©ºæ ¼</li><li><code>uint</code> åº”å†™ä½œ <code>uint256</code></li></ul></li><li>ä¼´éš ETH å’Œ gas è¿›è¡Œè°ƒç”¨ï¼š<code>åœ°å€.call&#123;value:å‘é€æ•°é¢, gas:gasæ•°é¢&#125;(å­—èŠ‚ç );</code></li></ul><p>å·²çŸ¥æœ‰å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs solidity">import &quot;./Use_Other_Contract.sol&quot;;<br>contract tarCall is tar &#123;<br>    fallback() external payable &#123;&#125;<br>    receive() external payable&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>è°ƒç”¨ <code>setX</code>å¹¶è½¬ä¸€äº› ETH</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract useCall &#123;<br>    event response(bool _success, bytes _data);// ä¾¿äºè§‚å¯Ÿè¿”å›å€¼<br>    receive() external payable&#123;&#125;<br><br>    function callSetX(address payable _addr, uint y) external payable&#123;<br>        (bool success, bytes memory data) = _addr.call&#123;value:msg.value&#125;(<br>            abi.encodeWithSignature(&quot;setX(uint256)&quot;, y)<br>        );<br>// å‡è®¾æˆ‘ä»¬è½¬å…¥äº† 23Wei, xè®¾ä¸º234<br>        emit response(success, data);// ç»“æœä¸º true å’Œ 0x<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>è°ƒç”¨ <code>getX</code></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function callGetX(address _addr) external returns(uint) &#123;<br>(bool success, bytes memory data) = _addr.call(<br>abi.encodeWithSignature(&quot;getX()&quot;)<br>);<br><br>emit response(success, data);<br>// ç»“æœä¸º true, 0x00000000000000000000000000000000000000000000000000000000000000ea<br>return abi.decode(data,(uint));// è§£ç åç»“æœç¡®å®æ˜¯ 234<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>è°ƒç”¨ä¸å­˜åœ¨çš„å‡½æ•° â€”-&gt; è§¦å‘ fallback</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function callNonexist(address _addr) external &#123;<br>(bool success, bytes memory data) = _addr.call(<br>abi.encodeWithSignature(&quot;Nonexist(uint)&quot;)<br>    );<br>// æ— æ³•è°ƒç”¨ Nonexist(uint)ï¼Œå®é™…è§¦å‘çš„æ˜¯fallback<br>    emit response(success, data);// ç»“æœä¸º true, 0x<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="23-Delegatecall"><a href="#23-Delegatecall" class="headerlink" title="23. Delegatecall"></a>23. Delegatecall</h2><p>ç®€å•çš„è‹±è¯­å°çŸ¥è¯†ï¼šdelegate v. å§”æ‰˜ï¼Œæˆæƒï¼Œå§”æ´¾</p><p><code>delegatecall</code>ä¸ <code>call</code>  ç±»ä¼¼ï¼Œæ˜¯ <code>address</code> ç±»å‹çš„ä½çº§æˆå‘˜</p><h3 id="call-ä¸-delegatecall"><a href="#call-ä¸-delegatecall" class="headerlink" title="call ä¸ delegatecall"></a>call ä¸ delegatecall</h3><h4 id="1-call"><a href="#1-call" class="headerlink" title="1. call"></a>1. call</h4><p>A é€šè¿‡ contract B æ¥ call contract Cï¼Œæ‰§è¡Œ C çš„å‡½æ•°ï¼Œä¸Šä¸‹æ–‡ï¼ˆcontest,åŒ…å«å˜é‡å’ŒçŠ¶æ€çš„ç¯å¢ƒï¼‰ä¸º Cï¼›msg.sender ä¸º Bï¼Œæ”¹å˜çŠ¶æ€å˜é‡çš„ç»“æœä½œç”¨äº C</p><p><img src="https://images.mirror-media.xyz/publication-images/VgMR533pA8WYtE5Lr65mQ.png?height=698&amp;width=1860" alt="call"></p><h4 id="2-delecatecall"><a href="#2-delecatecall" class="headerlink" title="2. delecatecall"></a>2. delecatecall</h4><p>A é€šè¿‡ contract B æ¥ call contract Cï¼Œæ‰§è¡Œ C çš„å‡½æ•°ï¼Œä¸Šä¸‹æ–‡ä»ä¸º Bï¼›msg.sender ä¸º Aï¼Œæ”¹å˜çŠ¶æ€å˜é‡çš„ç»“æœä½œç”¨äº B</p><p><img src="https://images.mirror-media.xyz/publication-images/JucQiWVixdlmJl6zHjCSI.png?height=702&amp;width=1862" alt="delecatecall"></p><h3 id="Delegatecall-çš„ä½¿ç”¨"><a href="#Delegatecall-çš„ä½¿ç”¨" class="headerlink" title="Delegatecall çš„ä½¿ç”¨"></a>Delegatecall çš„ä½¿ç”¨</h3><p>å¤§è‡´ä¸ <code>call</code> ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äº <code>delegatecall</code> å°½å¯ä»¥æŒ‡å®š gasï¼Œä¸èƒ½æŒ‡å®šå‘é€çš„ ETH æ•°é¢</p><blockquote><p><strong>æ³¨æ„</strong>ï¼š<code>delegatecall</code>æœ‰å®‰å…¨éšæ‚£ï¼Œä½¿ç”¨æ—¶è¦ä¿è¯å½“å‰åˆçº¦å’Œç›®æ ‡åˆçº¦çš„çŠ¶æ€å˜é‡å­˜å‚¨ç»“æ„ç›¸åŒï¼Œå¹¶ä¸”ç›®æ ‡åˆçº¦å®‰å…¨ï¼Œä¸ç„¶ä¼šé€ æˆèµ„äº§æŸå¤±ã€‚</p></blockquote><ul><li>ä½¿ç”¨åœºæ™¯ï¼š<ol><li>ä»£ç†åˆçº¦(Proxy Contract)ï¼šå°†å­˜å‚¨åˆçº¦ä¸é€»è¾‘åˆçº¦åˆ†å¼€ã€‚ä»£ç†åˆçº¦å­˜å‚¨ç›¸å…³å˜é‡å’Œé€»è¾‘åˆçº¦çš„åœ°å€ï¼Œå‡½æ•°å­˜åœ¨é€»è¾‘åˆçº¦é‡Œï¼Œé€šè¿‡ <code>delecatecall</code> æ‰§è¡Œã€‚å‡çº§æ—¶åªéœ€å°†ä»£ç†åˆçº¦æŒ‡å‘æ–°çš„é€»è¾‘åˆçº¦å³å¯ã€‚</li><li>EIP-2535 Diamonds(é’»çŸ³)ï¼šè¯¦è§<a href="https://eip2535diamonds.substack.com/p/introduction-to-the-diamond-standard">é’»çŸ³æ ‡å‡†ç®€ä»‹</a>ï¼ˆçœ‹ä¸æ‡‚ä¸€ç‚¹ï¼‰</li></ol></li></ul><p>ä¾‹ï¼Œæœ‰å¦‚ä¸‹åˆçº¦ä½¿ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.21;<br><br>contract Proxy &#123;<br>    struct player &#123;<br>        uint256 id;<br>        string name;<br>        uint256 level;<br>    &#125;<br>    player public Player;<br>    address public sender;<br><br>    event log(bool success, bytes data);<br>    <br>    function setLogic(address _addr) public &#123;<br>        sender = _addr;<br>    &#125;<br><br>    function SetPlayer(<br>        uint256 _id,<br>        string memory _name,<br>        uint256 _exp<br>        ) public &#123;<br>            (bool _success, bytes memory _data) = sender.delegatecall(<br>                abi.encodeWithSignature(&quot;setPlayer(uint256,string,uint256)&quot;, _id, _name, _exp)<br>            );<br>            <br>            emit log(_success, _data);<br>        &#125;<br>&#125;<br><br>contract Logic &#123;<br>    struct player &#123;<br>        uint256 id;<br>        string name;<br>        uint256 level;<br>    &#125;<br>    player public Player;<br>    address public sender;<br><br>    function setPlayer(<br>        uint256 _id,<br>        string memory _name,<br>        uint256 _exp<br>        ) public &#123;<br>            Player.id = _id;<br>            Player.name = _name;<br>            Player.level = _exp/1000;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è‹¥è¦æ›´æ”¹ç»éªŒä¸ç­‰çº§çš„è½¬æ¢å…¬å¼ï¼Œåªéœ€éƒ¨ç½²æ›´æ”¹åçš„ Logic åˆçº¦ï¼Œç„¶ååœ¨ä»£ç†åˆçº¦ä¸­é‡æ–°è¾“å…¥ Logic åˆçº¦çš„åœ°å€å³å¯</p><h2 id="24-åœ¨åˆçº¦ä¸­åˆ›å»ºæ–°åˆçº¦"><a href="#24-åœ¨åˆçº¦ä¸­åˆ›å»ºæ–°åˆçº¦" class="headerlink" title="24. åœ¨åˆçº¦ä¸­åˆ›å»ºæ–°åˆçº¦"></a>24. åœ¨åˆçº¦ä¸­åˆ›å»ºæ–°åˆçº¦</h2><p>æœ‰ä¸¤ç§æ–¹æ³•ï¼š<code>create</code> å’Œ <code>create2</code></p><h3 id="create"><a href="#create" class="headerlink" title="create"></a>create</h3><p>ç”¨æ³•ï¼š<code>Contract x = new Contract&#123;value: _value&#125;(params)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">Contract åˆçº¦å<br>xæ¥æ”¶åˆçº¦åœ°å€çš„å˜é‡<br>&#123;value: _value&#125;è‹¥æœ‰ payable çš„ constructorï¼Œå¯åœ¨åˆ›å»ºæ—¶è½¬å…¥ _value çš„ ETH<br>(params)æ–°åˆçº¦ constructor çš„å‚æ•°<br></code></pre></td></tr></table></figure><p>createåœ°å€çš„è®¡ç®—ï¼š<code>æ–°åœ°å€ = hash(åˆ›å»ºè€…åœ°å€ï¼Œnonce)</code></p><ul><li>åˆ›å»ºè€…åœ°å€ï¼šé€šå¸¸ä¸ºéƒ¨ç½²çš„é’±åŒ…æˆ–åˆçº¦åœ°å€</li><li>nonceï¼šè¯¥åœ°å€å‘é€äº¤æ˜“çš„æ€»æ•°ï¼Œå¯¹ç”¨æˆ·è€Œè¨€æ˜¯åˆ›å»ºçš„åˆçº¦æ€»æ•° â€”-&gt; æ¯åˆ›å»ºä¸€ä¸ªåˆçº¦ï¼Œnonce å°± +1</li><li>å³ï¼šnonce ä¼šéšæœªæ¥çš„äº‹ä»¶æ”¹å˜ â€”-&gt; create åˆ›å»ºçš„åœ°å€ä¸å¥½é¢„æµ‹ â€”-&gt; å¼•å…¥ create2</li></ul><h3 id="create2"><a href="#create2" class="headerlink" title="create2"></a>create2</h3><p>åœ°å€è®¡ç®—ï¼š<code>æ–°åœ°å€ = hash(&quot;0xFF&quot;, åˆ›å»ºè€…åœ°å€, salt, initcode)</code></p><ul><li><code>&quot;0xFF&quot;</code>ï¼šä¸€ä¸ªå¸¸æ•°ï¼Œé¿å…ä¸ create å†²çª</li><li><code>salt</code>(ç›)ï¼šä¸€ä¸ªåˆ›ä½œè€…æŒ‡å®šçš„ <code>bytes32</code> ç±»å‹çš„å€¼ï¼Œç”¨æ¥å½±å“æ–°åˆ›å»ºçš„åˆçº¦åœ°å€  </li><li><code>initcode</code>ï¼šæ–°åˆçº¦çš„åˆå§‹å­—èŠ‚ç ï¼ˆåˆçº¦çš„ Creation Codeå’Œæ„é€ å‡½æ•°çš„å‚æ•° ï¼‰</li></ul><p>ç”¨æ³•ï¼š<code>Contract x = new Contract&#123;salt: _salt, value: _value&#125;(params)</code></p><h2 id="25-åˆ é™¤åˆçº¦"><a href="#25-åˆ é™¤åˆçº¦" class="headerlink" title="25. åˆ é™¤åˆçº¦"></a>25. åˆ é™¤åˆçº¦</h2><p><code>selfdestruct</code> å¯ä»¥å°†è¯¥åˆçº¦å‰©ä½™çš„ ETH è½¬åˆ°æŒ‡å®šåœ°å€ï¼ˆå³ä½¿å®ƒæ²¡æœ‰receive æˆ– fallbackï¼‰ã€‚åæ˜†å‡çº§å‰å¯ç”¨äºåˆ é™¤åˆçº¦è‡ªèº«ï¼Œå‡çº§åä¸å¯ï¼Œä»ä¼šä¿ç•™è¯¥åˆçº¦ã€‚</p><p>ç›®å‰æ¥è¯´ï¼š</p><ol><li>å·²éƒ¨ç½²çš„åˆçº¦æ— æ³•è¢« <code>selfdestruct</code></li><li>è¦æƒ³ä½¿ç”¨åˆ é™¤åˆçº¦çš„åŠŸèƒ½ï¼Œå¿…é¡»åœ¨åŒä¸€ç¬”äº¤æ˜“ä¸­åˆ›å»ºå¹¶è‡ªæ¯åˆçº¦</li></ol><p>é£Ÿç”¨æ–¹æ³•ï¼š<code>selfdetruct(_addr);</code>ï¼Œå…¶ä¸­ï¼Œ<code>_addr</code> ä¸ºæ¥æ”¶ ETH çš„åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract deleteContract &#123;<br>    constructor() payable&#123;&#125;// éƒ¨ç½²æ—¶è½¬å…¥ 1ETH<br>    receive() external payable&#123;&#125;<br><br>    function useDestruct() external &#123;<br>        selfdestruct( payable(msg.sender) );// è°ƒç”¨å 1ETH è¢«è¿”å›msg.sender<br>    &#125;<br><br>    function getBalance() external view returns(uint balance) &#123;<br>        balance = address(this).balance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹å±•ç¤ºäº†åˆ é™¤åˆçº¦è‡ªèº«</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract destroy &#123;<br>    constructor() payable&#123;&#125;<br><br>    struct demo &#123;<br>        uint _balance;<br>        address _addr;<br>        uint _value;<br>    &#125;<br><br>    function getBalance() external view returns(uint balance) &#123;<br>        balance = address(this).balance;<br>    &#125; <br><br>    function destruction() public payable returns(demo memory)&#123;<br>        deleteContract del = new deleteContract&#123;value: msg.value&#125;();<br>        demo memory res = demo(&#123;<br>            _balance: del.getBalance(),<br>            _addr: address(del), <br>            _value: del.value()<br>        &#125;);<br>        del.useDestruct();<br>        return res;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>éƒ¨ç½²å¹¶ä¼ å…¥ 1 ETHï¼Œè°ƒç”¨ <code>destruction</code> å‡½æ•°ï¼Œå¾—åˆ°è¿”å›å€¼ <code>0,0xf7D2eCC586332F18fa249A9A65da252036dBb8EC,100</code>ï¼Œè¡¨æ˜ <code>del</code> åˆçº¦ä¸­ETH å‰©ä½™ä¸º 0ï¼Œ<code>del</code> åˆçº¦çš„åœ°å€ï¼Œ<code>value = 100</code>ã€‚å°†ä¸Šè¿°åœ°å€ä»¥ <code>DeleteContract</code> åˆçº¦å¯¼å…¥ï¼ˆå¯¼å…¥çš„ <code>contract</code> å³ <code>del</code>åˆçº¦ï¼‰ï¼Œè°ƒç”¨ <code>value</code> å’Œ <code>getBalance</code> å‡ <code>Error</code></p><h2 id="26-ABIç¼–ç è§£ç "><a href="#26-ABIç¼–ç è§£ç " class="headerlink" title="26. ABIç¼–ç è§£ç "></a>26. ABIç¼–ç è§£ç </h2><p>å³Application Binary Interface(åº”ç”¨äºŒè¿›åˆ¶æ¥å£)ï¼Œæ˜¯ä¸ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦äº¤äº’çš„åŸºç¡€ã€‚</p><p>æ•°æ®åŸºäºç±»å‹ç¼–ç ï¼›ç”±äºç¼–ç åä¸åŒ…å«ç±»å‹ä¿¡æ¯ï¼Œè§£ç æ—¶éœ€æ³¨æ˜ç±»å‹</p><h3 id="ABIç¼–ç "><a href="#ABIç¼–ç " class="headerlink" title="ABIç¼–ç "></a>ABIç¼–ç </h3><p>å¯¹å¦‚ä¸‹4ä¸ªå˜é‡è¿›è¡Œç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint x = 22;<br>address addr = 0xf7D2eCC586332F18fa249A9A65da252036dBb8EC;<br>string name = &quot;victifa&quot;;<br>uint[2] = [11, 27];<br></code></pre></td></tr></table></figure><ol><li><code>abi.encode</code></li></ol><p>å°†ç»™å®šå‚æ•°æŒ‰ç…§<a href="https://learnblockchain.cn/docs/solidity/abi-spec.html">ABIè§„åˆ™</a>ç¼–ç ã€‚ABIå°†æ¯ä¸ªå‚æ•°å¡«å……ä¸º32å­—èŠ‚çš„æ•°æ®ï¼Œè¿æ¥åˆ°ä¸€èµ·ã€‚</p><ul><li>å¦‚æœè¦å’Œæ™ºèƒ½åˆçº¦äº¤äº’ï¼Œå°±ç”¨ <code>abi.encode</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function encode()public view returns(bytes memory res) &#123;<br>res = abi.encode(x, addr, name, arr);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±äºæ¯ä¸ªæ•°æ®éƒ½è¢«å¡«å……ä¸º32å­—èŠ‚ï¼Œä¸­é—´æœ‰å¾ˆå¤š0ã€‚ç»“æœä¸º ï¼š<code>0x0000000000000000000000000000000000000000000000000000000000000016000000000000000000000000f7d2ecc586332f18fa249a9a65da252036dbb8ec00000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000b000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000077669637469666100000000000000000000000000000000000000000000000000</code></p><ol><li><code>abi.encodePacked</code></li></ol><p>å°†ç»™å®šå‚æ•°æŒ‰æ‰€éœ€æœ€ä½ç©ºé—´ç¼–ç ï¼ˆå¦‚ç”¨1å­—èŠ‚ç¼–è¯‘uint8ï¼‰ã€‚ç±»ä¼¼ <code>abi.encode</code>ï¼Œä½†çœå»äº†å¾ˆå¤š0ã€‚</p><ul><li>å¦‚æœè¦çœç©ºé—´ï¼Œä¸”ä¸ä¸åˆçº¦äº¤äº’ï¼Œå°±ç”¨ <code>abi.encodePacked</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function encodePacked()public view returns(bytes memory res) &#123;<br>res = abi.encodePacked(x, addr, name, arr);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœä¸ºï¼š<code>0x0000000000000000000000000000000000000000000000000000000000000016f7d2ecc586332f18fa249a9a65da252036dbb8ec76696374696661000000000000000000000000000000000000000000000000000000000000000b000000000000000000000000000000000000000000000000000000000000001b</code></p><ol><li><p><code>abi.encodeWithSignature</code></p><blockquote><p>ç­‰åŒäº <code>abi.encodeWithSelector( bytes4( keccak256( bytes(signature) ) ), ... )</code></p></blockquote></li></ol><p>ç±»ä¼¼ <code>abi.encode</code>ï¼Œä½†ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°ç­¾å</p><ul><li><p>è°ƒç”¨å…¶ä»–åˆçº¦æ—¶ä½¿ç”¨ã€‚å¦‚é€šè¿‡ <code>call</code> è°ƒç”¨å…¶ä»–åˆçº¦ï¼š</p><p><code>_addr.call&#123;value: _value, gas: _amount&#125;( abi.encodeWithSignature(&quot;example(uint,string)&quot;, _num, _name) );</code></p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function encodeWithSignature()public view returns(bytes memory res) &#123;<br>res = abi.encodeWithSignature(&quot;test(uint256,address,string,uint256[2])&quot;, x, addr, name, arr);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ç„¶å¯¹ä¸Šè¿°4ä¸ªå‚æ•°ç¼–ç ï¼ˆå‡å®šå‡½æ•°ä¸º<code>test</code>ï¼‰ï¼Œç»“æœä¸ºï¼š<code>0x31ceee1e0000000000000000000000000000000000000000000000000000000000000016000000000000000000000000f7d2ecc586332f18fa249a9a65da252036dbb8ec00000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000b000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000077669637469666100000000000000000000000000000000000000000000000000</code></p><ul><li>ç­‰åŒäºåœ¨ <code>abi.encode</code> ç»“æœå‰åŠ ä¸Šäº†4å­—èŠ‚çš„å‡½æ•°é€‰æ‹©å™¨ï¼ˆè§ä¸‹29. é€‰æ‹©å™¨ï¼‰</li></ul><ol><li><code>abi.encodeWithSelector</code></li></ol><p>ä¸3ç±»ä¼¼ï¼Œä½†ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°é€‰æ‹©å™¨ï¼ˆå‡½æ•°ç­¾åKeccakå“ˆå¸Œçš„å‰4ä¸ªå­—èŠ‚ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function encodeWithSelector()public view returns(bytes memory res) &#123;<br>res = abi.encodeWithSelector(<br>bytes4( keccak256(&quot;test(uint256,address,string,uint256[2])&quot;) ), <br> x, addr, name, arr<br>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœä¸ºï¼š<code>0x31ceee1e0000000000000000000000000000000000000000000000000000000000000016000000000000000000000000f7d2ecc586332f18fa249a9a65da252036dbb8ec00000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000b000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000077669637469666100000000000000000000000000000000000000000000000000</code></p><h3 id="ABIè§£ç "><a href="#ABIè§£ç " class="headerlink" title="ABIè§£ç "></a>ABIè§£ç </h3><p>å³ï¼š<code>abi.decode</code>ï¼Œç”¨äºè§£ç  <code>abi.encode</code> ç”Ÿæˆçš„äºŒè¿›åˆ¶ç¼–ç ï¼Œè¿˜åŸä¸ºåŸå‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function decode(bytes memory _res) public pure returns(<br>uint deX, <br>address deAddr, <br>string memory deName, <br>uint[2] memory deArr<br>) &#123;<br>(deX, deAddr, deName, deArr) = abi.decode(_res, (uint, address, string, uint[2]));<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint256: deX 22<br>address: deAddr 0xf7D2eCC586332F18fa249A9A65da252036dBb8EC<br>string: deName victifa<br>uint256[2]: deArr11,27<br></code></pre></td></tr></table></figure><h3 id="ABIçš„ä½¿ç”¨åœºæ™¯"><a href="#ABIçš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="ABIçš„ä½¿ç”¨åœºæ™¯"></a>ABIçš„ä½¿ç”¨åœºæ™¯</h3><ol><li>é…åˆ <code>call</code>ï¼Œè§ <code>3. abi.encodeWithSignature</code></li><li>ether.js ä¸­ç”¨ ABI å®ç°åˆçº¦çš„å¯¼å…¥å’Œè°ƒç”¨</li><li>éå¼€æºåˆçº¦åç¼–è¯‘åï¼Œæ— æ³•æŸ¥åˆ°å‡½æ•°ç­¾åï¼Œåªæœ‰ç¼–ç åç»“æœ</li></ol><h2 id="27-Hash"><a href="#27-Hash" class="headerlink" title="27. Hash"></a>27. Hash</h2><p>ä¸€ä¸ªå¥½çš„å“ˆå¸Œå‡½æ•°å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ul><li>å•å‘æ€§ï¼šæ­£å‘ç®€å•ä¸”ç»“æœå”¯ä¸€ï¼Œé€†å‘åªèƒ½é æš´åŠ›æšä¸¾</li><li>çµæ•æ€§ï¼šæ··æ²Œï¼Œå¯¹åˆå€¼æ•æ„Ÿï¼Œæ”¹å˜ä¸€ç‚¹å¯¹ç»“æœå½±å“å¤§</li><li>é«˜æ•ˆæ€§</li><li>å‡ä¸€æ€§ï¼šæ¯ä¸ªå“ˆå¸Œå€¼è¢«å–åˆ°çš„æ¦‚ç‡åŸºæœ¬ç›¸ç­‰</li><li>ç¢°æ’æŠ—æ€§ï¼š<ul><li>å¼±æŠ—ç¢°æ’æ€§ï¼šå·²çŸ¥ <code>x</code>ï¼Œæ±‚ <code>x&#39;</code> ä½¿ <code>hash(x&#39;) = hash(x)</code> æ˜¯å›°éš¾çš„</li><li>å¼ºæŠ—ç¢°æ’æ€§ï¼šä»»å– <code>x</code> å’Œ <code>x&#39;</code>ï¼Œä½¿ <code>hash(x) = hash(s&#39;)</code> æ˜¯å›°éš¾çš„</li></ul></li></ul><p>åº”ç”¨ï¼šç”Ÿæˆæ•°æ®å”¯ä¸€æ ‡è¯†ï¼ŒåŠ å¯†ç­¾åï¼Œå®‰å…¨åŠ å¯†</p><h3 id="Keccak256"><a href="#Keccak256" class="headerlink" title="Keccak256"></a>Keccak256</h3><p>æ˜¯ solidity å¸¸ç”¨çš„å“ˆå¸Œå‡½æ•°</p><p>ç”¨æ³•ï¼š<code>bytes32 x = keccak256(æ•°æ®);</code></p><ul><li>SHA3 ä¸ keccak è®¡ç®—ç»“æœä¸ä¸€æ ·ï¼Œä½† solidity ä¸­çš„ SHA3 æ˜¯æŒ‡ keccak256ï¼Œè€Œéæ ‡å‡†çš„ NIST-SHA3 </li></ul><h3 id="ç¢°æ’æŠ—æ€§éªŒè¯"><a href="#ç¢°æ’æŠ—æ€§éªŒè¯" class="headerlink" title="ç¢°æ’æŠ—æ€§éªŒè¯"></a>ç¢°æ’æŠ—æ€§éªŒè¯</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract test &#123;<br>    string str;<br>    constructor(string memory _str) &#123;<br>        str = _str;<br>    &#125;<br><br>    function hash() public view returns(bytes32)&#123;<br>        return keccak256( abi.encodePacked(str) );<br>    &#125;<br><br>    function weak(string memory _str) public view returns(bool) &#123;<br>        return keccak256( abi.encodePacked(_str) ) == hash();<br>    &#125;<br><br>    function strong(string memory _str1, string memory _str2) public pure returns(bool) &#123;<br>        return keccak256( abi.encodePacked(_str1) ) == keccak256( abi.encodePacked(_str2) );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="28-Try-Catch"><a href="#28-Try-Catch" class="headerlink" title="28. Try Catch"></a>28. Try Catch</h2><p>å¤„ç†å¼‚å¸¸çš„ä¸€ç§æ ‡å‡†æ–¹å¼ã€‚</p><p>åŸºæœ¬è¯­æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs solidity">try externalContract.function() &#123;<br>// call æˆåŠŸæ‰§è¡Œ<br>&#125; catch &#123;<br>// call å¤±è´¥æ‰§è¡Œ<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å¯ä»¥ç”¨ <code>this.function()</code> æ›¿ä»£ <code>externalContract.function()</code>ï¼Œè¢«è§†ä¸ºå¤–éƒ¨è°ƒç”¨ï¼Œä½†ä¸èƒ½åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ï¼Œå› ä¸ºæ­¤æ—¶ contract æœªåˆ›å»º</li></ul><p>è‹¥è°ƒç”¨å‡½æ•°æœ‰è¿”å›å€¼å¿…é¡»å£°æ˜ <code>returns(returnType val)</code>ï¼›å¦‚æœæ˜¯åˆ›å»ºåˆçº¦ï¼Œè¿”å›å€¼ä¸ºæ–°åˆ›å»ºçš„åˆçº¦å˜é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs solidity">try externalContract.function() &#123;<br>// call æˆåŠŸæ‰§è¡Œ<br>&#125; catch Error(string memory) &#123; // reason<br>    // æ•è·revert(&quot;reasonString&quot;) å’Œ require(false, &quot;reasonString&quot;)<br>&#125; catch Panic(uint) &#123; // errorCode<br>    // æ•è·Panicå¯¼è‡´çš„é”™è¯¯ ä¾‹å¦‚assertå¤±è´¥ æº¢å‡º é™¤é›¶ æ•°ç»„è®¿é—®è¶Šç•Œ<br>&#125; catch (bytes memory) &#123; //lowLevelData<br>    // å¦‚æœå‘ç”Ÿäº†revertä¸”ä¸Šé¢2ä¸ªå¼‚å¸¸ç±»å‹åŒ¹é…éƒ½å¤±è´¥äº† ä¼šè¿›å…¥è¯¥åˆ†æ”¯<br>    // ä¾‹å¦‚revert() require(false) revertè‡ªå®šä¹‰ç±»å‹çš„error<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="29-é€‰æ‹©å™¨"><a href="#29-é€‰æ‹©å™¨" class="headerlink" title="29. é€‰æ‹©å™¨"></a>29. é€‰æ‹©å™¨</h2><p>å·²çŸ¥ï¼šå½“æˆ‘ä»¬è°ƒç”¨åˆçº¦ä¸­çš„å‡½æ•°æ—¶ï¼Œæœ¬è´¨ä¸Šæ˜¯å‘ç›®æ ‡åˆçº¦å‘é€äº†ä¸€æ®µ <code>calldata</code>ï¼Œä»¥ <code>hash</code> ä¸­çš„ <code>weak</code> å‡½æ•°ä¸ºä¾‹ï¼š</p><p>è°ƒç”¨å‡½æ•°åï¼Œåœ¨ <code>input</code>æ ä¸­å¯ä»¥æ‰¾åˆ°æ­¤æ¬¡äº¤æ˜“çš„ <code>calldata</code>ï¼š<code>0xd6abfc7b000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000077669637469666100000000000000000000000000000000000000000000000000</code></p><p>å…¶ä¸­ï¼Œå‰4ä¸ªå­—èŠ‚ï¼ˆå³ <code>0xd6abfc7b</code>ï¼‰å°±æ˜¯ <code>selector</code>ï¼Œå‡½æ•°é€‰æ‹©å™¨</p><ul><li><p>é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ <code>msg.data</code> æ¥è·å¾—å‡½æ•°å®Œæ•´çš„ <code>calldata</code></p><p>æˆ‘ä»¬ç®€å•ä¿®æ”¹ä¸€ä¸‹ <code>weak</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs solidity">event log(bytes data);  <br>function weak(string memory _str) public returns(bool) &#123;<br>emit log(msg.data);<br>    return keccak256( abi.encodePacked(_str) ) == hash();<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å…¥åŒæ ·çš„å€¼ï¼Œæˆ‘ä»¬åœ¨Logsä¸­å¾—åˆ°å¦‚ä¸‹å¦‚ä¸‹ <code>calldata</code>ï¼š</p><p><code>0xd6abfc7b000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000077669637469666100000000000000000000000000000000000000000000000000</code></p></li></ul><p>å°†æ‰€å¾— <code>calldata</code> åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><ul><li><p>å‰4ä¸ªå­—èŠ‚ï¼šå‡½æ•°é€‰æ‹©å™¨ <code>selector</code></p><p><code>0xd6abfc7b</code></p></li><li><p>åé¢32ä¸ªå­—èŠ‚ï¼šè¾“å…¥çš„å‚æ•°</p><p><code>0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000077669637469666100000000000000000000000000000000000000000000000000</code></p></li></ul><p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œ<code>calldata</code> å°±æ˜¯æŒ‡æ˜äº†è°ƒç”¨çš„å‡½æ•°åŠå…¶å‚æ•°ã€‚</p><h3 id="å‡½æ•°ç­¾å-ï¼Œmethod-id-å’Œ-å‡½æ•°é€‰æ‹©å™¨selector"><a href="#å‡½æ•°ç­¾å-ï¼Œmethod-id-å’Œ-å‡½æ•°é€‰æ‹©å™¨selector" class="headerlink" title="å‡½æ•°ç­¾å ï¼Œmethod id å’Œ å‡½æ•°é€‰æ‹©å™¨selector"></a>å‡½æ•°ç­¾å ï¼Œmethod id å’Œ å‡½æ•°é€‰æ‹©å™¨selector</h3><p>å‡½æ•°ç­¾åï¼š<code>&quot;å‡½æ•°å(å‡½æ•°çš„å‚æ•°ç±»å‹)&quot;</code></p><p><code>method id</code>ï¼šå‡½æ•°ç­¾å é€šè¿‡ <code>Keccakå“ˆå¸Œ</code> åçš„å‰4å­—èŠ‚ï¼ˆ<code>bytes4( keccak256( å‡½æ•°å(å‚æ•°ç±»å‹) ) )</code>ï¼‰ï¼Œå½“ <code>method id</code> ä¸ <code>selector</code> ä¸€è‡´æ—¶å°±è°ƒç”¨è¯¥å‡½æ•°ã€‚</p><p><code>method id</code> æ˜¯é€šè¿‡å‡½æ•°ååŠå‚æ•°ç±»å‹è®¡ç®—çš„ï¼Œå‚æ•°ç±»å‹åˆ†ä¸º3ç§ï¼šåŸºç¡€ç±»å‹å‚æ•°ï¼Œå›ºå®šé•¿åº¦ç±»å‹å‚æ•°ï¼Œå¯å˜é•¿åº¦ç±»å‹å‚æ•°ï¼Œæ˜ å°„ç±»å‹å‚æ•°ã€‚</p><h4 id="åŸºç¡€ç±»å‹å‚æ•°"><a href="#åŸºç¡€ç±»å‹å‚æ•°" class="headerlink" title="åŸºç¡€ç±»å‹å‚æ•°"></a>åŸºç¡€ç±»å‹å‚æ•°</h4><p>åŒ…æ‹¬ä½†ä¸é™äºï¼š<code>uint</code>ï¼Œ<code>bool</code> ï¼Œ<code>address</code>ï¼ˆåŸºæœ¬ä¸Šå°±æ˜¯é™¤å»å®šé•¿å­—èŠ‚æ•°ç»„çš„å€¼ç±»å‹ï¼‰</p><p>åŸºç¡€ç±»å‹å‚æ•°åœ¨å¤„ç† <code>method id</code> æ—¶ï¼Œè®¡ç®— <code>bytes4( keccak256(&quot;å‡½æ•°å(ç±»å‹1,ç±»å‹2,Â·Â·Â·)&quot;) )</code></p><p>ä¾‹ï¼šæœ‰å¦‚ä¸‹åˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract Test&#123;<br>    event calldt(bytes);<br>    event selector(bytes4);<br>    function test1 (uint256 a, bool b) public returns(bytes4 res)&#123;<br>       emit calldt(msg.data);<br>       emit selector(this.test1.selector);<br>       res = bytes4( keccak256((&quot;test1(uint256,bool)&quot;)) );<br>    &#125;<br>&#125;<br>/* <br>  calldtï¼š<br>  0x2cd42d4b000000000000000000000000000000000000000000000000000000000001bf520000000000000000000000000000000000000000000000000000000000000001<br>  <br>  selector:0x2cd42d4b<br>  res:0x2cd42d4b<br>*/<br></code></pre></td></tr></table></figure><h4 id="å›ºå®šé•¿åº¦ç±»å‹å‚æ•°"><a href="#å›ºå®šé•¿åº¦ç±»å‹å‚æ•°" class="headerlink" title="å›ºå®šé•¿åº¦ç±»å‹å‚æ•°"></a>å›ºå®šé•¿åº¦ç±»å‹å‚æ•°</h4><p>ä¸€èˆ¬ä¸ºå®šé•¿æ•°ç»„ï¼Œå¦‚ <code>uint256[11]</code>ã€‚</p><p>å›ºå®šé•¿åº¦ç±»å‹å‚æ•°åœ¨å¤„ç† <code>method id</code> æ—¶ï¼Œè®¡ç®— <code>bytes4( keccak256(&quot;å‡½æ•°å(ç±»å‹1[é•¿åº¦],ç±»å‹2[é•¿åº¦],Â·Â·Â·)&quot;) )</code></p><p>ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function test2(uint256[3] memory a) public returns(bytes4 res) &#123;<br>    emit calldt(msg.data);<br>    emit selector(this.test2.selector);<br>    res = bytes4( keccak256(&quot;test2(uint256[3])&quot;) );<br>&#125;<br>/*<br>  calldt:<br>  0x29c0be99000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003<br>  <br>  selector:0x29c0be99<br>  res:0x29c0be99<br>*/<br></code></pre></td></tr></table></figure><h4 id="å¯å˜é•¿åº¦ç±»å‹å‚æ•°"><a href="#å¯å˜é•¿åº¦ç±»å‹å‚æ•°" class="headerlink" title="å¯å˜é•¿åº¦ç±»å‹å‚æ•°"></a>å¯å˜é•¿åº¦ç±»å‹å‚æ•°</h4><p>ä¸€èˆ¬ä¸ºå¯å˜é•¿çš„æ•°ç»„ï¼Œå¦‚ï¼š<code>uint256[]</code>ï¼Œ<code>address[]</code>ï¼Œ<code>string</code> ç­‰éƒ½æ˜¯ã€‚</p><p>å¯å˜é•¿åº¦ç±»å‹å‚æ•°åœ¨å¤„ç† <code>method id</code> æ—¶ï¼Œè®¡ç®— <code>bytes4( keccak256(&quot;å‡½æ•°å(ç±»å‹1[],ç±»å‹2[],Â·Â·Â·)&quot;) )</code></p><p>ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function test3(uint256[] memory a, address[] memory b, string memory c) public returns(bytes4 res) &#123;<br>emit calldt(msg.data);<br>emit selector(this.test3.selector);<br>    res = bytes4( keccak256(&quot;test3(uint256[],address[],string)&quot;) );<br>&#125;<br>/*<br>  calldt:<br>  0x6855a474000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d9145cce52d386f254917e481eb44e9943f3913800000000000000000000000000000000000000000000000000000000000000036162630000000000000000000000000000000000000000000000000000000000<br>  <br>  selector:0x6855a474<br>  res:0x6855a474<br>*/<br></code></pre></td></tr></table></figure><h4 id="æ˜ å°„ç±»å‹å‚æ•°"><a href="#æ˜ å°„ç±»å‹å‚æ•°" class="headerlink" title="æ˜ å°„ç±»å‹å‚æ•°"></a>æ˜ å°„ç±»å‹å‚æ•°</h4><p>ä¸€èˆ¬æŒ‡ <code>contract</code>ï¼ˆåº•å±‚ä¸º <code>address</code>ï¼‰ï¼Œ<code>enum</code>ï¼ˆåº•å±‚ä¸º <code>uint8</code>ï¼‰ï¼Œ<code>struct</code>ï¼ˆåº•å±‚ä¸ºç»“æ„ä½“å†…å„å…ƒç´ çš„ç±»å‹ï¼‰ç­‰ã€‚</p><p>æ˜ å°„ç±»å‹å‚æ•°åœ¨å¤„ç† <code>method id</code> æ—¶ï¼Œå°†å…¶è½¬åŒ–ä¸º <code>ABI</code> ç±»å‹ã€‚</p><p>ä¾‹ï¼šä¸‹æ–¹å‡½æ•°ä¸­ï¼Œç»“æ„ä½“ <code>user</code> è½¬åŒ–ä¸º <code>tuple</code> ç±»å‹ <code>(uint32,bytes)</code>ï¼Œæšä¸¾ <code>school</code> è½¬åŒ–ä¸º <code>uint8</code>ï¼Œåˆçº¦ <code>aSimpleDemo</code> è½¬åŒ–ä¸º <code>address</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract Test &#123;    <br>    /******************<br>        å‰æ–¹å„å‡½æ•°çœç•¥  <br>     ******************/<br>    struct user &#123;<br>        uint32 id;<br>        bytes name;<br>    &#125;<br>    <br>    enum school &#123; LongQuan, KongGang, XinGu&#125;<br>    <br>    function test4(user memory userA, school cuit, aSimpleDemo demo) public returns(bytes4 res) &#123;<br>        emit calldt(msg.data);<br>        emit selector(this.test3.selector);<br>        res = bytes4( keccak256(&quot;test4((uint32,bytes),uint8,address)&quot;) );<br>    &#125;<br><br>&#125;<br><br>contract aSimpleDemo &#123;&#125;<br>/*<br>  calldt:<br>  0xa595d89900000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000001000000000000000000000000cd6a42782d230d7c13a74ddec5dd140e55499df9000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000<br>  <br>  selector:0xa595d899<br>  res:0xa595d899<br>*/<br></code></pre></td></tr></table></figure><h3 id="selector-çš„ä½¿ç”¨"><a href="#selector-çš„ä½¿ç”¨" class="headerlink" title="selector çš„ä½¿ç”¨"></a>selector çš„ä½¿ç”¨</h3><p>ä¸»è¦è¿ç”¨åœ¨é€šè¿‡callè°ƒç”¨å‡½æ•°ä¸­ã€‚</p><p>ä¸€èˆ¬ç”¨ <code>abi.encodeWithSelector</code> å°†å‡½æ•°çš„ <code>method id</code> ä½œä¸º <code>selector</code>ï¼ˆä¹Ÿå°±æ˜¯ä¸Šæ–¹çš„ <code>selector</code> æˆ– <code>res</code>ï¼‰ï¼Œå’Œå‡½æ•°çš„å‚æ•°ä¸€èµ·æ‰“åŒ…ï¼Œä½œä¸º call çš„å‚æ•°ã€‚</p><p>å½¢å¦‚ï¼š <code>ç›®æ ‡å‡½æ•°æ‰€åœ¨åˆçº¦åœ°å€.call( abi.encodeWithSelecor(selector,å‚æ•°1,å‚æ•°2,Â·Â·Â·) );</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>Solidity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Solidity101ç¬”è®°</title>
    <link href="/2024/11/30/Solidity101/"/>
    <url>/2024/11/30/Solidity101/</url>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯ WTF å­¦é™¢ Solidity101 çš„ä¸€æ®µå­¦ä¹ ç¬”è®°ã€‚<br>ç”±äºåŸæ¥çš„å¤ªä¹±ï¼Œä¸ºäº†ä¾¿äºè‡ªå·±æŸ¥æ‰¾ï¼Œç®€å•åœ°æ›´æ–°äº†ä¸€ä¸‹ã€‚</p><h2 id="1-Hello-World-Web3"><a href="#1-Hello-World-Web3" class="headerlink" title="1. Hello World! Web3!"></a>1. Hello <del>World!</del> Web3!</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.21;<br>contract  HelloWeb3 &#123;<br>    string public _string = &quot;Hello Web3!&quot;;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>L1ï¼šä½¿ç”¨ MIT è½¯ä»¶è®¸å¯ (license)ï¼Œä¸å†™ä¼šè­¦å‘Šï¼Œä½†ä¹Ÿèƒ½è·‘</li><li>L2ï¼šå£°æ˜ä½¿ç”¨ç‰ˆæœ¬ï¼Œä¸ <code>pragma solidity &gt;=0.8.21 &lt;0.9.0;</code> ç­‰ä»·</li><li>L3ï¼šåˆ›å»ºåˆçº¦ï¼Œå‘½åä¸º <code>HelloWeb3</code></li><li>L4ï¼šå£°æ˜ string ç±»å‹å˜é‡ <code>_string</code>ï¼Œå¯åœ¨éƒ¨ç½²ç•Œé¢è°ƒç”¨æŸ¥çœ‹</li></ul><h2 id="2-å€¼ç±»å‹ï¼šä¼ é€’æ•°å€¼"><a href="#2-å€¼ç±»å‹ï¼šä¼ é€’æ•°å€¼" class="headerlink" title="2. å€¼ç±»å‹ï¼šä¼ é€’æ•°å€¼"></a>2. å€¼ç±»å‹ï¼šä¼ é€’æ•°å€¼</h2><h3 id="1-å¸ƒå°”å‹-bool"><a href="#1-å¸ƒå°”å‹-bool" class="headerlink" title="1. å¸ƒå°”å‹ bool"></a>1. å¸ƒå°”å‹ <code>bool</code></h3><ul><li>å–å€¼ï¼š<code>true</code> æˆ– <code>false</code></li><li>è¿ç®—ç¬¦ï¼š( çŸ­è·¯ ) ä¸ <code>&amp;&amp;</code>ï¼Œ ( çŸ­è·¯ ) æˆ– <code>||</code>ï¼Œ é <code>!</code>ï¼Œ ç­‰äº <code>==</code>ï¼Œ ä¸ç­‰äº <code>!=</code></li></ul><h3 id="2-æ•´å‹"><a href="#2-æ•´å‹" class="headerlink" title="2. æ•´å‹"></a>2. æ•´å‹</h3><p>åŒ…å«å¸¦ç¬¦å·ï¼ˆ<code>int</code>ï¼‰ä¸æ— ç¬¦å·ï¼ˆ<code>uint</code>ï¼‰ä¸¤ç§ã€‚</p><p>åœ¨ç±»å‹ååŠ ä¸Šæ•°å­—è¡¨ç¤ºè¯¥å˜é‡æ‰€å å†…å­˜çš„ä½æ•°ï¼Œå¦‚ï¼š</p><ul><li>uint16 è¡¨ç¤º 2 å­—èŠ‚ï¼ˆ16 ä½ï¼‰çš„éè´Ÿæ•°ï¼Œå–å€¼èŒƒå›´ï¼š0 ~ 2^16^-1</li><li>uint ä¸º uint256 çš„åˆ«åï¼ˆç›¸å½“äº C é‡Œçš„ <code>unsigned int</code>ï¼‰ï¼Œint ä¸º int256 çš„åˆ«å</li><li>ä½¿ç”¨ ABI ç¼–ç æ—¶ï¼ŒåŠ¡å¿…å†™æˆå®Œæ•´åç§° uint256</li></ul><p>é™¤æ±‚å¹‚ç”¨ <code>**</code> å¤–ï¼Œå…¶ä»–è¿ç®—ä¸ C ä¸€è‡´ã€‚</p><p>æ³¨ï¼šæ•´å‹çš„æº¢å‡ºå·²åœ¨ 0.8.0 æ·»åŠ äº†è‡ªåŠ¨å›é€€ï¼Œä½†å¯¹è¾ƒè€çš„ç‰ˆæœ¬ä»éœ€æ³¨æ„ã€‚</p><h3 id="3-åœ°å€ç±»å‹-address"><a href="#3-åœ°å€ç±»å‹-address" class="headerlink" title="3. åœ°å€ç±»å‹ address"></a>3. åœ°å€ç±»å‹ <code>address</code></h3><p>åˆ†ä¸º æ™®é€šåœ°å€ å’Œ payableåœ°å€ï¼ŒåŒºåˆ«å¦‚ä¸‹ï¼š </p><ul><li>æ™®é€šåœ°å€ï¼šå­˜å‚¨ 20 å­—èŠ‚çš„å€¼</li><li>payable addressï¼šå¤šäº† <code>addr.transfer</code> å’Œ <code>addr.send</code> ï¼Œå³å¯ä»¥è½¬è´¦ï¼ŒæŸ¥è¯¢ä½™é¢</li></ul><h3 id="4-å®šé•¿å­—èŠ‚æ•°ç»„"><a href="#4-å®šé•¿å­—èŠ‚æ•°ç»„" class="headerlink" title="4. å®šé•¿å­—èŠ‚æ•°ç»„"></a>4. å®šé•¿å­—èŠ‚æ•°ç»„</h3><p> æœ‰ <code>bytes1</code>ï¼Œ<code>bytes2</code>ï¼ŒÂ·Â·Â·ï¼Œ<code>bytes32</code></p><p><code>byteså‡ </code> å°±èƒ½å­˜å‡ å­—èŠ‚çš„æ•°æ®ï¼Œæœ€å¤šä¸º 32 å­—èŠ‚ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs solidity">bytes32 public example = &quot;It&#x27;sAnExample&quot;;<br>bytes1 public first = example[0];<br></code></pre></td></tr></table></figure><p>å¦‚ä¸Šï¼Œ<code>It&#39;sAnExample</code> ä»¥å­—èŠ‚çš„å½¢å¼å­˜å…¥å˜é‡ exampleï¼Œç”¨16è¿›åˆ¶è¡¨ç¤ºï¼ˆæ¯ä¸¤ä½å¯¹åº”ä¸€ä¸ªå­—ç¬¦çš„ ASCII ç å€¼ï¼‰ï¼Œå³ä¸º<code>0x49742773416e4578616d706c6500000000000000000000000000000000000000</code></p><p>å®šé•¿å­—èŠ‚æ•°ç»„ä¹Ÿæ˜¯æ•°ç»„ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç´¢å¼•è®¿é—®ï¼Œå¦‚ first çš„å€¼å°±æ˜¯ example å˜é‡çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ <code>0x49</code>ï¼Œå³ï¼š<code>I</code></p><p>å®šé•¿å­—èŠ‚æ•°ç»„å¯ä»¥é€šè¿‡ <code>&gt;</code>ï¼Œ<code>&gt;=</code>ï¼Œ<code>&lt;</code>ï¼Œ<code>&lt;=</code>ï¼Œ<code>!=</code>ï¼Œ<code>==</code> è¿›è¡Œæ¯”è¾ƒï¼Œè¿”å›ä¸€ä¸ª <code>bool</code>ï¼ˆç›¸å½“äº C é‡Œçš„ <code>strcmp</code>ï¼‰</p><h3 id="5-æšä¸¾-enum"><a href="#5-æšä¸¾-enum" class="headerlink" title="5. æšä¸¾ enum"></a>5. æšä¸¾ <code>enum</code></h3><p>åœ¨ä¸ç»™å®šæ•°å€¼çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä½ä»0å¼€å§‹ï¼Œ1ä¸ºæ­¥é•¿ï¼Œä¾æ¬¡ä¸ºåç»­åç§°èµ‹å€¼</p><h4 id="C-ä¸­çš„æšä¸¾"><a href="#C-ä¸­çš„æšä¸¾" class="headerlink" title="C ä¸­çš„æšä¸¾"></a>C ä¸­çš„æšä¸¾</h4><p>ä»¥æ˜ŸæœŸä¸ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">day</span> &#123;</span><br>    MON = <span class="hljs-number">1</span>, TUE, WED, THUR, FRI, SAT, SUN<br>&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;<br><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">day</span> <span class="hljs-title">date</span> =</span> TUE;<span class="hljs-comment">//è¿™é‡Œçš„ date = 2</span><br><span class="hljs-comment">/* å…¶ä»–ä»£ç çœç•¥ */</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç­‰ä»·äºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MON 1</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> TUE 2</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> WED 3</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> THUR 4</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> FRI 5</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SAT 6</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SUN 7</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;<br>    <span class="hljs-type">int</span> date = TUE;<br>    <span class="hljs-comment">/*å…¶ä»–ä»£ç çœç•¥*/</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åœ¨ä¸­é—´æ”¹å˜å€¼ï¼Œå¦‚ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">test</span> &#123;</span><br>    a, b, c = <span class="hljs-number">10</span>, d, e<br>&#125;;<br><span class="hljs-comment">// ç»“æœä¸º a = 0, b = 1, c = 10, d = 11, e = 12</span><br></code></pre></td></tr></table></figure><p>æšä¸¾ç±»å‹é»˜è®¤ä¸º <code>int</code> æˆ– <code>unsigned</code></p><h4 id="å›åˆ°-Solidity"><a href="#å›åˆ°-Solidity" class="headerlink" title="å›åˆ° Solidity"></a>å›åˆ° Solidity</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">//                0     1     2<br>enum ActionSet &#123; Buy, Hold, Sell &#125;;<br>ActionSet action = ActionSet.Buy;<br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±è®¾å®šäº†ä¸€ä¸ª <code>enum</code> ç±»å‹å˜é‡ actionã€‚</p><p>æ­¤æ—¶ï¼Œaction ä¸º <code>enum</code> ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾å¼åœ°å°†å…¶è½¬æ¢ä¸º <code>uint</code> ç±»å‹ï¼Œè½¬æ¢æ—¶ä¼šè‡ªåŠ¨æ£€æŸ¥å…¶æ˜¯å¦åœ¨æšä¸¾é•¿åº¦å†…ï¼Œä¸åœ¨çš„è¯ä¼šæŠ¥é”™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function enumToUint() external view returns(uint)&#123;<br>    return uint(action);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-å‡½æ•°"><a href="#3-å‡½æ•°" class="headerlink" title="3. å‡½æ•°"></a>3. å‡½æ•°</h2><ul><li>å½¢å¼ ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function &lt;function name&gt; (&lt;parameter types&gt;) &#123;internal|external|public|private&#125; [pure|view|payable] [returns (&lt;return types&gt;)]<br></code></pre></td></tr></table></figure><ol><li><code>function</code> å›ºå®šå¼€å¤´</li></ol><ol><li><code>&lt;function name&gt;</code> å‡½æ•°å</li></ol><ol><li><code>(&lt;parameter types&gt;)</code> å‚æ•°ï¼Œå³è¾“å…¥ç»™å‡½æ•°çš„ å˜é‡ç±»å‹å’Œåç§°</li></ol><p>ä»¥ä¸‹è¾ƒä¸ºä¸åŒï¼š</p><ol><li><p><code>&#123;internal|external|public|private&#125;</code> å‡½æ•°å¯è§æ€§è¯´æ˜ç¬¦ï¼Œ<strong>å¿…é¡»æœ‰</strong></p><p>è®¿é—®åœ°å€æœ‰ï¼šåˆçº¦å†…éƒ¨ï¼Œåˆçº¦å¤–éƒ¨ï¼ˆåŒ…å«å…¶ä»–åˆçº¦åŠéƒ¨ç½²æ ï¼‰ï¼Œç»§æ‰¿çš„åˆçº¦ï¼ˆè§14ç« ï¼‰</p><ul><li><p><code>public</code> åˆçº¦å†…éƒ¨ï¼Œåˆçº¦å¤–éƒ¨ï¼Œç»§æ‰¿çš„åˆçº¦</p></li><li><p><code>internal</code> åˆçº¦å†…éƒ¨ï¼Œç»§æ‰¿çš„åˆçº¦</p></li><li><code>external</code> åˆçº¦å¤–éƒ¨ï¼Œï¼ˆä½†åœ¨åˆçº¦å†…éƒ¨å¯ä»¥é€šè¿‡ <code>this.å‡½æ•°å</code> è°ƒç”¨ï¼‰</li><li><code>private</code> åˆçº¦å†…éƒ¨</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>internal|external|public|private</code> ä¹Ÿå¯ä¿®é¥° <strong>çŠ¶æ€å˜é‡</strong>ï¼Œè‹¥ä¸º <code>public</code> åˆ™ä¼šè‡ªåŠ¨å£°æ˜åŒå getter å‡½æ•°ç”¨äºæŸ¥å€¼ï¼Œä¸æ ‡æ˜å°±é»˜è®¤ä¸º <code>internal</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint public num;<br>// ç”Ÿæˆçš„ getter å‡½æ•°å¦‚ä¸‹ï¼š<br>function num() public view returns(num)&#123;&#125; <br></code></pre></td></tr></table></figure></li></ol><ol><li><p><code>[pure|view|payable]</code> å†³å®šå‡½æ•°æƒé™ / åŠŸèƒ½</p><ul><li><code>pure</code> å‡½æ•°ï¼šåªå¯ä»¥è¯»å–ã€æ”¹å˜å‡½æ•°çš„å‚æ•°ï¼Œå†…éƒ¨å£°æ˜å˜é‡ï¼Œæ— æ³•è¯»å–å‡½æ•°å¤–çš„çŠ¶æ€å˜é‡</li><li><code>view</code> å‡½æ•°ï¼šåœ¨ <code>pure</code> çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥è¯»å–å‡½æ•°å¤–çš„çŠ¶æ€å˜é‡</li><li><p>é»˜è®¤ï¼šåœ¨ <code>view</code> çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥æ”¹å˜å‡½æ•°å¤–çš„çŠ¶æ€å˜é‡</p></li><li><p><code>payable</code> å‡½æ•°ï¼šåœ¨é»˜è®¤çš„åŸºç¡€ä¸Šï¼Œä½¿åˆçº¦å¯ä»¥æ¥å— ETH</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.21;<br>contract  pureAndView &#123;<br>    uint public num; //uintåˆå§‹å€¼ä¸º0<br>    // pure ç±»å‹ï¼Œç‰›é©¬ä¸€ä¸ª, å¯ä»¥ä¼ å…¥å‚æ•°ï¼Œå¦‚ä¸‹è®¡ç®— x å’Œ y çš„å’Œ<br>    function add_pure(uint x, uint y) external pure returns(uint sum) &#123;<br>    sum = x + y;<br>    &#125;<br>   // view ç±»å‹ï¼Œå¯ä»¥è¯»å– numï¼Œå¦‚ä¸‹å°† num + 1 èµ‹ç»™ newNum<br>    function add_view() external view returns(uint newNum)&#123;<br>   newNum = num + 1ï¼›<br>   return newNum;<br>   &#125;<br>   //é»˜è®¤ï¼Œéšä¾¿å¹²å˜›ï¼Œè¦æ”¶è´¹<br>    function add_default() external &#123;<br>   num += 1;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><code>[returns (&lt;return types&gt;)]</code> è¿”å›çš„å˜é‡ç±»å‹ã€åç§°</p></li></ol><h3 id="pure-å’Œ-view-çš„ä½¿ç”¨åŸå› "><a href="#pure-å’Œ-view-çš„ä½¿ç”¨åŸå› " class="headerlink" title="pure å’Œ view çš„ä½¿ç”¨åŸå› "></a><code>pure</code> å’Œ <code>view</code> çš„ä½¿ç”¨åŸå› </h3><p>gas çš„æ¦‚å¿µï¼š</p><blockquote><p>åœ¨åˆ›å»ºæ—¶ï¼Œæ¯ä¸ªäº¤æ˜“éƒ½ä¼šè¢«æ”¶å–ä¸€å®šæ•°é‡çš„ gasï¼Œç”±äº¤æ˜“çš„å‘èµ·è€…ï¼ˆ<code>tx.origin</code>ï¼‰æ”¯ä»˜ã€‚ å½“ EVM æ‰§è¡Œäº¤æ˜“æ—¶ï¼Œ<strong>gas</strong> ä¼šæ ¹æ®ç‰¹å®šè§„åˆ™é€æ¸è€—å°½ã€‚ å¦‚æœåœ¨ä»»ä½•æ—¶å€™ gas ç”¨å°½ï¼ˆå³å˜ä¸ºè´Ÿæ•°ï¼‰ï¼Œåˆ™ä¼šè§¦å‘è¶…å‡º gas å¼‚å¸¸ï¼Œè¿™å°†ç»“æŸæ‰§è¡Œå¹¶æ’¤é”€å½“å‰è°ƒç”¨å¸§ä¸­å¯¹çŠ¶æ€æ‰€åšçš„æ‰€æœ‰ä¿®æ”¹ã€‚</p><p>è¯¥æœºåˆ¶æ¿€åŠ±ç»æµåœ°ä½¿ç”¨ EVM æ‰§è¡Œæ—¶é—´å¹¶è¡¥å¿ EVM æ‰§è¡Œè€…ï¼ˆå³çŸ¿å·¥/è´¨æŠ¼è€…ï¼‰çš„å·¥ä½œã€‚ ç”±äºæ¯ä¸ªåŒºå—æœ‰æœ€å¤§ <strong>gas</strong> é‡ï¼Œå®ƒè¿˜é™åˆ¶äº†éªŒè¯åŒºå—æ‰€éœ€çš„å·¥ä½œé‡ã€‚</p><p><strong>gasä»·æ ¼</strong> æ˜¯ç”±äº¤æ˜“çš„å‘èµ·è€…è®¾ç½®çš„å€¼ï¼Œå‘èµ·è€…å¿…é¡»æå‰å‘ EVM æ‰§è¡Œè€…æ”¯ä»˜ <code>gas_price * gas</code>ã€‚ å¦‚æœæ‰§è¡Œåè¿˜æœ‰ä¸€äº› <strong>gas</strong> å‰©ä½™ï¼Œåˆ™ä¼šé€€è¿˜ç»™äº¤æ˜“å‘èµ·è€…ã€‚ åœ¨æ’¤é”€æ›´æ”¹çš„å¼‚å¸¸æƒ…å†µä¸‹ï¼Œå·²ç»ä½¿ç”¨çš„ gas ä¸ä¼šé€€è¿˜ã€‚</p></blockquote><p>ç®€è€Œè¨€ä¹‹ï¼Œgas è´¹å¾ˆè´µï¼Œè€Œä¿®æ”¹é“¾ä¸ŠçŠ¶æ€å°±è¦ä»˜ gas è´¹ã€‚</p><p>ä»¥ä¸‹è¯­å¥è¢«è§†ä¸ºä¿®æ”¹çŠ¶æ€ï¼š</p><ol><li>å†™å…¥çŠ¶æ€å˜é‡ï¼ˆå­˜å‚¨å’Œä¸´æ—¶å­˜å‚¨ï¼‰ã€‚</li><li><a href="https://learnblockchain.cn/docs/solidity/contracts.html#events">å‘å‡ºäº‹ä»¶</a>ã€‚</li><li><a href="https://learnblockchain.cn/docs/solidity/control-structures.html#creating-contracts">åˆ›å»ºå…¶ä»–åˆçº¦</a>ã€‚</li><li>ä½¿ç”¨ <code>selfdestruct</code>ã€‚</li><li>é€šè¿‡è°ƒç”¨å‘é€ ETHã€‚</li><li>è°ƒç”¨ä»»ä½•æœªæ ‡è®°ä¸º <code>view</code> æˆ– <code>pure</code> çš„å‡½æ•°ã€‚</li><li>ä½¿ç”¨ä½çº§è°ƒç”¨ã€‚</li><li>ä½¿ç”¨åŒ…å«æŸäº›æ“ä½œç çš„å†…è”æ±‡ç¼–ã€‚</li></ol><h3 id="è¢«è§†ä¸ºè¯»å–çŠ¶æ€çš„æ“ä½œï¼ˆè‡³å°‘ç”¨-viewï¼‰"><a href="#è¢«è§†ä¸ºè¯»å–çŠ¶æ€çš„æ“ä½œï¼ˆè‡³å°‘ç”¨-viewï¼‰" class="headerlink" title="è¢«è§†ä¸ºè¯»å–çŠ¶æ€çš„æ“ä½œï¼ˆè‡³å°‘ç”¨ viewï¼‰"></a>è¢«è§†ä¸ºè¯»å–çŠ¶æ€çš„æ“ä½œï¼ˆè‡³å°‘ç”¨ <code>view</code>ï¼‰</h3><ol><li>ä»çŠ¶æ€å˜é‡ï¼ˆå­˜å‚¨å’Œä¸´æ—¶å­˜å‚¨ï¼‰è¯»å–ã€‚</li><li>è®¿é—® <code>address(this).balance</code> æˆ– <code>&lt;address&gt;.balance</code>ã€‚</li><li>è®¿é—® <code>block</code>ã€<code>tx</code>ã€<code>msg</code> çš„ä»»ä½•æˆå‘˜ï¼ˆ<code>msg.sig</code> å’Œ <code>msg.data</code> é™¤å¤–ï¼‰ã€‚</li><li>è°ƒç”¨ä»»ä½•æœªæ ‡è®°ä¸º <code>pure</code> çš„å‡½æ•°ã€‚</li><li>ä½¿ç”¨åŒ…å«æŸäº›æ“ä½œç çš„å†…è”æ±‡ç¼–ã€‚</li></ol><hr><h2 id="4-å‡½æ•°è¾“å‡º"><a href="#4-å‡½æ•°è¾“å‡º" class="headerlink" title="4. å‡½æ•°è¾“å‡º"></a>4. å‡½æ•°è¾“å‡º</h2><ul><li><p>è¿”å›å¤šä¸ªå›ºå®šå€¼ï¼Œ<code>returns</code> ä¸­åªéœ€å£°æ˜ç±»å‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function returnMul public pure returns(uint, bool, uint256[3] memory) &#123;<br>return(2, true, [uint256(1), 2, 3])<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å‘½ä»¤å¼è¿”å›ï¼šåœ¨  <code>returns</code> ä¸­è¾“å…¥å˜é‡åï¼Œä¼šè‡ªåŠ¨åˆå§‹åŒ–ï¼Œè‡ªåŠ¨è¾“å‡ºï¼Œ<code>return</code> å¯ä¸å†™ï¼Œ</p><p> è‹¥æœ‰ <code>return</code>ï¼Œåˆ™ä»¥ <code>return</code> ä¸­çš„å€¼ä¸ºå‡†ï¼Œä¸ºå˜é‡é‡æ–°èµ‹å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function returnTest() public pure returns(uint _num, bool _bool) &#123;<br>_num = 12;<br>_bool = true;<br>return (1, false);<br>&#125;// è¾“å‡º 1, false.<br></code></pre></td></tr></table></figure></li><li><p>è§£æ„å¼èµ‹å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint _num2;<br>bool _bool2;<br>(_num2, _bool2) = returnTest(); // ä»¥ returnTest ä¸­çš„è¿”å›å€¼ä¸ºå‡†ï¼Œä¸º _num2, _bool2 èµ‹å€¼<br>(, _bool2) = returnTest();// ä»…ä¸º _bool2èµ‹å€¼<br></code></pre></td></tr></table></figure></li></ul><h2 id="5-æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨"><a href="#5-æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨" class="headerlink" title="5. æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨"></a>5. æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨</h2><h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><p>æ„é€ å‡½æ•°ï¼ˆ<code>constructor</code>ï¼‰ï¼Œæ¯ä¸ªåˆçº¦å¯å®šä¹‰ä¸€ä¸ªï¼Œéƒ¨ç½²æ—¶è‡ªåŠ¨è¿è¡Œå‡½æ•°ï¼Œå¯ä»¥ç”¨äºåˆå§‹åŒ–å‚æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint id;<br>constructor(uint _init) &#123;<br>id = _init;<br>&#125;// éƒ¨ç½²æ—¶ï¼Œè‡ªåŠ¨å°† _init çš„å€¼èµ‹ç»™ id<br></code></pre></td></tr></table></figure><p>å¸¦æœ‰ <code>payable</code> çš„æ„é€ å‡½æ•°å¯åœ¨éƒ¨ç½²åˆçº¦çš„åŒæ—¶è½¬å…¥ ETHï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract contractName&#123;<br>constructor() payable&#123;&#125;<br>/* ä»¥ä¸‹ä¸ºå…·ä½“çš„åˆçº¦å†…å®¹ */<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>åœ¨ 0.5.0 å‰ï¼Œæ²¡æœ‰ <code>constructor</code> å…³é”®å­—ï¼Œä½¿ç”¨åˆçº¦åŒåçš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract old &#123;<br>uint sender;<br>function old(address _sender) public &#123;<br>sender = _sender;<br>&#125;<br>/* ä»¥ä¸‹ä¸ºåˆçº¦å†…å®¹ */<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="ä¿®é¥°å™¨"><a href="#ä¿®é¥°å™¨" class="headerlink" title="ä¿®é¥°å™¨"></a>ä¿®é¥°å™¨</h3><p>ä¿®é¥°å™¨ï¼ˆ<code>modifier</code>ï¼‰å£°æ˜å‡½æ•°æ‹¥æœ‰çš„ç‰¹æ€§ï¼Œä¸»è¦é€‚ç”¨åœºæ™¯ä¸ºè¿è¡Œå‡½æ•°å‰çš„æ£€æŸ¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs solidity">modifier isOwner &#123;<br>require (msg.sender == owner);<br>_;<br>&#125;<br>function changeName(string _name) external isOwner returns(string) &#123;<br>    name = _name;<br>    return (name);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¿®é¥°å™¨ä¹Ÿå¯ä»¥æœ‰å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs solidity">modifier isOwner(address who) &#123;<br>require (who == owner);<br>_;<br>&#125;<br>function changeOwner(address newOwner) public isOwner(who) returns(address) &#123;<br>owner = newOwner;<br>return (newOwner);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="6-å˜é‡æ•°æ®å­˜å‚¨å’Œä½œç”¨åŸŸ"><a href="#6-å˜é‡æ•°æ®å­˜å‚¨å’Œä½œç”¨åŸŸ" class="headerlink" title="6. å˜é‡æ•°æ®å­˜å‚¨å’Œä½œç”¨åŸŸ"></a>6. å˜é‡æ•°æ®å­˜å‚¨å’Œä½œç”¨åŸŸ</h2><h3 id="æ•°æ®ä½ç½®"><a href="#æ•°æ®ä½ç½®" class="headerlink" title="æ•°æ®ä½ç½®"></a>æ•°æ®ä½ç½®</h3><p>åˆ†ä¸º <code>storage</code>, <code>memory</code>å’Œ <code>calldata</code></p><ol><li><code>storage</code>: çŠ¶æ€å˜é‡é»˜è®¤ï¼Œå‚¨å­˜åœ¨é“¾ä¸Šï¼Œç±»ä¼¼äºç¡¬ç›˜ï¼Œè€— gas å¤š</li><li><code>memory</code>: ä¸´æ—¶å‚¨å­˜åœ¨å†…å­˜é‡Œï¼Œä¸ä¸Šé“¾ï¼Œä¸€èˆ¬ç”¨äºå‡½æ•°é‡Œçš„ <strong>å‚æ•°</strong> å’Œ <strong>ä¸´æ—¶å˜é‡</strong>ï¼Œå°¤å…¶æ˜¯å¦‚æœè¿”å›æ•°æ®ç±»å‹æ˜¯ <strong>å˜é•¿</strong> çš„æƒ…å†µä¸‹ï¼ˆstring, array, bytes, è‡ªå®šä¹‰ç»“æ„ï¼‰ï¼ˆç†è§£ä¸ºç±»ä¼¼äºåŠ¨æ€æ•°ç»„å­˜å…¥äº†æ–°å…ƒç´ å¯¼è‡´å˜é•¿ï¼‰</li><li><code>calldata</code>: ç±»ä¼¼äº <code>memory</code>, ä¸åŒç‚¹åœ¨äº <code>calldata</code> ä¸èƒ½ä¿®æ”¹ï¼Œä¸€èˆ¬ç”¨äºå‡½æ•°çš„å‚æ•°</li></ol><h3 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h3><p>åŒ…å«æ•°ç»„ï¼ˆ<code>array</code>ï¼‰å’Œç»“æ„ä½“ï¼ˆ<code>struct</code>ï¼‰ï¼Œç”±äºå¤æ‚ä¸”å ç”¨ç©ºé—´å¤§ï¼Œä½¿ç”¨æ—¶å¿…é¡»å£°æ˜å‚¨å­˜ä½ç½®</p><h4 id="1-æ•°ç»„-array"><a href="#1-æ•°ç»„-array" class="headerlink" title="1. æ•°ç»„ array"></a>1. æ•°ç»„ array</h4><p>ç”¨æ¥å‚¨å­˜ä¸€ç»„åŒç±»å‹æ•°æ®ï¼Œåˆ†ä¸º å›ºå®šé•¿åº¦æ•°ç»„ å’Œ å¯å˜é•¿åº¦æ•°ç»„ ä¸¤ç§ã€‚</p><ul><li><p>å›ºå®šé•¿åº¦æ•°ç»„ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint8[200] arr1;<br>bytes1[27] arr2;<br>address[4] arr3;<br></code></pre></td></tr></table></figure></li><li><p>å¯å˜é•¿åº¦æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„ï¼‰ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint8[] arr4;<br>bytes1[] arr5;<br>address[] arr6;<br>bytes arr7;//ä¸ arr5 ç›¸å½“<br></code></pre></td></tr></table></figure><ul><li>æ³¨ï¼š <code>bytes</code>  æ˜¯æ•°ç»„ï¼Œä½†ä¸åŠ  <code>[]</code>ï¼Œä¸èƒ½ç”¨ <code>byte[]</code> å£°æ˜å•å­—èŠ‚æ•°ç»„ï¼Œå¯ä»¥ç”¨ <code>bytes</code> æˆ– <code>bytes1[]</code>ã€‚å…¶ä¸­ï¼Œ<code>bytes</code> æ›´çœ gasã€‚</li></ul></li></ul><h5 id="åˆ›å»ºæ•°ç»„çš„è§„åˆ™"><a href="#åˆ›å»ºæ•°ç»„çš„è§„åˆ™" class="headerlink" title="åˆ›å»ºæ•°ç»„çš„è§„åˆ™"></a>åˆ›å»ºæ•°ç»„çš„è§„åˆ™</h5><ul><li><p>å¯¹ <code>memory</code> ä¿®é¥°çš„ <strong>åŠ¨æ€æ•°ç»„</strong> ï¼Œç”¨ new åˆ›å»ºï¼Œä¸”å£°æ˜åé•¿åº¦ä¸èƒ½æ”¹å˜: </p><p><code>uint[] memory arr8 = new uint[](2);</code></p></li><li><p>åˆå§‹åŒ–æ•°ç»„ï¼Œç”¨ <code>[]</code>ï¼Œç±»å‹ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå‡†ï¼ŒæœªæŒ‡å®šé»˜è®¤ä¸ºç¬¦åˆæ¡ä»¶çš„æœ€å°å•ä½ï¼š</p><p><code>uint[5] arr4 = [1, 2, 3, 4, 5];</code> é»˜è®¤ä¸ºuint8 ç±»å‹</p><p><code>uint[5] arr5 = [uint256(1), 2, ,3 ,4, 5];</code> æŒ‡å®šä¸º uint256 ç±»å‹</p><p>åŠ¨æ€æ•°ç»„è¦ä¸€ä¸ªä¸€ä¸ªèµ‹å€¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">arr8[0] = 0;<br>arr8[1] = 1;<br>arr8[2] = 2;<br></code></pre></td></tr></table></figure></li></ul><h5 id="æ•°ç»„æˆå‘˜"><a href="#æ•°ç»„æˆå‘˜" class="headerlink" title="æ•°ç»„æˆå‘˜"></a>æ•°ç»„æˆå‘˜</h5><p>ç”¨ <code>arr</code> ä»£æ›¿æ•°ç»„çš„å˜é‡å</p><ul><li><code>arr.length</code>: æ•°ç»„çš„å…ƒç´ æ•°é‡</li><li>ä»¥ä¸‹ä¸º <em>åŠ¨æ€æ•°ç»„</em> ä¸“å±<ul><li><code>arr.push(x)</code>: åœ¨æ•°ç»„æœ€åæ·»åŠ ä¸€ä¸ª <code>x</code> å…ƒç´ ï¼Œä¸æŒ‡å®š <code>x</code> é»˜è®¤ä¸º <code>0</code></li><li><code>arr.pop();</code>: ç§»é™¤æœ€åä¸€ä¸ªå…ƒç´ </li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract arrayTest &#123;<br>uint[] a1;<br>function arrTest () public returns(uint[] memory)&#123;<br>        uint[2] memory a = [uint(1),2];<br>        a1 = a;<br>        a1.push();<br>        return (a1);  <br>    &#125;<br>&#125;// a1 = [1, 2, 0]<br></code></pre></td></tr></table></figure><h4 id="2-ç»“æ„ä½“-struct"><a href="#2-ç»“æ„ä½“-struct" class="headerlink" title="2. ç»“æ„ä½“ struct"></a>2. ç»“æ„ä½“ struct</h4><p>å¤§è‡´ä¸ C ç›¸åŒ</p><h5 id="åˆ›å»ºç»“æ„ä½“"><a href="#åˆ›å»ºç»“æ„ä½“" class="headerlink" title="åˆ›å»ºç»“æ„ä½“"></a>åˆ›å»ºç»“æ„ä½“</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">struct Student &#123;// åˆ›å»ºç»“æ„ä½“<br>uint id;<br>string name;<br>uint score;<br>&#125;<br><br>Student stuA;// åˆå§‹åŒ– stuA<br></code></pre></td></tr></table></figure><h5 id="ç»™ç»“æ„ä½“èµ‹å€¼"><a href="#ç»™ç»“æ„ä½“èµ‹å€¼" class="headerlink" title="ç»™ç»“æ„ä½“èµ‹å€¼"></a>ç»™ç»“æ„ä½“èµ‹å€¼</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// æ³•1ï¼šåˆ›å»ºä¸€ä¸ª storage çš„ struct å¼•ç”¨<br>function way1() external &#123;<br>Student storage _stu = stuA;<br>_stu.id = 22;<br>_stu.name = &quot;victifa&quot;;<br>_stu.score = 100;<br>&#125;   // _stu å’Œ stuA å‡ä¸ºä¸Šè¿°å€¼<br><br>// æ³•2ï¼šç›´æ¥å¼•ç”¨çŠ¶æ€å˜é‡çš„ struct<br>function way2() external&#123;<br>    stuA.id = 23;<br>    stuA.name = &quot;victini&quot;;<br>    stuA.score = 101;<br>&#125;<br><br>// æ³•3ï¼šæ„é€ å‡½æ•°å¼<br>function way3() external &#123;<br>stuA = Student(24, &quot;tifa&quot;, 102);<br>&#125;<br><br>// æ³•4ï¼škey-value <br>function way4() external&#123;<br>stuA = Student(&#123;id: 25, name: &quot;tmp&quot;, score: 103&#125;);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å˜é‡çš„ä½œç”¨åŸŸ"><a href="#å˜é‡çš„ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡çš„ä½œç”¨åŸŸ"></a>å˜é‡çš„ä½œç”¨åŸŸ</h3><p>åˆ†ä¸º 3 ç§ï¼Œåˆ†åˆ«æ˜¯ çŠ¶æ€å˜é‡ï¼Œå±€éƒ¨å˜é‡ï¼Œå…¨å±€å˜é‡ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract contractName &#123;<br>// åœ¨è¿™é‡Œçš„éƒ½æ˜¯çŠ¶æ€å˜é‡<br><br>function 1 Â·Â·Â· &#123;<br>// åœ¨è¿™é‡Œçš„éƒ½æ˜¯å±€éƒ¨å˜é‡<br>&#125;<br><br>// åœ¨è¿™é‡Œçš„éƒ½æ˜¯çŠ¶æ€å˜é‡<br><br>function 2 Â·Â·Â· &#123;<br>// åœ¨è¿™é‡Œçš„éƒ½æ˜¯å±€éƒ¨å˜é‡<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="1-çŠ¶æ€å˜é‡"><a href="#1-çŠ¶æ€å˜é‡" class="headerlink" title="1. çŠ¶æ€å˜é‡"></a>1. çŠ¶æ€å˜é‡</h4><p>å­˜åœ¨é“¾ä¸Šï¼Œæ‰€æœ‰åˆçº¦å†…å‡½æ•°å‡å¯è®¿é—®ï¼Œè€— gas å¤šï¼Œåœ¨åˆçº¦å†…ã€å‡½æ•°å¤–å£°æ˜ï¼Œå¯ä»¥åœ¨å‡½æ•°é‡Œæ›´æ”¹å€¼</p><h4 id="2-å±€éƒ¨å˜é‡"><a href="#2-å±€éƒ¨å˜é‡" class="headerlink" title="2. å±€éƒ¨å˜é‡"></a>2. å±€éƒ¨å˜é‡</h4><p>ä»…åœ¨å‡½æ•°ä¸­æœ‰æ•ˆçš„å˜é‡ï¼Œå­˜åœ¨å†…å­˜é‡Œï¼Œä¸ä¸Šé“¾ï¼Œgas ä½</p><h4 id="3-å…¨å±€å˜é‡"><a href="#3-å…¨å±€å˜é‡" class="headerlink" title="3. å…¨å±€å˜é‡"></a>3. å…¨å±€å˜é‡</h4><p>éƒ½æ˜¯ solidity é¢„ç•™å…³é”®å­—ï¼Œä¸ç”¨å£°æ˜ï¼Œåœ¨å‡½æ•°å†…ç›´æ¥ç”¨ï¼Œå…·ä½“çœ‹ <a href="https://learnblockchain.cn/docs/solidity/units-and-global-variables.html#special-variables-and-functions">å®˜æ–¹æ–‡æ¡£</a>ï¼Œå¸¸ç”¨çš„æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š</p><ul><li><code>blockhash(uint blockNumber) returns (bytes32)</code>ï¼šç»™å®šåŒºå—çš„å“ˆå¸Œï¼Œå½“ <code>blocknumber</code> æ˜¯æœ€è¿‘ 256 ä¸ªåŒºå—ä¹‹ä¸€æ—¶ï¼›å¦åˆ™è¿”å›é›¶</li><li><code>block.number</code> (<code>uint</code>)ï¼šå½“å‰åŒºå—ç¼–å·</li><li><code>block.timestamp</code> (<code>uint</code>)ï¼šå½“å‰åŒºå—çš„æ—¶é—´æˆ³ï¼Œä»¥è‡ª Unix çºªå…ƒä»¥æ¥çš„ç§’æ•°è¡¨ç¤º</li><li><code>msg.data</code> (<code>bytes calldata</code>)ï¼šå®Œæ•´çš„ calldata</li><li><code>msg.sender</code> (<code>address</code>)ï¼šæ¶ˆæ¯çš„å‘é€è€…ï¼ˆå½“å‰è°ƒç”¨ï¼‰</li><li><code>msg.sig</code> (<code>bytes4</code>)ï¼šcalldata çš„å‰å››ä¸ªå­—èŠ‚ï¼ˆå³å‡½æ•°æ ‡è¯†ç¬¦ï¼‰</li><li><code>msg.value</code> (<code>uint</code>)ï¼šä¸æ¶ˆæ¯ä¸€èµ·å‘é€çš„ wei æ•°é‡</li><li><code>tx.origin</code> (<code>address</code>)ï¼šäº¤æ˜“çš„å‘é€è€…ï¼ˆå®Œæ•´è°ƒç”¨é“¾ï¼‰</li></ul><h5 id="ä»¥å¤ªå•ä½"><a href="#ä»¥å¤ªå•ä½" class="headerlink" title="ä»¥å¤ªå•ä½"></a>ä»¥å¤ªå•ä½</h5><p>ç”±äºä¸å­˜åœ¨å°æ•°ç‚¹ï¼Œç”¨ 0 ä»£æ›¿ï¼Œä½¿ç”¨ä»¥å¤ªå•ä½é˜²æ­¢ç²¾åº¦æŸå¤±ï¼Œå¤„ç†è´§å¸äº¤æ˜“</p><ul><li><code>wei</code>: 1</li><li><code>gwei</code>: 1e9</li><li><code>ether</code>: 1e18</li></ul><h5 id="æ—¶é—´å•ä½"><a href="#æ—¶é—´å•ä½" class="headerlink" title="æ—¶é—´å•ä½"></a>æ—¶é—´å•ä½</h5><ul><li><code>seconds</code>: 1</li><li><code>minutes</code>: 60 seconds = 60</li><li><code>hours</code>: 60 minutes  = 3600</li><li><code>days</code>: 24 hours = 86400</li><li><code>weeks</code>: 7days = 604800</li></ul><h4 id="4-ç¤ºä¾‹"><a href="#4-ç¤ºä¾‹" class="headerlink" title="4. ç¤ºä¾‹"></a>4. ç¤ºä¾‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract variables &#123;<br><br>uint x = 1;    // çŠ¶æ€å˜é‡1<br><br>function stateAndLocal () public &#123;<br>uint y = 2;// å±€éƒ¨å˜é‡<br>x = 10;    // å‡½æ•°å†…æ”¹å˜çŠ¶æ€å˜é‡1<br>&#125;<br>uint y;        // çŠ¶æ€å˜é‡2<br><br>function Global () public returns(uint,uint)&#123;<br>        address sender = msg.sender; // å…¨å±€å˜é‡ï¼Œè·å–æ¶ˆæ¯å‘é€è€…ï¼ˆå½“å‰è°ƒç”¨ï¼‰çš„åœ°å€<br>        uint blockNum = block.number; // å…¨å±€å˜é‡ï¼Œè·å–å½“å‰åŒºå—çš„ numberï¼ˆåŒºå—é«˜åº¦ï¼‰<br>        bytes memory data = msg.data; // å…¨å±€å˜é‡ï¼Œè¯·æ±‚æ•°æ®<br>        assert(1 ether == 1e18);<br>        assert(1 hours == 3600);<br>        return (1 ether,1 hours)<br>     &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™"><a href="#æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™" class="headerlink" title="æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™"></a>æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™</h3><p>åœ¨ä¸åŒå­˜å‚¨ç±»å‹ç›¸äº’èµ‹å€¼æ—¶å€™ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿç‹¬ç«‹çš„å‰¯æœ¬ï¼ˆä¿®æ”¹æ–°å˜é‡ä¸ä¼šå½±å“åŸå˜é‡ï¼‰ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿå¼•ç”¨ï¼ˆä¿®æ”¹æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ï¼‰ã€‚è§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li><p>å˜åŒ–ä¼šè¢«åŒæ­¥çš„ï¼ˆæœ¬è´¨ä¸Š <strong>åˆ›å»ºå¼•ç”¨æŒ‡å‘æœ¬ä½“</strong>ï¼‰ï¼š</p><ol><li><strong>çŠ¶æ€å˜é‡</strong> <code>storage</code> èµ‹å€¼ç»™ <strong>å‡½æ•°é‡Œçš„</strong> <code>storage</code> æ—¶</li><li><code>memory</code> èµ‹å€¼ç»™ <code>memory</code></li></ol></li><li><p>å…¶ä»–æƒ…å†µä¸‹ï¼Œåˆ›å»ºçš„æ˜¯æœ¬ä½“çš„ <strong>å‰¯æœ¬</strong>ï¼Œå˜åŒ–ä¸åŒæ­¥</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint[] x = [1,2,3]; // é»˜è®¤ä¸º storage<br><br>function change() public &#123;<br>uint[] storage y = x;<br>y[0] = 123; // æ­¤æ—¶ x[0] = 123<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="7-æ˜ å°„ç±»å‹"><a href="#7-æ˜ å°„ç±»å‹" class="headerlink" title="7. æ˜ å°„ç±»å‹"></a>7. æ˜ å°„ç±»å‹</h2><h3 id="ä»€ä¹ˆæ˜¯æ˜ å°„ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ˜ å°„ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ˜ å°„ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ˜ å°„ï¼Ÿ</h3><p>é€šè¿‡é”®ï¼ˆkeyï¼‰æ¥æŸ¥æ‰¾å€¼ï¼ˆvalueï¼‰ï¼Œå£°æ˜æ ¼å¼ä¸º <code>mapping(_KeyType =&gt; _ValueType)</code> ï¼Œä¾‹å¦‚ï¼š</p><p><code>mapping(uint =&gt; address) public idToAddress;    // ç”± id æ˜ å°„åˆ° åœ°å€</code> </p><p><code>mapping(uint =&gt; uint) public idToScore;        // ç”± id æ˜ å°„åˆ° æˆç»©</code>                    </p><h3 id="æ˜ å°„çš„è§„åˆ™"><a href="#æ˜ å°„çš„è§„åˆ™" class="headerlink" title="æ˜ å°„çš„è§„åˆ™"></a>æ˜ å°„çš„è§„åˆ™</h3><ol><li><p><code>_KeyType</code> åªèƒ½æ˜¯å†…ç½®ç±»å‹ï¼Œ<code>_ValueType</code> æ‰å¯ä»¥ç”¨è‡ªå®šä¹‰çš„ç»“æ„ä½“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">struct Student &#123;// åˆ›å»ºç»“æ„ä½“<br>string name;<br>uint score;<br>&#125;<br>mapping (Student =&gt; uint) public test1; // æŠ¥é”™ï¼Œkeyä¸å¯ä»¥ç”¨è‡ªå®šä¹‰ç±»å‹<br>mapping (uint =&gt; Student) public test1;// æ²¡æ¯›ç—…<br></code></pre></td></tr></table></figure></li><li><p>å­˜å‚¨ä½ç½®å¿…é¡»æ˜¯ <code>storage</code> ï¼Œå› æ­¤å¯ç”¨äºçŠ¶æ€å˜é‡ï¼Œå‡½æ•°ä¸­çš„ <code>storge</code> å˜é‡å’Œ libraryå‡½æ•°çš„å‚æ•°ã€‚ä¸èƒ½ç”¨äº <code>public</code> å‡½æ•°çš„å‚æ•°æˆ–è¿”å›ï¼ˆmapping è®°å½•çš„æ˜¯<strong>é”®å€¼å¯¹å…³ç³»</strong>ï¼‰</p></li><li><p>è‹¥å£°æ˜ä¸º <code>public</code> ï¼Œä¼šè‡ªåŠ¨åˆ›å»º <code>getter</code>å‡½æ•°ï¼Œé€šè¿‡ key æŸ¥ value</p></li><li><p>ç»™æ˜ å°„æ–°å¢é”®å€¼å¯¹çš„è¯­æ³• <code>_Var[_Key] = Value</code>ï¼Œä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function newMapping(uint _Key, uint _Value) public &#123;<br>idToScore[_Key] = _Value;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h3 id="æ˜ å°„çš„åŸç†"><a href="#æ˜ å°„çš„åŸç†" class="headerlink" title="æ˜ å°„çš„åŸç†"></a>æ˜ å°„çš„åŸç†</h3><ul><li><strong>åŸç†1</strong>: æ˜ å°„ä¸å‚¨å­˜ä»»ä½•é”®ï¼ˆ<code>Key</code>ï¼‰çš„èµ„è®¯ï¼Œä¹Ÿæ²¡æœ‰lengthçš„èµ„è®¯ã€‚</li><li><strong>åŸç†2</strong>: æ˜ å°„ä½¿ç”¨<code>keccak256(abi.encodePacked(key, slot))</code>å½“æˆ offset å­˜å– valueï¼Œå…¶ä¸­ <code>slot</code> æ˜¯æ˜ å°„å˜é‡å®šä¹‰æ‰€åœ¨çš„æ’æ§½ä½ç½®ã€‚</li><li><p><strong>åŸç†3</strong>: æœªèµ‹å€¼ï¼ˆ<code>Value</code>ï¼‰çš„é”®ï¼ˆ<code>Key</code>ï¼‰åˆå§‹å€¼éƒ½æ˜¯å„ä¸ªtypeçš„é»˜è®¤å€¼ï¼Œå¦‚ uint çš„é»˜è®¤å€¼æ˜¯0ã€‚ï¼ˆæ€»ç®—æœ‰å¥äººè¯äº†ï¼‰</p></li><li><p>çœ‹ä¸æ‡‚</p></li></ul><h2 id="8-å˜é‡åˆå§‹å€¼"><a href="#8-å˜é‡åˆå§‹å€¼" class="headerlink" title="8. å˜é‡åˆå§‹å€¼"></a>8. å˜é‡åˆå§‹å€¼</h2><h3 id="å€¼ç±»å‹"><a href="#å€¼ç±»å‹" class="headerlink" title="å€¼ç±»å‹"></a>å€¼ç±»å‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs solidity">boolfalse<br>string&quot;&quot;<br>int0<br>uint0<br>enumæšä¸¾ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ <br>address0x00Â·Â·Â·(40ä¸ª0) æˆ– address(0)<br>bytes1          0x00<br>function<br>-internalç©ºç™½å‡½æ•°<br>-externalç©ºç™½å‡½æ•°<br></code></pre></td></tr></table></figure><h3 id="å¼•ç”¨ç±»å‹-1"><a href="#å¼•ç”¨ç±»å‹-1" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h3><ul><li>æ˜ å°„ <code>mapping</code>: æ‰€æœ‰å…ƒç´ ä¸ºé»˜è®¤å€¼</li><li>ç»“æ„ä½“ <code>struct</code>: æ‰€æœ‰æˆå‘˜ä¸ºé»˜è®¤å€¼</li><li>æ•°ç»„ <code>array</code><ul><li>é™æ€æ•°ç»„ï¼ˆå®šé•¿ï¼‰: æ‰€æœ‰æˆå‘˜ä¸ºé»˜è®¤å€¼</li><li>åŠ¨æ€æ•°ç»„: <code>[]</code></li></ul></li></ul><h3 id="delete-æ“ä½œç¬¦"><a href="#delete-æ“ä½œç¬¦" class="headerlink" title="delete æ“ä½œç¬¦"></a><code>delete</code> æ“ä½œç¬¦</h3><p><code>delete a</code> ä½¿ <code>a</code> å˜ä¸ºåˆå§‹å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">bool _bool = true;<br>function test() external &#123;<br>delete _bool;// _bool å˜ä¸ºé»˜è®¤å€¼ false<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-å¸¸æ•°"><a href="#9-å¸¸æ•°" class="headerlink" title="9. å¸¸æ•°"></a>9. å¸¸æ•°</h2><p>å’Œå¸¸é‡ç›¸å…³çš„å…³é”®å­— <code>constant</code>ï¼ˆå¸¸é‡ï¼‰å’Œ <code>immutable</code>ï¼ˆä¸å˜é‡ï¼‰ã€‚å¥½å¤„æ˜¯çœ gasã€‚</p><p>åªæœ‰ <em>æ•°å€¼å˜é‡</em> å¯ä»¥å£°æ˜ <code>constant</code> å’Œ <code>immutable</code>ï¼Œ<code>string</code> å’Œ <code>bytes</code> å¯ä»¥æ˜¯ <code>constant</code>ï¼Œä¸èƒ½æ˜¯ <code>immutable</code>ã€‚</p><p> <code>constant</code> å’Œ <code>immutable</code> å˜é‡åœ¨åˆå§‹åŒ–åæ”¹å˜å€¼å‡ä¼šæŠ¥é”™ã€‚</p><h3 id="constant"><a href="#constant" class="headerlink" title="constant"></a>constant</h3><p><code>constant</code> å˜é‡å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ï¼Œä¸å¯æ›´æ”¹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint constant constNum = 123;<br>string constant constStr = &quot;victifa&quot;;<br>bytes constant constBytes = &quot;whatIsBytes&quot;;<br>address constant constAdd = 0x0000000000000000000000000000000000000000;<br>constNum = 12;// constant ä¸å¯æ”¹å˜ï¼ŒæŠ¥é”™<br></code></pre></td></tr></table></figure><h3 id="immutable"><a href="#immutable" class="headerlink" title="immutable"></a>immutable</h3><p><code>immutable</code> å¯ä»¥åœ¨å£°æ˜æˆ–æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œåœ¨ <code>Solidity ^8.0.21</code> åå¯ä»¥ä¸æ˜¾å¼åˆå§‹åŒ–ã€‚è‹¥åœ¨å£°æ˜å’Œæ„é€ å‡½æ•°ä¸­å‡åˆå§‹åŒ–ï¼Œä»¥æ„é€ å‡½æ•°ä¸ºå‡†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint immutable imNum = 123;<br>uint immutable imNum2;<br>constructor()&#123;<br>imNUm = 199;<br>imNum2 = 200;<br>&#125;// imNum = 199, imNum2 = 200<br></code></pre></td></tr></table></figure><h2 id="10-æ§åˆ¶æµ"><a href="#10-æ§åˆ¶æµ" class="headerlink" title="10. æ§åˆ¶æµ"></a>10. æ§åˆ¶æµ</h2><p>ä¸å…¶ä»–è¯­è¨€ç›¸ä¼¼ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ol><li><code>if-else</code></li><li><code>forå¾ªç¯</code></li><li><code>whileå¾ªç¯</code></li><li><code>do-whileå¾ªç¯</code></li><li>ä¸‰å…ƒè¿ç®—ç¬¦ <code>a?x:y;</code></li></ol><p>ä¾‹ï¼šå†’æ³¡æ’åº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.21;<br>contract sort &#123;<br>    function bubbleSort(uint[] memory arr) external pure returns(uint[] memory)&#123;<br>        uint tmp = 0;<br>        bool flag;<br>        for (uint i = 0; i &lt;= arr.length - 1; i++ ) &#123; <br>            flag = false;<br>            for (uint j = 0; j &lt; (arr.length - 1) - i; j++) &#123;<br>            // æ­¤å¤„å†™ j &lt;= arr.length-2-i ä¼šæŠ¥é”™ï¼Œå› ä¸ºå½“ i å–åˆ° arr.length-1 æ—¶ï¼Œj ä¸º -1ï¼Œä¸æ»¡è¶³ uint ç±»å‹<br>                    if (arr[j] &gt; arr[j+1]) &#123;<br>                        tmp = arr[j];<br>                        arr[j] = arr[j + 1];<br>                        arr[j + 1] = tmp;<br>                        flag = true;<br>                    &#125;<br>            &#125;<br>            if (!flag) &#123;<br>                break;<br>            &#125;<br><br>        &#125;<br>        return (arr);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="11-äº‹ä»¶"><a href="#11-äº‹ä»¶" class="headerlink" title="11. äº‹ä»¶"></a>11. äº‹ä»¶</h2><p>äº‹ä»¶æ˜¯ EVM ä¸Šæ—¥å¿—çš„æŠ½è±¡ï¼Œæœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p><ul><li>å“åº”ï¼šåº”ç”¨ç¨‹åºï¼ˆ<a href="https://learnblockchain.cn/docs/ethers.js/api-contract.html#id18"><code>ethers.js</code></a>ï¼‰å¯ä»¥é€šè¿‡<code>RPC</code>æ¥å£è®¢é˜…å’Œç›‘å¬è¿™äº›äº‹ä»¶ï¼Œå¹¶åœ¨å‰ç«¯åšå“åº”ã€‚</li><li>ç»æµï¼šä¾¿å®œï¼Œè€— gas å°‘</li></ul><h3 id="å£°æ˜äº‹ä»¶"><a href="#å£°æ˜äº‹ä»¶" class="headerlink" title="å£°æ˜äº‹ä»¶"></a>å£°æ˜äº‹ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs solidity">event Transfer(address indexed from, address indexed to, uint value);<br></code></pre></td></tr></table></figure><p>å¦‚ä¸Šäº‹ä»¶è®°å½•äº†3ä¸ªå˜é‡ï¼Œå…¶ä¸­ <code>from</code> å’Œ <code>to</code> å‰æœ‰ <code>indexed</code> å…³é”®å­—ï¼Œä¼šä¿å­˜åœ¨ <code>topics</code> ä¸­ï¼Œæ–¹ä¾¿æ£€ç´¢ã€‚</p><h3 id="é‡Šæ”¾äº‹ä»¶"><a href="#é‡Šæ”¾äº‹ä»¶" class="headerlink" title="é‡Šæ”¾äº‹ä»¶"></a>é‡Šæ”¾äº‹ä»¶</h3><p>ä½¿ç”¨ <code>emit</code> å¯ä»¥é‡Šæ”¾äº‹ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs solidity">mapping (address =&gt; uint) public addrToNum;<br>function trans(<br>    address from,<br>    address to,<br>    uint value<br>) external &#123;<br>    addrToNum[from] = 100;// fromåˆå§‹æœ‰100å—<br>    addrToNum[from] -= value;// ç»™ from æ‰£é’±<br>    addrToNum[to] += value;// ç»™ to åŠ ä¸Šç­‰é‡ä»fromå¤„æ‰£çš„é’±<br>    emit Transfer(from, to, value);// é‡Šæ”¾äº‹ä»¶ï¼Œäº§ç”Ÿä¸€æ¡ log<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="EVM-æ—¥å¿—"><a href="#EVM-æ—¥å¿—" class="headerlink" title="EVM æ—¥å¿—"></a>EVM æ—¥å¿—</h3><p>EVM ç”¨ log å­˜å‚¨äº‹ä»¶ï¼Œæ¯æ¡æ—¥å¿—åŒ…æ‹¬ä¸»é¢˜ <code>topics</code> å’Œæ•°æ® <code>data</code></p><h4 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h4><ul><li>æ—¥å¿—ç¬¬ä¸€éƒ¨åˆ†ä¸ºé•¿åº¦ä¸å¤§äº 4 çš„ä¸»é¢˜æ•°ç»„ï¼Œç¬¬ 1 ä¸ªå…ƒç´ æ˜¯äº‹ä»¶çš„ç­¾åï¼ˆå“ˆå¸Œï¼‰</li><li>ç¬¬äºŒéƒ¨åˆ†ä¸º <code>indexed</code> æ ‡è®°çš„å‚æ•°ï¼ˆå¯ä»¥ç†è§£ä¸ºæ£€ç´¢äº‹ä»¶çš„ç´¢å¼•â€œé”®â€ï¼‰ï¼Œè‹¥å‚æ•°å¤ªå¤§ï¼Œä¼šè‡ªåŠ¨è®¡ç®—å“ˆå¸Œå‚¨å­˜</li></ul><h4 id="æ•°æ®"><a href="#æ•°æ®" class="headerlink" title="æ•°æ®"></a>æ•°æ®</h4><ul><li>ä¸å¸¦ <code>indexed</code> ä¼šè¢«å­˜åœ¨æ•°æ® <code>data</code> ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºäº‹ä»¶çš„â€œå€¼â€</li><li>ä¸èƒ½è¢«æ£€ç´¢ï¼Œä½†å¤§å°éšæ„ â€”&gt; å‚¨å­˜å¤æ‚æ•°æ®ç»“æ„</li><li>è€— gas æ¯” ä¸»é¢˜ <code>topics</code> å°‘</li></ul><h2 id="12-æŠ½è±¡åˆçº¦å’Œæ¥å£"><a href="#12-æŠ½è±¡åˆçº¦å’Œæ¥å£" class="headerlink" title="12. æŠ½è±¡åˆçº¦å’Œæ¥å£"></a>12. æŠ½è±¡åˆçº¦å’Œæ¥å£</h2><h3 id="æŠ½è±¡åˆçº¦"><a href="#æŠ½è±¡åˆçº¦" class="headerlink" title="æŠ½è±¡åˆçº¦"></a>æŠ½è±¡åˆçº¦</h3><p>è‹¥åˆçº¦ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæœªå®ç°çš„å‡½æ•°ï¼ˆå³å‡½æ•°ç¼ºå°‘ä¸»ä½“<code>&#123;&#125;</code>ä¸­çš„å†…å®¹ï¼‰ï¼Œå¿…é¡»å°†å®ƒæ ‡ä¸º <code>abstract</code> ï¼Œå¹¶ä¸ºä¸ºå®ç°çš„å‡½æ•°æ ‡ä¸Š <code>virtual</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs solidity">abstract contract bubbleSort &#123;<br>function a(uint _a) public pure returns(uint) &#123;<br>return (_a);<br>&#125;<br><br>function sort(uint[] memory _arr) external pure virtual returns(uint[] memory);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><ul><li><p>ç±»ä¼¼æŠ½è±¡åˆçº¦ï¼Œä½†ä¸å®ç°ä»»ä½•åŠŸèƒ½ã€‚è§„åˆ™ï¼š</p><ol><li>ä¸èƒ½æœ‰ <mark>çŠ¶æ€å˜é‡ï¼Œä¿®é¥°å™¨</mark></li><li>ä¸èƒ½æœ‰ <mark>æ„é€ å‡½æ•°</mark> </li><li>ä¸èƒ½ç»§æ‰¿æ¥å£å¤–çš„å…¶ä»–å‡½æ•°</li><li>æ¥å£ä¸­å£°æ˜çš„å‡½æ•° <strong>å¿…é¡»</strong> æ˜¯ <code>external</code>ç±»å‹ï¼Œä¸”ä¸èƒ½æœ‰å‡½æ•°ä½“</li><li>ç»§æ‰¿æ¥å£çš„éæŠ½è±¡åˆçº¦ <strong>å¿…é¡»</strong> å®ç°æ¥å£çš„==æ‰€æœ‰åŠŸèƒ½==</li></ol></li></ul><ul><li>æ¥å£æä¾›çš„2ä¸ªé‡è¦ä¿¡æ¯ï¼š<ol><li>åˆçº¦æ¯ä¸ªå‡½æ•°çš„ <code>bytes4</code> é€‰æ‹©å™¨ä»¥åŠå‡½æ•°ç­¾å <code>å‡½æ•°åï¼ˆæ¯ä¸ªå‚æ•°ç±»å‹ï¼‰</code></li><li>æ¥å£id</li></ol></li></ul><h4 id="ä¾‹1"><a href="#ä¾‹1" class="headerlink" title="ä¾‹1"></a>ä¾‹1</h4><p>å­˜åœ¨æ¥å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">interface aniSound &#123;<br>    function sound() external returns(string memory);<br>&#125;<br></code></pre></td></tr></table></figure><p>å·²çŸ¥é“¾ä¸Šå·²éƒ¨ç½²çš„ä¸¤ä¸ªå‡½æ•° <code>cat</code> å’Œ <code>dog</code> å‡ä½¿ç”¨äº†è¯¥æ¥å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract dog &#123;<br>    uint public volumn;<br>    function sound() external returns(string memory) &#123;<br>        volumn += 2;<br>        return (&quot;Wang!&quot;);<br>    &#125;<br>function a() Â·Â·Â·<br>&#125;<br>contract cat&#123;<br>    uint public volumn;<br>    function sound() external returns(string memory) &#123;<br>        volumn++;<br>        return (&quot;miaow~&quot;);<br>    &#125;<br>    function b() Â·Â·Â·<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¸Œæœ›è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥é€šè¿‡ä¸¤ä¸ªå‡½æ•°çš„åœ°å€è°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract ani&#123;<br>    function testSound(address _add) external returns(string memory) &#123;<br>        aniSound general = aniSound(_add);<br>        return general.sound();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å³ï¼šæ¥å£å®ç°äº†ä¸€ç§è§„èŒƒï¼Œå¯¹å‡½æ•°çš„å„ä¸ªå‚æ•°è¿›è¡Œçº¦æŸ</p><h4 id="ä¾‹2"><a href="#ä¾‹2" class="headerlink" title="ä¾‹2"></a>ä¾‹2</h4><p>å¯¹ Ethernaut éƒ¨ç½²çš„åˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs solidity">// SPDX-License-Identifier: MIT<br>pragma solidity ^0.6.0;<br><br>contract Token &#123;<br>    mapping(address =&gt; uint256) balances;<br>    uint256 public totalSupply;<br><br>    constructor(uint256 _initialSupply) public &#123;<br>        balances[msg.sender] = totalSupply = _initialSupply;<br>    &#125;<br><br>    function transfer(address _to, uint256 _value) public returns (bool) &#123;<br>        require(balances[msg.sender] - _value &gt;= 0);<br>        balances[msg.sender] -= _value;<br>        balances[_to] += _value;<br>        return true;<br>    &#125;<br><br>    function balanceOf(address _owner) public view returns (uint256 balance) &#123;<br>        return balances[_owner];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ â€œæ¥å£+åœ°å€â€ æ¥å…¥å…¶ä¸­çš„å‡½æ•°ï¼Œä»¥ä¾¿è°ƒç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs solidity">interface Token &#123;<br>     function transfer(address _to, uint256 _value) external returns (bool);<br>     function balanceOf(address _owner) external view returns (uint256 balance);<br>&#125;<br><br>contract moreTokens &#123;<br>    address addr;<br>    address wallet;<br>    constructor(address _contract) &#123;<br>        addr = _contract;<br>    &#125;<br>    function addToken() public &#123;<br>        Token(addr).transfer(msg.sender, 1);<br>    &#125;<br>    function getBalance(address _owner) public view returns (uint256 balance) &#123;<br>    blanace = Token(addr).balanceOf(address _owner);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="13-ç»§æ‰¿"><a href="#13-ç»§æ‰¿" class="headerlink" title="13. ç»§æ‰¿"></a>13. ç»§æ‰¿</h2><h3 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h3><ul><li><code>virtual</code>: å¯¹ <strong>çˆ¶åˆçº¦</strong> ä¸­çš„å‡½æ•°ï¼Œè‹¥æƒ³åœ¨å­åˆçº¦é‡Œé‡å†™ï¼ŒåŠ  <code>virtual</code>ï¼Œæœ‰ <code>virtual</code> ä¸æ„å‘³ç€å¿…é¡»æ”¹</li><li><code>override</code>: å¯¹ å­åˆçº¦ï¼Œè¦é‡å†™çˆ¶åˆçº¦ä¸­çš„å‡½æ•°ï¼ŒåŠ  <code>override</code></li></ul><h3 id="ç®€å•çš„å‡½æ•°ç»§æ‰¿"><a href="#ç®€å•çš„å‡½æ•°ç»§æ‰¿" class="headerlink" title="ç®€å•çš„å‡½æ•°ç»§æ‰¿"></a>ç®€å•çš„å‡½æ•°ç»§æ‰¿</h3><p>ä»¥ <code>å­åˆçº¦ is çˆ¶åˆçº¦</code> å½¢å¼ç»§æ‰¿ï¼Œå¦‚ä¸‹ï¼Œåœ¨å­åˆçº¦ <code>ba</code> ä¸­é‡å†™äº† <code>yeA</code> å’Œ <code>yeB</code> ä¸¤ä¸ªå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract ye &#123;<br>event log(string msg);<br>function yeA() public virtual &#123;<br>emit log(&quot;ye_A&quot;);<br>    &#125; <br>        <br>function yeB() public virtual&#123;<br>emit log(&quot;ye_B&quot;);<br>&#125; <br><br>function yeye() public &#123;<br>emit log(&quot;yeye&quot;);<br>&#125; <br>&#125;<br><br>contract ba is ye &#123;<br>    function yeA() public virtual override &#123;<br>        emit log(&quot;ba_A&quot;);<br>    &#125;<br>    <br>    function yeB() public virtual override &#123;<br>        emit log(&quot;ba_B&quot;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¤šé‡ç»§æ‰¿"><a href="#å¤šé‡ç»§æ‰¿" class="headerlink" title="å¤šé‡ç»§æ‰¿"></a>å¤šé‡ç»§æ‰¿</h3><p>è§„åˆ™ï¼š</p><ol><li>æŒ‰è¾ˆåˆ†ä»é«˜åˆ°ä½æ’ï¼Œç”¨<code>ï¼Œ</code>åˆ†éš”ã€‚å¦‚ç”¨ <code>er</code> ç»§æ‰¿ <code>ye</code> å’Œ <code>ba</code> ä¸¤ä¸ªåˆçº¦ï¼Œåº”å†™ä½œ <code>contract er is ye, ba &#123;&#125;</code></li><li>è‹¥ä¸€ä¸ªå‡½æ•°åœ¨å¤šä¸ªç»§æ‰¿çš„åˆçº¦ä¸­å­˜åœ¨ï¼Œåœ¨å­åˆçº¦ä¸­å¿…é¡»é‡å†™ã€‚å¦‚ <code>ba</code> å’Œ <code>ye</code> åŒæ—¶æœ‰ <code>yeA</code> å‡½æ•°ï¼Œåœ¨å­å‡½æ•° <code>er</code> ä¸­å¿…é¡»å¯¹å®ƒé‡å†™</li><li>é‡å†™åœ¨å¤šä¸ªçˆ¶åˆçº¦ä¸­å­˜åœ¨çš„å‡½æ•°æ—¶ï¼Œ<code>override</code> åå¿…é¡»åŠ ä¸Šæ‰€æœ‰çˆ¶åˆçº¦çš„åå­—ï¼Œé¡ºåºæ— æ‰€è°“ã€‚</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract er is ye, ba &#123;<br>    function yeA() public virtual override(ba, ye) &#123;<br>        emit log(&quot;er_A&quot;);<br>    &#125;<br>    <br>    function yeB() public virtual override(ye, ba) &#123;<br>        emit log(&quot;er_B&quot;);<br>    &#125;<br><br>    function erzi() public &#123;<br>        emit log(&quot;erzi&quot;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä¿®é¥°å™¨çš„ç»§æ‰¿"><a href="#ä¿®é¥°å™¨çš„ç»§æ‰¿" class="headerlink" title="ä¿®é¥°å™¨çš„ç»§æ‰¿"></a>ä¿®é¥°å™¨çš„ç»§æ‰¿</h3><p>ç”¨æ³•ä¸å‡½æ•°ç»§æ‰¿ç±»ä¼¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract evenAndOddNum &#123;<br>    modifier evenNum(uint _num) virtual &#123;<br>        require (_num % 2 == 0);<br>        _;<br>    &#125;<br><br>    function getIt(uint _num) public pure evenNum(_num) returns(uint) &#123;<br>        return (_num);<br>    &#125;<br>&#125;<br><br>contract oddNum is evenAndOddNum &#123;<br>    modifier evenNum(uint _num) virtual override&#123;<br>        require (_num % 2 != 0);<br>        _;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ„é€ å‡½æ•°çš„ç»§æ‰¿"><a href="#æ„é€ å‡½æ•°çš„ç»§æ‰¿" class="headerlink" title="æ„é€ å‡½æ•°çš„ç»§æ‰¿"></a>æ„é€ å‡½æ•°çš„ç»§æ‰¿</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs solidity">contract A &#123;<br>    uint public a;<br>    constructor(uint _a) &#123;<br>        a = _a;<br>    &#125;<br>    function getIt() public view returns(uint)&#123;<br>        return a;<br>    &#125;<br>&#125;<br>// ç»§æ‰¿æ—¶å£°æ˜ constructor çš„å‚æ•°<br>contract B is A(23) &#123;<br><br>&#125;<br>// åœ¨å­åˆçº¦çš„æ„é€ å‡½æ•°ä¸­å£°æ˜å‚æ•° <br>contract C is A &#123;<br>    constructor (uint _c) A(_c * 2)&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°"><a href="#è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°" class="headerlink" title="è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°"></a>è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°</h3><ol><li>ç›´æ¥è°ƒç”¨ï¼šç”¨<code>çˆ¶åˆçº¦å.å‡½æ•°å()</code>è°ƒç”¨ã€‚å¦‚åœ¨ <code>contract er</code> ä¸­</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function callBa() public &#123;<br>ba.baba();<br>&#125;// log ä¸­è¿”å› &quot;baba&quot;<br></code></pre></td></tr></table></figure><ol><li><code>super</code>å…³é”®å­—ï¼šç”¨ <code>super.å‡½æ•°å()</code> è°ƒç”¨æœ€è¿‘çˆ¶åˆçº¦çš„å‡½æ•°ã€‚å¦‚ <code>contract er is ye, ba</code> ä¸­ï¼Œ<code>ba</code> æ˜¯ç¦» <code>er</code> æœ€è¿‘çš„çˆ¶åˆçº¦</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function callNear() public &#123;<br>super.yeA();<br>&#125;// log ä¸­è¿”å› &quot;ba_A&quot;<br></code></pre></td></tr></table></figure><h3 id="é’»çŸ³ç»§æ‰¿"><a href="#é’»çŸ³ç»§æ‰¿" class="headerlink" title="é’»çŸ³ç»§æ‰¿"></a>é’»çŸ³ç»§æ‰¿</h3><p>ä¸€ä¸ªæ´¾ç”Ÿç±»æœ‰ä¸¤ä¸ªåŠä»¥ä¸Šçš„åŸºç±»</p><ul><li>å¯¼è‡´çš„é—®é¢˜ï¼šå¦‚æœä¸¤ä¸ªæˆ–å¤šä¸ªåˆçº¦å®šä¹‰äº†ç›¸åŒçš„å‡½æ•°ï¼Œé‚£ä¹ˆåº”è¯¥åœ¨å­åˆçº¦ä¸­è°ƒç”¨å“ªä¸ªåŸºç¡€åˆçº¦?</li><li>è§£å†³æ–¹å¼ï¼šå€Ÿé‰´ python çš„ â€œæ–¹æ³•è§£æé¡ºåºï¼ˆMethod Resolution Orderï¼ŒMROï¼‰â€ï¼Œä½¿ç”¨ C3çº¿æ€§åŒ–ï¼Œå¼ºåˆ¶ä¸€ä¸ªç”±åŸºç±»æ„æˆçš„ DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ä¿æŒä¸€ä¸ªç‰¹å®šçš„é¡ºåºã€‚ï¼ˆçœ‹ä¸æ‡‚ä¹Ÿæ— æ‰€è°“ï¼Œå¤§æ¦‚ï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs solidity">/*<br>    f<br>   /  \<br>  g1  g2<br>   \  /<br>    h<br>*/<br>contract f &#123;<br>    event log(string msg);<br>    function way1() public virtual &#123;<br>        emit log(&quot;f.way1&quot;);<br>    &#125;<br>    function way2() public virtual &#123;<br>        emit log(&quot;f.way2&quot;);<br>    &#125;<br>&#125;<br><br>contract g1 is f&#123;<br>    function way1() public virtual override&#123;<br>        emit log(&quot;g1.way1&quot;);<br>        super.way1();<br>    &#125;<br>    function way2() public virtual override&#123;<br>        emit log(&quot;g1.way2&quot;); <br>        super.way2();<br>    &#125;<br>&#125;<br><br>contract g2 is f&#123;<br>    function way1() public virtual override&#123;<br>        emit log(&quot;g2.way1&quot;);<br>        super.way1();<br>    &#125;<br>    function way2() public virtual override&#123;<br>        emit log(&quot;g2.way2&quot;);<br>        super.way2();<br>    &#125;<br>&#125;<br><br>contract h is g2, g1 &#123;<br>    function way1() public virtual override(g1, g2)&#123;<br>        emit log(&quot;h.way1&quot;);<br>        super.way1();<br>    &#125;<br>    function way2() public virtual override(g2, g1)&#123;<br>        emit log(&quot;h.way2&quot;);<br>        super.way2();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œ <code>h</code>ä¸­çš„ <code>way1</code>ï¼Œè¾“å‡ºé¡ºåºä¸ºï¼šâ€h.way1â€  â€”&gt;  â€œg1.way1â€  â€”&gt;  â€œg2.way1â€  â€”&gt;  â€œf.way1â€</p><h2 id="14-å¼‚å¸¸"><a href="#14-å¼‚å¸¸" class="headerlink" title="14. å¼‚å¸¸"></a>14. å¼‚å¸¸</h2><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><p>åœ¨å‡½æ•°å¤–å®šä¹‰å¼‚å¸¸ï¼Œå¯ä»¥æœ‰å‚æ•°ï¼Œå¿…é¡»æ­é… <code>revert</code> ä½¿ç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs solidity">uint immutable const = 22;<br>error NotNum(string);// error NotNum(uint _errNum);<br>function useofRevertWithError(uint _num) external pure returns(bool)&#123;<br>    if (_num != const) &#123;<br>    revert NotNum(&quot;Not22&quot;);// revert NotNum(_num);<br>    &#125;<br>    return (true);<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="Require"><a href="#Require" class="headerlink" title="Require"></a>Require</h3><p>æ ¼å¼ <code>require(æ£€æŸ¥æ¡ä»¶ï¼Œâ€œå¼‚å¸¸çš„æè¿°â€)</code> ï¼Œå½“æ¡ä»¶ä¸æ»¡è¶³æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œåªæ¶ˆè€—è°ƒç”¨ require çš„ gasã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function useofRequire(uint _num) external pure returns(bool) &#123;<br>require(_num == const,&quot;Not22&quot;);// åªæœ‰ _num ä¸º 22 æ—¶æ‰è¿”å› trueï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œæè¿°ä¸ºâ€œNot22â€<br>return (true);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Assert"><a href="#Assert" class="headerlink" title="Assert"></a>Assert</h3><p>ä¸èƒ½è§£é‡Šå¼‚å¸¸åŸå› ï¼Œä¸€èˆ¬ç”¨äºå†™ç¨‹åº debugã€‚ç”¨æ³• <code>assert(æ£€æŸ¥æ¡ä»¶)</code>ï¼Œæ£€æŸ¥æ¡ä»¶ä¸æ»¡è¶³æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œæ¶ˆè€—æ‰€æœ‰ gasã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function useofAssert(uint _num) external pure returns(bool) &#123;<br>assert(_num == const);//  åªæœ‰ _num ä¸º 22 æ—¶æ‰è¿”å› trueï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œæ— æ³•æè¿°<br>return (true);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Revert"><a href="#Revert" class="headerlink" title="Revert"></a>Revert</h3><p><code>revert</code>  å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œç”¨æ³• <code>revert(&quot;å¼‚å¸¸æè¿°&quot;);</code>ï¼Œåªæ¶ˆè€—è°ƒç”¨ revert çš„ gasã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs solidity">function useofRevertOnly(uint _num) external pure returns(bool)&#123;<br>if (_num != const) &#123;<br>revert (&quot;Not22&quot;);<br>&#125;<br>    return (true);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="gas-æ¶ˆè€—"><a href="#gas-æ¶ˆè€—" class="headerlink" title="gas æ¶ˆè€—"></a>gas æ¶ˆè€—</h3><ul><li>ç»“è®ºï¼š<code>error</code> &lt; <code>assert</code> &lt; <code>require</code></li><li>å¤šç”¨ <code>error</code></li></ul><hr>]]></content>
    
    
    
    <tags>
      
      <tag>Solidity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/11/27/hello-world/"/>
    <url>/2024/11/27/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
